var cc=Object.defineProperty;var lc=(e,t,r)=>t in e?cc(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var Nr=(e,t,r)=>(lc(e,typeof t!="symbol"?t+"":t,r),r);import{r as fe,a as oc,R as fc}from"./vendor-8a332d8f.js";import{R as Ur,P as ri,a as ti,C as ai,T as Vr,L as si,b as Jt,X as At,Y as St,c as ni,B as hs,d as us,u as hc,e as uc,f as xc,g as dc,h as pc,i as mc,H as Ws,j as $s,S as gc,k as vc,l as yc,m as wc,n as Tc,o as _c,p as kc}from"./charts-51a353a7.js";import{a4 as _t,o as zs,a8 as Ec,a9 as Ja,D as ii,q as ci,aa as li,ab as bc,ac as Ac,ad as Sc,ae as Fc,af as Cc,ag as Nc,ah as Rc,ai as Dc,aj as Ic,a3 as Oc,a7 as Pc}from"./d3-e71fc99f.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))a(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const i of n.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function r(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerPolicy&&(n.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?n.credentials="include":s.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function a(s){if(s.ep)return;s.ep=!0;const n=r(s);fetch(s.href,n)}})();var oi={exports:{}},Oa={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jc=fe,Mc=Symbol.for("react.element"),Lc=Symbol.for("react.fragment"),Bc=Object.prototype.hasOwnProperty,Uc=jc.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Vc={key:!0,ref:!0,__self:!0,__source:!0};function fi(e,t,r){var a,s={},n=null,i=null;r!==void 0&&(n=""+r),t.key!==void 0&&(n=""+t.key),t.ref!==void 0&&(i=t.ref);for(a in t)Bc.call(t,a)&&!Vc.hasOwnProperty(a)&&(s[a]=t[a]);if(e&&e.defaultProps)for(a in t=e.defaultProps,t)s[a]===void 0&&(s[a]=t[a]);return{$$typeof:Mc,type:e,key:n,ref:i,props:s,_owner:Uc.current}}Oa.Fragment=Lc;Oa.jsx=fi;Oa.jsxs=fi;oi.exports=Oa;var l=oi.exports,Za={},Ys=oc;Za.createRoot=Ys.createRoot,Za.hydrateRoot=Ys.hydrateRoot;const Hc={security:["security","cybersecurity","cyber","attack","defense","threat","vulnerability","malware","intrusion","breach","protection","secure","encryption","authentication","authorization","firewall","ids","ips","forensics","incident"],economics:["economic","economics","cost","benefit","investment","roi","market","price","pricing","incentive","utility","profit","loss","budget","financial","monetary","value","worth","expense","revenue","insurance"],risk:["risk","risks","risky","uncertainty","probability","likelihood","assessment","management","mitigation","analysis","evaluation","measurement","quantification","modeling","prediction","forecast","scenario","impact","consequence"],aiml:["artificial","intelligence","machine","learning","neural","network","deep","algorithm","model","training","classification","prediction","ai","ml","data","mining","pattern","recognition","automation","cognitive"],gameTheory:["game","theory","strategic","player","strategy","equilibrium","nash","payoff","cooperation","competition","coalition","bargaining","auction","mechanism","design","optimal","decision","rational","behavior"],network:["network","networks","networking","topology","node","edge","graph","connectivity","routing","protocol","communication","distributed","peer","client","server","infrastructure","internet","web"],privacy:["privacy","private","confidential","anonymous","anonymity","personal","data","information","disclosure","sharing","protection","gdpr","compliance","consent","tracking","surveillance","identity"]};function Gc(e){const t=`${e.title} ${e.abstract} ${e.tags.join(" ")}`.toLowerCase(),r={};return Object.entries(Hc).forEach(([a,s])=>{let n=0;s.forEach(i=>{const c=new RegExp(`\\b${i}\\b`,"gi"),h=t.match(c);h&&(n+=h.length)}),r[a]=n/Math.max(t.length/100,1)}),r}function Wc(e){const t={};return e.forEach(a=>{const s=Gc(a);Object.entries(s).forEach(([n,i])=>{i>.1&&(t[n]||(t[n]=[]),t[n].push(a))})}),Object.entries(t).map(([a,s])=>{const n=s.length/e.length*100;return{id:a,label:$c(a),size:s.length,papers:s,connections:zc(a,t),coverage:n}}).sort((a,s)=>s.coverage-a.coverage)}function $c(e){return{security:"Security",economics:"Economics",risk:"Risk Management",aiml:"AI/ML",gameTheory:"Game Theory",network:"Network",privacy:"Privacy"}[e]||e.charAt(0).toUpperCase()+e.slice(1)}function zc(e,t){const r=new Set(t[e].map(s=>s.key)),a=[];return Object.entries(t).forEach(([s,n])=>{if(s===e)return;n.filter(h=>r.has(h.key)).length/Math.min(r.size,n.length)>.1&&a.push(s)}),a}function _a(e){return e.trim().replace(/^(Dr\.|Prof\.|Mr\.|Ms\.|Mrs\.)\s*/i,"").replace(/\s*(Jr\.|Sr\.|III|IV)\.?$/i,"").replace(/\s+/g," ").toLowerCase()}function Yc(e){const t=new Map,r=new Set;return e.forEach(a=>{if(r.has(a))return;const s=_a(a),n=[a];e.forEach(i=>{if(a===i||r.has(i))return;const c=_a(i);Xc(s,c)&&(n.push(i),r.add(i))}),n.length>1&&t.set(s,n),r.add(a)}),t}function Xc(e,t){if(e===t)return!0;const r=e.split(" "),a=t.split(" ");if(r.length===a.length){let s=0;for(let n=0;n<r.length;n++){const i=r[n],c=a[n];(i===c||i.length===1&&c.startsWith(i)||c.length===1&&i.startsWith(c))&&s++}return s===r.length}return r.length===2&&a.length===2?r[0]===a[1]&&r[1]===a[0]:!1}function Kc(e){const t=new Map,r=new Set;e.forEach(n=>{n.authors.forEach(i=>r.add(i))});const a=Yc(Array.from(r)),s=new Map;return a.forEach((n,i)=>{const c=n.reduce((h,f)=>f.length>h.length?f:h);n.forEach(h=>{s.set(h,c)})}),e.forEach(n=>{n.authors.forEach(i=>{const c=s.get(i)||i,h=_a(c);t.has(h)||t.set(h,{id:h.replace(/\s+/g,"_"),name:c,cleanName:h,paperCount:0,papers:[],collaborators:[],primaryTopics:[],influence:0,yearSpan:0,averagePapersPerYear:0});const f=t.get(h);f.paperCount++,f.papers.push(n)})}),t.forEach(n=>{const i=n.papers.map(c=>c.publicationYear).filter(c=>c!==null).sort();i.length>0&&(n.firstPublication=i[0],n.lastPublication=i[i.length-1],n.yearSpan=n.lastPublication-n.firstPublication+1,n.averagePapersPerYear=n.paperCount/Math.max(n.yearSpan,1)),n.primaryTopics=qc(n.papers),n.influence=Jc(n)}),Array.from(t.values()).sort((n,i)=>i.paperCount-n.paperCount)}function qc(e){const t=new Map;return e.forEach(r=>{const a=`${r.title} ${r.abstract} ${r.tags.join(" ")}`.toLowerCase();[{name:"Security",keywords:["security","cyber","attack","defense"]},{name:"Economics",keywords:["economic","cost","market","incentive"]},{name:"Game Theory",keywords:["game","strategy","equilibrium","player"]},{name:"Risk",keywords:["risk","uncertainty","probability"]},{name:"AI/ML",keywords:["ai","machine","learning","neural"]},{name:"Network",keywords:["network","distributed","protocol"]},{name:"Privacy",keywords:["privacy","anonymous","confidential"]}].forEach(n=>{const i=n.keywords.filter(c=>a.includes(c)).length;i>0&&t.set(n.name,(t.get(n.name)||0)+i)})}),Array.from(t.entries()).sort((r,a)=>a[1]-r[1]).slice(0,3).map(([r])=>r)}function Jc(e){let t=0;return t+=Math.log(e.paperCount+1)*10,t+=e.averagePapersPerYear*5,t+=Math.min(e.yearSpan,10)*2,t+=e.primaryTopics.length*3,Math.round(t*10)/10}function Zc(e){const t=new Map;return e.forEach(r=>{const a=r.authors.map(_a);for(let s=0;s<a.length;s++)for(let n=s+1;n<a.length;n++){const i=a[s],c=a[n],h=[i,c].sort().join("|");t.set(h,(t.get(h)||0)+1)}}),Array.from(t.entries()).map(([r,a])=>{const[s,n]=r.split("|");return{source:s,target:n,weight:a}}).filter(r=>r.weight>0).sort((r,a)=>a.weight-r.weight)}function Qc(e,t){const r=[],a=new Set,s=new Map;return t.forEach(n=>{s.has(n.source)||s.set(n.source,new Set),s.has(n.target)||s.set(n.target,new Set),s.get(n.source).add(n.target),s.get(n.target).add(n.source)}),e.forEach(n=>{if(a.has(n.cleanName))return;const i=el(n.cleanName,s,a);if(i.size>=3){const c=Array.from(i),h=c.map(m=>e.find(u=>u.cleanName===m)).filter(m=>m!==void 0),f=h.reduce((m,u)=>m+u.paperCount,0),o=h.flatMap(m=>m.primaryTopics),x=new Map;o.forEach(m=>{x.set(m,(x.get(m)||0)+1)});const d=Array.from(x.entries()).sort((m,u)=>u[1]-m[1]).slice(0,3).map(([m])=>m),p=c.map(m=>({author:m,connections:(s.get(m)||new Set).size})).sort((m,u)=>u.connections-m.connections).slice(0,Math.max(1,Math.floor(c.length*.3))).map(m=>m.author);r.push({id:`community_${r.length+1}`,name:`Research Group ${r.length+1}`,members:c,centralAuthors:p,primaryTopics:d,paperCount:f,collaborationStrength:rl(c,t)})}}),r.sort((n,i)=>i.paperCount-n.paperCount)}function el(e,t,r){const a=new Set,s=[e];for(;s.length>0;){const n=s.shift();if(r.has(n))continue;r.add(n),a.add(n),(t.get(n)||new Set).forEach(c=>{r.has(c)||s.push(c)})}return a}function rl(e,t){const r=new Set(e),a=t.filter(i=>r.has(i.source)&&r.has(i.target)),s=e.length*(e.length-1)/2,n=a.length;return s>0?n/s:0}function tl(e){const t=Kc(e),r=Zc(e),a=Qc(t,r),s=t.length,n=r.length,i=s>0?n*2/s:0,c=t.slice(0,10).map(d=>({name:d.name,paperCount:d.paperCount})),h=t.sort((d,p)=>p.influence-d.influence).slice(0,10).map(d=>({name:d.name,influence:d.influence})),f=s*(s-1)/2,o=f>0?n/f:0,x={totalAuthors:s,totalCollaborations:n,averageCollaboratorsPerAuthor:Math.round(i*10)/10,mostProlificAuthors:c,mostInfluentialAuthors:h,collaborationDensity:Math.round(o*1e3)/1e3};return{authors:t,collaborations:r,communities:a,statistics:x}}function al(e){console.log("🔄 Starting CSV parsing..."),console.log(`📄 CSV content length: ${e.length} characters`);const t=e.split(`
`);if(console.log(`📋 Total lines in CSV: ${t.length}`),t.length<2)return console.error("❌ CSV file has insufficient lines"),[];const r=Xs(t[0]).map(i=>i.trim().replace(/"/g,""));console.log(`📊 Headers found: ${r.length} columns`),console.log(`📝 First few headers: ${r.slice(0,5).join(", ")}`);const a=[];let s=0,n=0;for(let i=1;i<t.length;i++){const c=t[i].trim();if(c)try{const h=Xs(c);if(h.length<r.length*.5){n++;continue}const f=sl(r,h);f?(a.push(f),s++):n++}catch(h){console.warn(`⚠️ Error parsing line ${i}:`,h),n++}}return console.log("✅ CSV parsing complete:"),console.log(`📈 Valid papers: ${s}`),console.log(`⚠️ Skipped papers: ${n}`),console.log(`📊 Total papers parsed: ${a.length}`),a}function Xs(e){const t=[];let r="",a=!1,s=0;for(;s<e.length;){const n=e[s];if(n==='"')if(s+1<e.length&&e[s+1]==='"'){r+='"',s+=2;continue}else a=!a;else if(n===","&&!a){t.push(r.trim()),r="",s++;continue}else r+=n;s++}return t.push(r.trim()),t}function sl(e,t){try{const r=p=>{const u={title:["Title"],author:["Author"],year:["Publication Year"],abstract:["Abstract Note"],doi:["DOI"],url:["Url"],type:["Item Type"],venue:["Publication Title"],key:["Key"],tags:["Manual Tags","Automatic Tags"]}[p.toLowerCase()]||[p];for(const g of u){const _=e.findIndex(F=>F&&(F.toLowerCase()===g.toLowerCase()||F.toLowerCase().includes(g.toLowerCase())));if(_>=0&&_<t.length&&t[_]&&t[_].trim())return nl(t[_])}return""},a=r("title");if(!a||a.length<5)return null;const s=r("year")||r("date"),n=il(s),i=r("author")||r("authors"),c=cl(i),h=r("Manual Tags"),f=r("Automatic Tags"),o=[h,f].filter(Boolean).join("; "),x=ol(o);return{key:r("key")||fl(a,c[0]||"unknown"),itemType:r("type")||r("itemtype")||"article",publicationYear:n,authors:c.length>0?c:["Unknown Author"],title:a,publicationTitle:r("venue")||r("Publication Title")||"",doi:r("doi"),url:r("url"),abstract:r("abstract"),tags:x,venue:r("venue")||r("Publication Title")||""}}catch(r){return console.warn("Error parsing paper record:",r),null}}function nl(e){return e.replace(/^"|"$/g,"").trim()}function il(e){if(!e)return null;const t=e.match(/\b(19|20)\d{2}\b/);if(t){const r=parseInt(t[0]);if(r>=1990&&r<=2025)return r}return null}function cl(e){return e?e.split(/[;,&]|and\s+/).map(r=>r.trim()).filter(r=>r.length>0).map(r=>ll(r)):[]}function ll(e){return e.replace(/^(Dr\.|Prof\.|Mr\.|Ms\.|Mrs\.)\s*/i,"").replace(/\s*(Jr\.|Sr\.|III|IV)\.?$/i,"").trim()}function ol(e){return e?e.split(/[;,]/).map(t=>t.trim()).filter(t=>t.length>0):[]}function fl(e,t){const r=e.toLowerCase().split(/\s+/).slice(0,3);return`${(t&&t.split(" ").pop()||"").toLowerCase()}_${r.join("_")}`}function hl(e){const t=e.length,r=new Date().getFullYear(),a=e.filter(c=>c.doi&&c.doi.trim().length>0).length,s=e.filter(c=>c.url&&c.url.trim().length>0).length,n=e.filter(c=>c.abstract&&c.abstract.trim().length>0).length,i=e.filter(c=>c.publicationYear&&c.publicationYear>=r-5).length;return{totalPapers:t,doiCoverage:a/t*100,urlCoverage:s/t*100,abstractCoverage:n/t*100,recentPapers:i/t*100}}function ul(e){const t=new Map;return e.forEach(r=>{const a=r.venue||r.publicationTitle||"Unknown",s=t.get(a)||{count:0,type:"other"};let n="other";const i=a.toLowerCase();i.includes("journal")||i.includes("transactions")?n="journal":i.includes("conference")||i.includes("proceedings")||i.includes("workshop")||i.includes("symposium")?n="conference":(i.includes("book")||i.includes("chapter"))&&(n="book"),t.set(a,{count:s.count+1,type:n})}),Array.from(t.entries()).map(([r,a])=>({name:r,paperCount:a.count,type:a.type})).sort((r,a)=>a.paperCount-r.paperCount)}function Qa(e){console.log("Transforming data for visualization...");const t=e.map(n=>n.publicationYear).filter(n=>n!==null),r=t.length>0?[Math.min(...t),Math.max(...t)]:[1990,2025];console.log("Generating topic clusters...");const a=Wc(e);console.log("Analyzing author network...");const s=tl(e);return console.log(`Processed ${e.length} papers, ${a.length} topics, ${s.authors.length} authors`),{papers:e,yearRange:r,authorNetwork:s.authors,topicClusters:a,venueStats:ul(e),qualityMetrics:hl(e)}}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var hi=1252,xl=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],xs={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},ds=function(e){xl.indexOf(e)!=-1&&(hi=xs[0]=e)};function dl(){ds(1252)}var br=function(e){ds(e)};function ui(){br(1200),dl()}function Ks(e){for(var t=[],r=0,a=e.length;r<a;++r)t[r]=e.charCodeAt(r);return t}function pl(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function xi(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Lt=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?pl(e.slice(2)):t==254&&r==255?xi(e.slice(2)):t==65279?e.slice(1):e},xa=function(t){return String.fromCharCode(t)},qs=function(t){return String.fromCharCode(t)},Kr,Jr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Js(e){for(var t="",r=0,a=0,s=0,n=0,i=0,c=0,h=0,f=0;f<e.length;)r=e.charCodeAt(f++),n=r>>2,a=e.charCodeAt(f++),i=(r&3)<<4|a>>4,s=e.charCodeAt(f++),c=(a&15)<<2|s>>6,h=s&63,isNaN(a)?c=h=64:isNaN(s)&&(h=64),t+=Jr.charAt(n)+Jr.charAt(i)+Jr.charAt(c)+Jr.charAt(h);return t}function xr(e){var t="",r=0,a=0,s=0,n=0,i=0,c=0,h=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var f=0;f<e.length;)n=Jr.indexOf(e.charAt(f++)),i=Jr.indexOf(e.charAt(f++)),r=n<<2|i>>4,t+=String.fromCharCode(r),c=Jr.indexOf(e.charAt(f++)),a=(i&15)<<4|c>>2,c!==64&&(t+=String.fromCharCode(a)),h=Jr.indexOf(e.charAt(f++)),s=(c&3)<<6|h,h!==64&&(t+=String.fromCharCode(s));return t}var ye=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),xt=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function et(e){return ye?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Zs(e){return ye?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Er=function(t){return ye?xt(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function dt(e){if(Array.isArray(e))return e.map(function(a){return String.fromCharCode(a)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function ps(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return ps(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var qr=ye?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:xt(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var a=new Uint8Array(r),s=0;for(t=0,r=0;t<e.length;r+=s,++t)if(s=e[t].length,e[t]instanceof Uint8Array)a.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";a.set(new Uint8Array(e[t]),r)}return a}return[].concat.apply([],e.map(function(n){return Array.isArray(n)?n:[].slice.call(n)}))};function ml(e){for(var t=[],r=0,a=e.length+250,s=et(e.length+255),n=0;n<e.length;++n){var i=e.charCodeAt(n);if(i<128)s[r++]=i;else if(i<2048)s[r++]=192|i>>6&31,s[r++]=128|i&63;else if(i>=55296&&i<57344){i=(i&1023)+64;var c=e.charCodeAt(++n)&1023;s[r++]=240|i>>8&7,s[r++]=128|i>>2&63,s[r++]=128|c>>6&15|(i&3)<<4,s[r++]=128|c&63}else s[r++]=224|i>>12&15,s[r++]=128|i>>6&63,s[r++]=128|i&63;r>a&&(t.push(s.slice(0,r)),r=0,s=et(65535),a=65530)}return t.push(s.slice(0,r)),qr(t)}var cr=/\u0000/g,Bt=/[\u0001-\u0006]/g;function kt(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Ar(e,t){var r=""+e;return r.length>=t?r:Re("0",t-r.length)+r}function ms(e,t){var r=""+e;return r.length>=t?r:Re(" ",t-r.length)+r}function ka(e,t){var r=""+e;return r.length>=t?r:r+Re(" ",t-r.length)}function gl(e,t){var r=""+Math.round(e);return r.length>=t?r:Re("0",t-r.length)+r}function vl(e,t){var r=""+e;return r.length>=t?r:Re("0",t-r.length)+r}var Qs=Math.pow(2,32);function yt(e,t){if(e>Qs||e<-Qs)return gl(e,t);var r=Math.round(e);return vl(r,t)}function Ea(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var en=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Va=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function yl(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e}var me={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},rn={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},wl={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function ba(e,t,r){for(var a=e<0?-1:1,s=e*a,n=0,i=1,c=0,h=1,f=0,o=0,x=Math.floor(s);f<t&&(x=Math.floor(s),c=x*i+n,o=x*f+h,!(s-x<5e-8));)s=1/(s-x),n=i,i=c,h=f,f=o;if(o>t&&(f>t?(o=h,c=n):(o=f,c=i)),!r)return[0,a*c,o];var d=Math.floor(a*c/o);return[d,a*c-d*o,o]}function it(e,t,r){if(e>2958465||e<0)return null;var a=e|0,s=Math.floor(86400*(e-a)),n=0,i=[],c={D:a,T:s,u:86400*(e-a)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(c.u)<1e-6&&(c.u=0),t&&t.date1904&&(a+=1462),c.u>.9999&&(c.u=0,++s==86400&&(c.T=s=0,++a,++c.D)),a===60)i=r?[1317,10,29]:[1900,2,29],n=3;else if(a===0)i=r?[1317,8,29]:[1900,1,0],n=6;else{a>60&&--a;var h=new Date(1900,0,1);h.setDate(h.getDate()+a-1),i=[h.getFullYear(),h.getMonth()+1,h.getDate()],n=h.getDay(),a<60&&(n=(n+6)%7),r&&(n=Al(h,i))}return c.y=i[0],c.m=i[1],c.d=i[2],c.S=s%60,s=Math.floor(s/60),c.M=s%60,s=Math.floor(s/60),c.H=s,c.q=n,c}var di=new Date(1899,11,31,0,0,0),Tl=di.getTime(),_l=new Date(1900,2,1,0,0,0);function pi(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=_l&&(r+=24*60*60*1e3),(r-(Tl+(e.getTimezoneOffset()-di.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function gs(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function kl(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function El(e){var t=e<0?12:11,r=gs(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function bl(e){var t=gs(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Zt(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=El(e):t===10?r=e.toFixed(10).substr(0,12):r=bl(e),gs(kl(r.toUpperCase()))}function ft(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Zt(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return yr(14,pi(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function Al(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function Sl(e,t,r,a){var s="",n=0,i=0,c=r.y,h,f=0;switch(e){case 98:c=r.y+543;case 121:switch(t.length){case 1:case 2:h=c%100,f=2;break;default:h=c%1e4,f=4;break}break;case 109:switch(t.length){case 1:case 2:h=r.m,f=t.length;break;case 3:return Va[r.m-1][1];case 5:return Va[r.m-1][0];default:return Va[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:h=r.d,f=t.length;break;case 3:return en[r.q][0];default:return en[r.q][1]}break;case 104:switch(t.length){case 1:case 2:h=1+(r.H+11)%12,f=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:h=r.H,f=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:h=r.M,f=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Ar(r.S,t.length):(a>=2?i=a===3?1e3:100:i=a===1?10:1,n=Math.round(i*(r.S+r.u)),n>=60*i&&(n=0),t==="s"?n===0?"0":""+n/i:(s=Ar(n,2+a),t==="ss"?s.substr(0,2):"."+s.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":h=r.D*24+r.H;break;case"[m]":case"[mm]":h=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":h=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}f=t.length===3?1:2;break;case 101:h=c,f=1;break}var o=f>0?Ar(h,f):"";return o}function Zr(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,a=e.substr(0,r);r!=e.length;r+=t)a+=(a.length>0?",":"")+e.substr(r,t);return a}var mi=/%/g;function Fl(e,t,r){var a=t.replace(mi,""),s=t.length-a.length;return Hr(e,a,r*Math.pow(10,2*s))+Re("%",s)}function Cl(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return Hr(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function gi(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+gi(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var n=Math.floor(Math.log(t)*Math.LOG10E)%s;if(n<0&&(n+=s),r=(t/Math.pow(10,n)).toPrecision(a+1+(s+n)%s),r.indexOf("e")===-1){var i=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+n):r+="E+"+(i-n);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,h,f,o){return h+f+o.substr(0,(s+n)%s)+"."+o.substr(n)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var vi=/# (\?+)( ?)\/( ?)(\d+)/;function Nl(e,t,r){var a=parseInt(e[4],10),s=Math.round(t*a),n=Math.floor(s/a),i=s-n*a,c=a;return r+(n===0?"":""+n)+" "+(i===0?Re(" ",e[1].length+1+e[4].length):ms(i,e[1].length)+e[2]+"/"+e[3]+Ar(c,e[4].length))}function Rl(e,t,r){return r+(t===0?"":""+t)+Re(" ",e[1].length+2+e[4].length)}var yi=/^#*0*\.([0#]+)/,wi=/\).*[0#]/,Ti=/\(###\) ###\\?-####/;function sr(e){for(var t="",r,a=0;a!=e.length;++a)switch(r=e.charCodeAt(a)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function tn(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function an(e,t){var r=e-Math.floor(e),a=Math.pow(10,t);return t<(""+Math.round(r*a)).length?0:Math.round(r*a)}function Dl(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function Il(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function gr(e,t,r){if(e.charCodeAt(0)===40&&!t.match(wi)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?gr("n",a,r):"("+gr("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Cl(e,t,r);if(t.indexOf("%")!==-1)return Fl(e,t,r);if(t.indexOf("E")!==-1)return gi(t,r);if(t.charCodeAt(0)===36)return"$"+gr(e,t.substr(t.charAt(1)==" "?2:1),r);var s,n,i,c,h=Math.abs(r),f=r<0?"-":"";if(t.match(/^00+$/))return f+yt(h,t.length);if(t.match(/^[#?]+$/))return s=yt(r,0),s==="0"&&(s=""),s.length>t.length?s:sr(t.substr(0,t.length-s.length))+s;if(n=t.match(vi))return Nl(n,h,f);if(t.match(/^#+0+$/))return f+yt(h,t.length-t.indexOf("0"));if(n=t.match(yi))return s=tn(r,n[1].length).replace(/^([^\.]+)$/,"$1."+sr(n[1])).replace(/\.$/,"."+sr(n[1])).replace(/\.(\d*)$/,function(m,u){return"."+u+Re("0",sr(n[1]).length-u.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),n=t.match(/^(0*)\.(#*)$/))return f+tn(h,n[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,n[1].length?"0.":".");if(n=t.match(/^#{1,3},##0(\.?)$/))return f+Zr(yt(h,0));if(n=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+gr(e,t,-r):Zr(""+(Math.floor(r)+Dl(r,n[1].length)))+"."+Ar(an(r,n[1].length),n[1].length);if(n=t.match(/^#,#*,#0/))return gr(e,t.replace(/^#,#*,/,""),r);if(n=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=kt(gr(e,t.replace(/[\\-]/g,""),r)),i=0,kt(kt(t.replace(/\\/g,"")).replace(/[0#]/g,function(m){return i<s.length?s.charAt(i++):m==="0"?"0":""}));if(t.match(Ti))return s=gr(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var o="";if(n=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(n[4].length,7),c=ba(h,Math.pow(10,i)-1,!1),s=""+f,o=Hr("n",n[1],c[1]),o.charAt(o.length-1)==" "&&(o=o.substr(0,o.length-1)+"0"),s+=o+n[2]+"/"+n[3],o=ka(c[2],i),o.length<n[4].length&&(o=sr(n[4].substr(n[4].length-o.length))+o),s+=o,s;if(n=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(n[1].length,n[4].length),7),c=ba(h,Math.pow(10,i)-1,!0),f+(c[0]||(c[1]?"":"0"))+" "+(c[1]?ms(c[1],i)+n[2]+"/"+n[3]+ka(c[2],i):Re(" ",2*i+1+n[2].length+n[3].length));if(n=t.match(/^[#0?]+$/))return s=yt(r,0),t.length<=s.length?s:sr(t.substr(0,t.length-s.length))+s;if(n=t.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(n[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var x=t.indexOf(".")-i,d=t.length-s.length-x;return sr(t.substr(0,x)+s+t.substr(t.length-d))}if(n=t.match(/^00,000\.([#0]*0)$/))return i=an(r,n[1].length),r<0?"-"+gr(e,t,-r):Zr(Il(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?Ar(0,3-m.length):"")+m})+"."+Ar(i,n[1].length);switch(t){case"###,##0.00":return gr(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var p=Zr(yt(h,0));return p!=="0"?f+p:"";case"###,###.00":return gr(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return gr(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function Ol(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return Hr(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function Pl(e,t,r){var a=t.replace(mi,""),s=t.length-a.length;return Hr(e,a,r*Math.pow(10,2*s))+Re("%",s)}function _i(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+_i(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var n=Math.floor(Math.log(t)*Math.LOG10E)%s;if(n<0&&(n+=s),r=(t/Math.pow(10,n)).toPrecision(a+1+(s+n)%s),!r.match(/[Ee]/)){var i=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+n):r+="E+"+(i-n),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,h,f,o){return h+f+o.substr(0,(s+n)%s)+"."+o.substr(n)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Dr(e,t,r){if(e.charCodeAt(0)===40&&!t.match(wi)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Dr("n",a,r):"("+Dr("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Ol(e,t,r);if(t.indexOf("%")!==-1)return Pl(e,t,r);if(t.indexOf("E")!==-1)return _i(t,r);if(t.charCodeAt(0)===36)return"$"+Dr(e,t.substr(t.charAt(1)==" "?2:1),r);var s,n,i,c,h=Math.abs(r),f=r<0?"-":"";if(t.match(/^00+$/))return f+Ar(h,t.length);if(t.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>t.length?s:sr(t.substr(0,t.length-s.length))+s;if(n=t.match(vi))return Rl(n,h,f);if(t.match(/^#+0+$/))return f+Ar(h,t.length-t.indexOf("0"));if(n=t.match(yi))return s=(""+r).replace(/^([^\.]+)$/,"$1."+sr(n[1])).replace(/\.$/,"."+sr(n[1])),s=s.replace(/\.(\d*)$/,function(m,u){return"."+u+Re("0",sr(n[1]).length-u.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),n=t.match(/^(0*)\.(#*)$/))return f+(""+h).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,n[1].length?"0.":".");if(n=t.match(/^#{1,3},##0(\.?)$/))return f+Zr(""+h);if(n=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Dr(e,t,-r):Zr(""+r)+"."+Re("0",n[1].length);if(n=t.match(/^#,#*,#0/))return Dr(e,t.replace(/^#,#*,/,""),r);if(n=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=kt(Dr(e,t.replace(/[\\-]/g,""),r)),i=0,kt(kt(t.replace(/\\/g,"")).replace(/[0#]/g,function(m){return i<s.length?s.charAt(i++):m==="0"?"0":""}));if(t.match(Ti))return s=Dr(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var o="";if(n=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(n[4].length,7),c=ba(h,Math.pow(10,i)-1,!1),s=""+f,o=Hr("n",n[1],c[1]),o.charAt(o.length-1)==" "&&(o=o.substr(0,o.length-1)+"0"),s+=o+n[2]+"/"+n[3],o=ka(c[2],i),o.length<n[4].length&&(o=sr(n[4].substr(n[4].length-o.length))+o),s+=o,s;if(n=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(n[1].length,n[4].length),7),c=ba(h,Math.pow(10,i)-1,!0),f+(c[0]||(c[1]?"":"0"))+" "+(c[1]?ms(c[1],i)+n[2]+"/"+n[3]+ka(c[2],i):Re(" ",2*i+1+n[2].length+n[3].length));if(n=t.match(/^[#0?]+$/))return s=""+r,t.length<=s.length?s:sr(t.substr(0,t.length-s.length))+s;if(n=t.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(n[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var x=t.indexOf(".")-i,d=t.length-s.length-x;return sr(t.substr(0,x)+s+t.substr(t.length-d))}if(n=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Dr(e,t,-r):Zr(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?Ar(0,3-m.length):"")+m})+"."+Ar(0,n[1].length);switch(t){case"###,###":case"##,###":case"#,###":var p=Zr(""+h);return p!=="0"?f+p:"";default:if(t.match(/\.[0#?]*$/))return Dr(e,t.slice(0,t.lastIndexOf(".")),r)+sr(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Hr(e,t,r){return(r|0)===r?Dr(e,t,r):gr(e,t,r)}function jl(e){for(var t=[],r=!1,a=0,s=0;a<e.length;++a)switch(e.charCodeAt(a)){case 34:r=!r;break;case 95:case 42:case 92:++a;break;case 59:t[t.length]=e.substr(s,a-s),s=a+1}if(t[t.length]=e.substr(s),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var ki=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Nt(e){for(var t=0,r="",a="";t<e.length;)switch(r=e.charAt(t)){case"G":Ea(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="上午/下午")return!0;++t;break;case"[":for(a=r;e.charAt(t++)!=="]"&&t<e.length;)a+=e.charAt(t);if(a.match(ki))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function Ml(e,t,r,a){for(var s=[],n="",i=0,c="",h="t",f,o,x,d="H";i<e.length;)switch(c=e.charAt(i)){case"G":if(!Ea(e,i))throw new Error("unrecognized character "+c+" in "+e);s[s.length]={t:"G",v:"General"},i+=7;break;case'"':for(n="";(x=e.charCodeAt(++i))!==34&&i<e.length;)n+=String.fromCharCode(x);s[s.length]={t:"t",v:n},++i;break;case"\\":var p=e.charAt(++i),m=p==="("||p===")"?p:"t";s[s.length]={t:m,v:p},++i;break;case"_":s[s.length]={t:"t",v:" "},i+=2;break;case"@":s[s.length]={t:"T",v:t},++i;break;case"B":case"b":if(e.charAt(i+1)==="1"||e.charAt(i+1)==="2"){if(f==null&&(f=it(t,r,e.charAt(i+1)==="2"),f==null))return"";s[s.length]={t:"X",v:e.substr(i,2)},h=c,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||f==null&&(f=it(t,r),f==null))return"";for(n=c;++i<e.length&&e.charAt(i).toLowerCase()===c;)n+=c;c==="m"&&h.toLowerCase()==="h"&&(c="M"),c==="h"&&(c=d),s[s.length]={t:c,v:n},h=c;break;case"A":case"a":case"上":var u={t:c,v:c};if(f==null&&(f=it(t,r)),e.substr(i,3).toUpperCase()==="A/P"?(f!=null&&(u.v=f.H>=12?"P":"A"),u.t="T",d="h",i+=3):e.substr(i,5).toUpperCase()==="AM/PM"?(f!=null&&(u.v=f.H>=12?"PM":"AM"),u.t="T",i+=5,d="h"):e.substr(i,5).toUpperCase()==="上午/下午"?(f!=null&&(u.v=f.H>=12?"下午":"上午"),u.t="T",i+=5,d="h"):(u.t="t",++i),f==null&&u.t==="T")return"";s[s.length]=u,h=c;break;case"[":for(n=c;e.charAt(i++)!=="]"&&i<e.length;)n+=e.charAt(i);if(n.slice(-1)!=="]")throw'unterminated "[" block: |'+n+"|";if(n.match(ki)){if(f==null&&(f=it(t,r),f==null))return"";s[s.length]={t:"Z",v:n.toLowerCase()},h=n.charAt(1)}else n.indexOf("$")>-1&&(n=(n.match(/\$([^-\[\]]*)/)||[])[1]||"$",Nt(e)||(s[s.length]={t:"t",v:n}));break;case".":if(f!=null){for(n=c;++i<e.length&&(c=e.charAt(i))==="0";)n+=c;s[s.length]={t:"s",v:n};break}case"0":case"#":for(n=c;++i<e.length&&"0#?.,E+-%".indexOf(c=e.charAt(i))>-1;)n+=c;s[s.length]={t:"n",v:n};break;case"?":for(n=c;e.charAt(++i)===c;)n+=c;s[s.length]={t:c,v:n},h=c;break;case"*":++i,(e.charAt(i)==" "||e.charAt(i)=="*")&&++i;break;case"(":case")":s[s.length]={t:a===1?"t":c,v:c},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(n=c;i<e.length&&"0123456789".indexOf(e.charAt(++i))>-1;)n+=e.charAt(i);s[s.length]={t:"D",v:n};break;case" ":s[s.length]={t:c,v:c},++i;break;case"$":s[s.length]={t:"t",v:"$"},++i;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(c)===-1)throw new Error("unrecognized character "+c+" in "+e);s[s.length]={t:"t",v:c},++i;break}var g=0,_=0,F;for(i=s.length-1,h="t";i>=0;--i)switch(s[i].t){case"h":case"H":s[i].t=d,h="h",g<1&&(g=1);break;case"s":(F=s[i].v.match(/\.0+$/))&&(_=Math.max(_,F[0].length-1)),g<3&&(g=3);case"d":case"y":case"M":case"e":h=s[i].t;break;case"m":h==="s"&&(s[i].t="M",g<2&&(g=2));break;case"X":break;case"Z":g<1&&s[i].v.match(/[Hh]/)&&(g=1),g<2&&s[i].v.match(/[Mm]/)&&(g=2),g<3&&s[i].v.match(/[Ss]/)&&(g=3)}switch(g){case 0:break;case 1:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M),f.M>=60&&(f.M=0,++f.H);break;case 2:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M);break}var y="",E;for(i=0;i<s.length;++i)switch(s[i].t){case"t":case"T":case" ":case"D":break;case"X":s[i].v="",s[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[i].v=Sl(s[i].t.charCodeAt(0),s[i].v,f,_),s[i].t="t";break;case"n":case"?":for(E=i+1;s[E]!=null&&((c=s[E].t)==="?"||c==="D"||(c===" "||c==="t")&&s[E+1]!=null&&(s[E+1].t==="?"||s[E+1].t==="t"&&s[E+1].v==="/")||s[i].t==="("&&(c===" "||c==="n"||c===")")||c==="t"&&(s[E].v==="/"||s[E].v===" "&&s[E+1]!=null&&s[E+1].t=="?"));)s[i].v+=s[E].v,s[E]={v:"",t:";"},++E;y+=s[i].v,i=E-1;break;case"G":s[i].t="t",s[i].v=ft(t,r);break}var D="",R,T;if(y.length>0){y.charCodeAt(0)==40?(R=t<0&&y.charCodeAt(0)===45?-t:t,T=Hr("n",y,R)):(R=t<0&&a>1?-t:t,T=Hr("n",y,R),R<0&&s[0]&&s[0].t=="t"&&(T=T.substr(1),s[0].v="-"+s[0].v)),E=T.length-1;var M=s.length;for(i=0;i<s.length;++i)if(s[i]!=null&&s[i].t!="t"&&s[i].v.indexOf(".")>-1){M=i;break}var I=s.length;if(M===s.length&&T.indexOf("E")===-1){for(i=s.length-1;i>=0;--i)s[i]==null||"n?".indexOf(s[i].t)===-1||(E>=s[i].v.length-1?(E-=s[i].v.length,s[i].v=T.substr(E+1,s[i].v.length)):E<0?s[i].v="":(s[i].v=T.substr(0,E+1),E=-1),s[i].t="t",I=i);E>=0&&I<s.length&&(s[I].v=T.substr(0,E+1)+s[I].v)}else if(M!==s.length&&T.indexOf("E")===-1){for(E=T.indexOf(".")-1,i=M;i>=0;--i)if(!(s[i]==null||"n?".indexOf(s[i].t)===-1)){for(o=s[i].v.indexOf(".")>-1&&i===M?s[i].v.indexOf(".")-1:s[i].v.length-1,D=s[i].v.substr(o+1);o>=0;--o)E>=0&&(s[i].v.charAt(o)==="0"||s[i].v.charAt(o)==="#")&&(D=T.charAt(E--)+D);s[i].v=D,s[i].t="t",I=i}for(E>=0&&I<s.length&&(s[I].v=T.substr(0,E+1)+s[I].v),E=T.indexOf(".")+1,i=M;i<s.length;++i)if(!(s[i]==null||"n?(".indexOf(s[i].t)===-1&&i!==M)){for(o=s[i].v.indexOf(".")>-1&&i===M?s[i].v.indexOf(".")+1:0,D=s[i].v.substr(0,o);o<s[i].v.length;++o)E<T.length&&(D+=T.charAt(E++));s[i].v=D,s[i].t="t",I=i}}}for(i=0;i<s.length;++i)s[i]!=null&&"n?".indexOf(s[i].t)>-1&&(R=a>1&&t<0&&i>0&&s[i-1].v==="-"?-t:t,s[i].v=Hr(s[i].t,s[i].v,R),s[i].t="t");var V="";for(i=0;i!==s.length;++i)s[i]!=null&&(V+=s[i].v);return V}var sn=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function nn(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function Ll(e,t){var r=jl(e),a=r.length,s=r[a-1].indexOf("@");if(a<4&&s>-1&&--a,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var n=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[a,n];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var i=r[0].match(sn),c=r[1].match(sn);return nn(t,i)?[a,r[0]]:nn(t,c)?[a,r[1]]:[a,r[i!=null&&c!=null?2:1]]}return[a,n]}function yr(e,t,r){r==null&&(r={});var a="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?a=r.dateNF:a=e;break;case"number":e==14&&r.dateNF?a=r.dateNF:a=(r.table!=null?r.table:me)[e],a==null&&(a=r.table&&r.table[rn[e]]||me[rn[e]]),a==null&&(a=wl[e]||"General");break}if(Ea(a,0))return ft(t,r);t instanceof Date&&(t=pi(t,r.date1904));var s=Ll(a,t);if(Ea(s[1]))return ft(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return Ml(s[1],t,r,s[0])}function lt(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(me[r]==null){t<0&&(t=r);continue}if(me[r]==e){t=r;break}}t<0&&(t=391)}return me[t]=e,t}function Ei(){me=yl()}var Bl={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},bi=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function Ul(e){var t=typeof e=="number"?me[e]:e;return t=t.replace(bi,"(\\d+)"),new RegExp("^"+t+"$")}function Vl(e,t,r){var a=-1,s=-1,n=-1,i=-1,c=-1,h=-1;(t.match(bi)||[]).forEach(function(x,d){var p=parseInt(r[d+1],10);switch(x.toLowerCase().charAt(0)){case"y":a=p;break;case"d":n=p;break;case"h":i=p;break;case"s":h=p;break;case"m":i>=0?c=p:s=p;break}}),h>=0&&c==-1&&s>=0&&(c=s,s=-1);var f=(""+(a>=0?a:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(n>=1?n:1)).slice(-2);f.length==7&&(f="0"+f),f.length==8&&(f="20"+f);var o=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(h>=0?h:0)).slice(-2);return i==-1&&c==-1&&h==-1?f:a==-1&&s==-1&&n==-1?o:f+"T"+o}var Hl=function(){var e={};e.version="1.2.0";function t(){for(var T=0,M=new Array(256),I=0;I!=256;++I)T=I,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,M[I]=T;return typeof Int32Array<"u"?new Int32Array(M):M}var r=t();function a(T){var M=0,I=0,V=0,L=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(V=0;V!=256;++V)L[V]=T[V];for(V=0;V!=256;++V)for(I=T[V],M=256+V;M<4096;M+=256)I=L[M]=I>>>8^T[I&255];var P=[];for(V=1;V!=16;++V)P[V-1]=typeof Int32Array<"u"?L.subarray(V*256,V*256+256):L.slice(V*256,V*256+256);return P}var s=a(r),n=s[0],i=s[1],c=s[2],h=s[3],f=s[4],o=s[5],x=s[6],d=s[7],p=s[8],m=s[9],u=s[10],g=s[11],_=s[12],F=s[13],y=s[14];function E(T,M){for(var I=M^-1,V=0,L=T.length;V<L;)I=I>>>8^r[(I^T.charCodeAt(V++))&255];return~I}function D(T,M){for(var I=M^-1,V=T.length-15,L=0;L<V;)I=y[T[L++]^I&255]^F[T[L++]^I>>8&255]^_[T[L++]^I>>16&255]^g[T[L++]^I>>>24]^u[T[L++]]^m[T[L++]]^p[T[L++]]^d[T[L++]]^x[T[L++]]^o[T[L++]]^f[T[L++]]^h[T[L++]]^c[T[L++]]^i[T[L++]]^n[T[L++]]^r[T[L++]];for(V+=15;L<V;)I=I>>>8^r[(I^T[L++])&255];return~I}function R(T,M){for(var I=M^-1,V=0,L=T.length,P=0,J=0;V<L;)P=T.charCodeAt(V++),P<128?I=I>>>8^r[(I^P)&255]:P<2048?(I=I>>>8^r[(I^(192|P>>6&31))&255],I=I>>>8^r[(I^(128|P&63))&255]):P>=55296&&P<57344?(P=(P&1023)+64,J=T.charCodeAt(V++)&1023,I=I>>>8^r[(I^(240|P>>8&7))&255],I=I>>>8^r[(I^(128|P>>2&63))&255],I=I>>>8^r[(I^(128|J>>6&15|(P&3)<<4))&255],I=I>>>8^r[(I^(128|J&63))&255]):(I=I>>>8^r[(I^(224|P>>12&15))&255],I=I>>>8^r[(I^(128|P>>6&63))&255],I=I>>>8^r[(I^(128|P&63))&255]);return~I}return e.table=r,e.bstr=E,e.buf=D,e.str=R,e}(),we=function(){var t={};t.version="1.2.1";function r(v,b){for(var w=v.split("/"),k=b.split("/"),A=0,S=0,U=Math.min(w.length,k.length);A<U;++A){if(S=w[A].length-k[A].length)return S;if(w[A]!=k[A])return w[A]<k[A]?-1:1}return w.length-k.length}function a(v){if(v.charAt(v.length-1)=="/")return v.slice(0,-1).indexOf("/")===-1?v:a(v.slice(0,-1));var b=v.lastIndexOf("/");return b===-1?v:v.slice(0,b+1)}function s(v){if(v.charAt(v.length-1)=="/")return s(v.slice(0,-1));var b=v.lastIndexOf("/");return b===-1?v:v.slice(b+1)}function n(v,b){typeof b=="string"&&(b=new Date(b));var w=b.getHours();w=w<<6|b.getMinutes(),w=w<<5|b.getSeconds()>>>1,v.write_shift(2,w);var k=b.getFullYear()-1980;k=k<<4|b.getMonth()+1,k=k<<5|b.getDate(),v.write_shift(2,k)}function i(v){var b=v.read_shift(2)&65535,w=v.read_shift(2)&65535,k=new Date,A=w&31;w>>>=5;var S=w&15;w>>>=4,k.setMilliseconds(0),k.setFullYear(w+1980),k.setMonth(S-1),k.setDate(A);var U=b&31;b>>>=5;var K=b&63;return b>>>=6,k.setHours(b),k.setMinutes(K),k.setSeconds(U<<1),k}function c(v){ze(v,0);for(var b={},w=0;v.l<=v.length-4;){var k=v.read_shift(2),A=v.read_shift(2),S=v.l+A,U={};switch(k){case 21589:w=v.read_shift(1),w&1&&(U.mtime=v.read_shift(4)),A>5&&(w&2&&(U.atime=v.read_shift(4)),w&4&&(U.ctime=v.read_shift(4))),U.mtime&&(U.mt=new Date(U.mtime*1e3));break}v.l=S,b[k]=U}return b}var h;function f(){return h||(h={})}function o(v,b){if(v[0]==80&&v[1]==75)return Gs(v,b);if((v[0]|32)==109&&(v[1]|32)==105)return rc(v,b);if(v.length<512)throw new Error("CFB file size "+v.length+" < 512");var w=3,k=512,A=0,S=0,U=0,K=0,B=0,H=[],W=v.slice(0,512);ze(W,0);var Z=x(W);switch(w=Z[0],w){case 3:k=512;break;case 4:k=4096;break;case 0:if(Z[1]==0)return Gs(v,b);default:throw new Error("Major Version: Expected 3 or 4 saw "+w)}k!==512&&(W=v.slice(0,k),ze(W,28));var ae=v.slice(0,k);d(W,w);var oe=W.read_shift(4,"i");if(w===3&&oe!==0)throw new Error("# Directory Sectors: Expected 0 saw "+oe);W.l+=4,U=W.read_shift(4,"i"),W.l+=4,W.chk("00100000","Mini Stream Cutoff Size: "),K=W.read_shift(4,"i"),A=W.read_shift(4,"i"),B=W.read_shift(4,"i"),S=W.read_shift(4,"i");for(var ee=-1,ce=0;ce<109&&(ee=W.read_shift(4,"i"),!(ee<0));++ce)H[ce]=ee;var pe=p(v,k);g(B,S,pe,k,H);var Ce=F(pe,U,H,k);Ce[U].name="!Directory",A>0&&K!==J&&(Ce[K].name="!MiniFAT"),Ce[H[0]].name="!FAT",Ce.fat_addrs=H,Ce.ssz=k;var Ne={},Ke=[],Pt=[],jt=[];y(U,Ce,pe,Ke,A,Ne,Pt,K),m(Pt,jt,Ke),Ke.shift();var Mt={FileIndex:Pt,FullPaths:jt};return b&&b.raw&&(Mt.raw={header:ae,sectors:pe}),Mt}function x(v){if(v[v.l]==80&&v[v.l+1]==75)return[0,0];v.chk(Y,"Header Signature: "),v.l+=16;var b=v.read_shift(2,"u");return[v.read_shift(2,"u"),b]}function d(v,b){var w=9;switch(v.l+=2,w=v.read_shift(2)){case 9:if(b!=3)throw new Error("Sector Shift: Expected 9 saw "+w);break;case 12:if(b!=4)throw new Error("Sector Shift: Expected 12 saw "+w);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+w)}v.chk("0600","Mini Sector Shift: "),v.chk("000000000000","Reserved: ")}function p(v,b){for(var w=Math.ceil(v.length/b)-1,k=[],A=1;A<w;++A)k[A-1]=v.slice(A*b,(A+1)*b);return k[w-1]=v.slice(w*b),k}function m(v,b,w){for(var k=0,A=0,S=0,U=0,K=0,B=w.length,H=[],W=[];k<B;++k)H[k]=W[k]=k,b[k]=w[k];for(;K<W.length;++K)k=W[K],A=v[k].L,S=v[k].R,U=v[k].C,H[k]===k&&(A!==-1&&H[A]!==A&&(H[k]=H[A]),S!==-1&&H[S]!==S&&(H[k]=H[S])),U!==-1&&(H[U]=k),A!==-1&&k!=H[k]&&(H[A]=H[k],W.lastIndexOf(A)<K&&W.push(A)),S!==-1&&k!=H[k]&&(H[S]=H[k],W.lastIndexOf(S)<K&&W.push(S));for(k=1;k<B;++k)H[k]===k&&(S!==-1&&H[S]!==S?H[k]=H[S]:A!==-1&&H[A]!==A&&(H[k]=H[A]));for(k=1;k<B;++k)if(v[k].type!==0){if(K=k,K!=H[K])do K=H[K],b[k]=b[K]+"/"+b[k];while(K!==0&&H[K]!==-1&&K!=H[K]);H[k]=-1}for(b[0]+="/",k=1;k<B;++k)v[k].type!==2&&(b[k]+="/")}function u(v,b,w){for(var k=v.start,A=v.size,S=[],U=k;w&&A>0&&U>=0;)S.push(b.slice(U*P,U*P+P)),A-=P,U=nt(w,U*4);return S.length===0?Ve(0):qr(S).slice(0,v.size)}function g(v,b,w,k,A){var S=J;if(v===J){if(b!==0)throw new Error("DIFAT chain shorter than expected")}else if(v!==-1){var U=w[v],K=(k>>>2)-1;if(!U)return;for(var B=0;B<K&&(S=nt(U,B*4))!==J;++B)A.push(S);g(nt(U,k-4),b-1,w,k,A)}}function _(v,b,w,k,A){var S=[],U=[];A||(A=[]);var K=k-1,B=0,H=0;for(B=b;B>=0;){A[B]=!0,S[S.length]=B,U.push(v[B]);var W=w[Math.floor(B*4/k)];if(H=B*4&K,k<4+H)throw new Error("FAT boundary crossed: "+B+" 4 "+k);if(!v[W])break;B=nt(v[W],H)}return{nodes:S,data:mn([U])}}function F(v,b,w,k){var A=v.length,S=[],U=[],K=[],B=[],H=k-1,W=0,Z=0,ae=0,oe=0;for(W=0;W<A;++W)if(K=[],ae=W+b,ae>=A&&(ae-=A),!U[ae]){B=[];var ee=[];for(Z=ae;Z>=0;){ee[Z]=!0,U[Z]=!0,K[K.length]=Z,B.push(v[Z]);var ce=w[Math.floor(Z*4/k)];if(oe=Z*4&H,k<4+oe)throw new Error("FAT boundary crossed: "+Z+" 4 "+k);if(!v[ce]||(Z=nt(v[ce],oe),ee[Z]))break}S[ae]={nodes:K,data:mn([B])}}return S}function y(v,b,w,k,A,S,U,K){for(var B=0,H=k.length?2:0,W=b[v].data,Z=0,ae=0,oe;Z<W.length;Z+=128){var ee=W.slice(Z,Z+128);ze(ee,64),ae=ee.read_shift(2),oe=_s(ee,0,ae-H),k.push(oe);var ce={name:oe,type:ee.read_shift(1),color:ee.read_shift(1),L:ee.read_shift(4,"i"),R:ee.read_shift(4,"i"),C:ee.read_shift(4,"i"),clsid:ee.read_shift(16),state:ee.read_shift(4,"i"),start:0,size:0},pe=ee.read_shift(2)+ee.read_shift(2)+ee.read_shift(2)+ee.read_shift(2);pe!==0&&(ce.ct=E(ee,ee.l-8));var Ce=ee.read_shift(2)+ee.read_shift(2)+ee.read_shift(2)+ee.read_shift(2);Ce!==0&&(ce.mt=E(ee,ee.l-8)),ce.start=ee.read_shift(4,"i"),ce.size=ee.read_shift(4,"i"),ce.size<0&&ce.start<0&&(ce.size=ce.type=0,ce.start=J,ce.name=""),ce.type===5?(B=ce.start,A>0&&B!==J&&(b[B].name="!StreamData")):ce.size>=4096?(ce.storage="fat",b[ce.start]===void 0&&(b[ce.start]=_(w,ce.start,b.fat_addrs,b.ssz)),b[ce.start].name=ce.name,ce.content=b[ce.start].data.slice(0,ce.size)):(ce.storage="minifat",ce.size<0?ce.size=0:B!==J&&ce.start!==J&&b[B]&&(ce.content=u(ce,b[B].data,(b[K]||{}).data))),ce.content&&ze(ce.content,0),S[oe]=ce,U.push(ce)}}function E(v,b){return new Date((hr(v,b+4)/1e7*Math.pow(2,32)+hr(v,b)/1e7-11644473600)*1e3)}function D(v,b){return f(),o(h.readFileSync(v),b)}function R(v,b){var w=b&&b.type;switch(w||ye&&Buffer.isBuffer(v)&&(w="buffer"),w||"base64"){case"file":return D(v,b);case"base64":return o(Er(xr(v)),b);case"binary":return o(Er(v),b)}return o(v,b)}function T(v,b){var w=b||{},k=w.root||"Root Entry";if(v.FullPaths||(v.FullPaths=[]),v.FileIndex||(v.FileIndex=[]),v.FullPaths.length!==v.FileIndex.length)throw new Error("inconsistent CFB structure");v.FullPaths.length===0&&(v.FullPaths[0]=k+"/",v.FileIndex[0]={name:k,type:5}),w.CLSID&&(v.FileIndex[0].clsid=w.CLSID),M(v)}function M(v){var b="Sh33tJ5";if(!we.find(v,"/"+b)){var w=Ve(4);w[0]=55,w[1]=w[3]=50,w[2]=54,v.FileIndex.push({name:b,type:2,content:w,size:4,L:69,R:69,C:69}),v.FullPaths.push(v.FullPaths[0]+b),I(v)}}function I(v,b){T(v);for(var w=!1,k=!1,A=v.FullPaths.length-1;A>=0;--A){var S=v.FileIndex[A];switch(S.type){case 0:k?w=!0:(v.FileIndex.pop(),v.FullPaths.pop());break;case 1:case 2:case 5:k=!0,isNaN(S.R*S.L*S.C)&&(w=!0),S.R>-1&&S.L>-1&&S.R==S.L&&(w=!0);break;default:w=!0;break}}if(!(!w&&!b)){var U=new Date(1987,1,19),K=0,B=Object.create?Object.create(null):{},H=[];for(A=0;A<v.FullPaths.length;++A)B[v.FullPaths[A]]=!0,v.FileIndex[A].type!==0&&H.push([v.FullPaths[A],v.FileIndex[A]]);for(A=0;A<H.length;++A){var W=a(H[A][0]);k=B[W],k||(H.push([W,{name:s(W).replace("/",""),type:1,clsid:re,ct:U,mt:U,content:null}]),B[W]=!0)}for(H.sort(function(oe,ee){return r(oe[0],ee[0])}),v.FullPaths=[],v.FileIndex=[],A=0;A<H.length;++A)v.FullPaths[A]=H[A][0],v.FileIndex[A]=H[A][1];for(A=0;A<H.length;++A){var Z=v.FileIndex[A],ae=v.FullPaths[A];if(Z.name=s(ae).replace("/",""),Z.L=Z.R=Z.C=-(Z.color=1),Z.size=Z.content?Z.content.length:0,Z.start=0,Z.clsid=Z.clsid||re,A===0)Z.C=H.length>1?1:-1,Z.size=0,Z.type=5;else if(ae.slice(-1)=="/"){for(K=A+1;K<H.length&&a(v.FullPaths[K])!=ae;++K);for(Z.C=K>=H.length?-1:K,K=A+1;K<H.length&&a(v.FullPaths[K])!=a(ae);++K);Z.R=K>=H.length?-1:K,Z.type=1}else a(v.FullPaths[A+1]||"")==a(ae)&&(Z.R=A+1),Z.type=2}}}function V(v,b){var w=b||{};if(w.fileType=="mad")return tc(v,w);switch(I(v),w.fileType){case"zip":return K0(v,w)}var k=function(oe){for(var ee=0,ce=0,pe=0;pe<oe.FileIndex.length;++pe){var Ce=oe.FileIndex[pe];if(Ce.content){var Ne=Ce.content.length;Ne>0&&(Ne<4096?ee+=Ne+63>>6:ce+=Ne+511>>9)}}for(var Ke=oe.FullPaths.length+3>>2,Pt=ee+7>>3,jt=ee+127>>7,Mt=Pt+ce+Ke+jt,st=Mt+127>>7,Ua=st<=109?0:Math.ceil((st-109)/127);Mt+st+Ua+127>>7>st;)Ua=++st<=109?0:Math.ceil((st-109)/127);var Lr=[1,Ua,st,jt,Ke,ce,ee,0];return oe.FileIndex[0].size=ee<<6,Lr[7]=(oe.FileIndex[0].start=Lr[0]+Lr[1]+Lr[2]+Lr[3]+Lr[4]+Lr[5])+(Lr[6]+7>>3),Lr}(v),A=Ve(k[7]<<9),S=0,U=0;{for(S=0;S<8;++S)A.write_shift(1,X[S]);for(S=0;S<8;++S)A.write_shift(2,0);for(A.write_shift(2,62),A.write_shift(2,3),A.write_shift(2,65534),A.write_shift(2,9),A.write_shift(2,6),S=0;S<3;++S)A.write_shift(2,0);for(A.write_shift(4,0),A.write_shift(4,k[2]),A.write_shift(4,k[0]+k[1]+k[2]+k[3]-1),A.write_shift(4,0),A.write_shift(4,4096),A.write_shift(4,k[3]?k[0]+k[1]+k[2]-1:J),A.write_shift(4,k[3]),A.write_shift(-4,k[1]?k[0]-1:J),A.write_shift(4,k[1]),S=0;S<109;++S)A.write_shift(-4,S<k[2]?k[1]+S:-1)}if(k[1])for(U=0;U<k[1];++U){for(;S<236+U*127;++S)A.write_shift(-4,S<k[2]?k[1]+S:-1);A.write_shift(-4,U===k[1]-1?J:U+1)}var K=function(oe){for(U+=oe;S<U-1;++S)A.write_shift(-4,S+1);oe&&(++S,A.write_shift(-4,J))};for(U=S=0,U+=k[1];S<U;++S)A.write_shift(-4,ne.DIFSECT);for(U+=k[2];S<U;++S)A.write_shift(-4,ne.FATSECT);K(k[3]),K(k[4]);for(var B=0,H=0,W=v.FileIndex[0];B<v.FileIndex.length;++B)W=v.FileIndex[B],W.content&&(H=W.content.length,!(H<4096)&&(W.start=U,K(H+511>>9)));for(K(k[6]+7>>3);A.l&511;)A.write_shift(-4,ne.ENDOFCHAIN);for(U=S=0,B=0;B<v.FileIndex.length;++B)W=v.FileIndex[B],W.content&&(H=W.content.length,!(!H||H>=4096)&&(W.start=U,K(H+63>>6)));for(;A.l&511;)A.write_shift(-4,ne.ENDOFCHAIN);for(S=0;S<k[4]<<2;++S){var Z=v.FullPaths[S];if(!Z||Z.length===0){for(B=0;B<17;++B)A.write_shift(4,0);for(B=0;B<3;++B)A.write_shift(4,-1);for(B=0;B<12;++B)A.write_shift(4,0);continue}W=v.FileIndex[S],S===0&&(W.start=W.size?W.start-1:J);var ae=S===0&&w.root||W.name;if(H=2*(ae.length+1),A.write_shift(64,ae,"utf16le"),A.write_shift(2,H),A.write_shift(1,W.type),A.write_shift(1,W.color),A.write_shift(-4,W.L),A.write_shift(-4,W.R),A.write_shift(-4,W.C),W.clsid)A.write_shift(16,W.clsid,"hex");else for(B=0;B<4;++B)A.write_shift(4,0);A.write_shift(4,W.state||0),A.write_shift(4,0),A.write_shift(4,0),A.write_shift(4,0),A.write_shift(4,0),A.write_shift(4,W.start),A.write_shift(4,W.size),A.write_shift(4,0)}for(S=1;S<v.FileIndex.length;++S)if(W=v.FileIndex[S],W.size>=4096)if(A.l=W.start+1<<9,ye&&Buffer.isBuffer(W.content))W.content.copy(A,A.l,0,W.size),A.l+=W.size+511&-512;else{for(B=0;B<W.size;++B)A.write_shift(1,W.content[B]);for(;B&511;++B)A.write_shift(1,0)}for(S=1;S<v.FileIndex.length;++S)if(W=v.FileIndex[S],W.size>0&&W.size<4096)if(ye&&Buffer.isBuffer(W.content))W.content.copy(A,A.l,0,W.size),A.l+=W.size+63&-64;else{for(B=0;B<W.size;++B)A.write_shift(1,W.content[B]);for(;B&63;++B)A.write_shift(1,0)}if(ye)A.l=A.length;else for(;A.l<A.length;)A.write_shift(1,0);return A}function L(v,b){var w=v.FullPaths.map(function(B){return B.toUpperCase()}),k=w.map(function(B){var H=B.split("/");return H[H.length-(B.slice(-1)=="/"?2:1)]}),A=!1;b.charCodeAt(0)===47?(A=!0,b=w[0].slice(0,-1)+b):A=b.indexOf("/")!==-1;var S=b.toUpperCase(),U=A===!0?w.indexOf(S):k.indexOf(S);if(U!==-1)return v.FileIndex[U];var K=!S.match(Bt);for(S=S.replace(cr,""),K&&(S=S.replace(Bt,"!")),U=0;U<w.length;++U)if((K?w[U].replace(Bt,"!"):w[U]).replace(cr,"")==S||(K?k[U].replace(Bt,"!"):k[U]).replace(cr,"")==S)return v.FileIndex[U];return null}var P=64,J=-2,Y="d0cf11e0a1b11ae1",X=[208,207,17,224,161,177,26,225],re="00000000000000000000000000000000",ne={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:J,FREESECT:-1,HEADER_SIGNATURE:Y,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:re,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function be(v,b,w){f();var k=V(v,w);h.writeFileSync(b,k)}function z(v){for(var b=new Array(v.length),w=0;w<v.length;++w)b[w]=String.fromCharCode(v[w]);return b.join("")}function ue(v,b){var w=V(v,b);switch(b&&b.type||"buffer"){case"file":return f(),h.writeFileSync(b.filename,w),w;case"binary":return typeof w=="string"?w:z(w);case"base64":return Js(typeof w=="string"?w:z(w));case"buffer":if(ye)return Buffer.isBuffer(w)?w:xt(w);case"array":return typeof w=="string"?Er(w):w}return w}var xe;function C(v){try{var b=v.InflateRaw,w=new b;if(w._processChunk(new Uint8Array([3,0]),w._finishFlushFlag),w.bytesRead)xe=v;else throw new Error("zlib does not expose bytesRead")}catch(k){console.error("cannot use native zlib: "+(k.message||k))}}function G(v,b){if(!xe)return Vs(v,b);var w=xe.InflateRaw,k=new w,A=k._processChunk(v.slice(v.l),k._finishFlushFlag);return v.l+=k.bytesRead,A}function j(v){return xe?xe.deflateRawSync(v):ge(v)}var O=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],q=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],se=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function le(v){var b=(v<<1|v<<11)&139536|(v<<5|v<<15)&558144;return(b>>16|b>>8|b)&255}for(var te=typeof Uint8Array<"u",Q=te?new Uint8Array(256):[],_e=0;_e<256;++_e)Q[_e]=le(_e);function N(v,b){var w=Q[v&255];return b<=8?w>>>8-b:(w=w<<8|Q[v>>8&255],b<=16?w>>>16-b:(w=w<<8|Q[v>>16&255],w>>>24-b))}function Ie(v,b){var w=b&7,k=b>>>3;return(v[k]|(w<=6?0:v[k+1]<<8))>>>w&3}function Ee(v,b){var w=b&7,k=b>>>3;return(v[k]|(w<=5?0:v[k+1]<<8))>>>w&7}function Ae(v,b){var w=b&7,k=b>>>3;return(v[k]|(w<=4?0:v[k+1]<<8))>>>w&15}function ve(v,b){var w=b&7,k=b>>>3;return(v[k]|(w<=3?0:v[k+1]<<8))>>>w&31}function ie(v,b){var w=b&7,k=b>>>3;return(v[k]|(w<=1?0:v[k+1]<<8))>>>w&127}function Oe(v,b,w){var k=b&7,A=b>>>3,S=(1<<w)-1,U=v[A]>>>k;return w<8-k||(U|=v[A+1]<<8-k,w<16-k)||(U|=v[A+2]<<16-k,w<24-k)||(U|=v[A+3]<<24-k),U&S}function dr(v,b,w){var k=b&7,A=b>>>3;return k<=5?v[A]|=(w&7)<<k:(v[A]|=w<<k&255,v[A+1]=(w&7)>>8-k),b+3}function Fr(v,b,w){var k=b&7,A=b>>>3;return w=(w&1)<<k,v[A]|=w,b+1}function jr(v,b,w){var k=b&7,A=b>>>3;return w<<=k,v[A]|=w&255,w>>>=8,v[A+1]=w,b+8}function It(v,b,w){var k=b&7,A=b>>>3;return w<<=k,v[A]|=w&255,w>>>=8,v[A+1]=w&255,v[A+2]=w>>>8,b+16}function zr(v,b){var w=v.length,k=2*w>b?2*w:b+5,A=0;if(w>=b)return v;if(ye){var S=Zs(k);if(v.copy)v.copy(S);else for(;A<v.length;++A)S[A]=v[A];return S}else if(te){var U=new Uint8Array(k);if(U.set)U.set(v);else for(;A<w;++A)U[A]=v[A];return U}return v.length=k,v}function fr(v){for(var b=new Array(v),w=0;w<v;++w)b[w]=0;return b}function Mr(v,b,w){var k=1,A=0,S=0,U=0,K=0,B=v.length,H=te?new Uint16Array(32):fr(32);for(S=0;S<32;++S)H[S]=0;for(S=B;S<w;++S)v[S]=0;B=v.length;var W=te?new Uint16Array(B):fr(B);for(S=0;S<B;++S)H[A=v[S]]++,k<A&&(k=A),W[S]=0;for(H[0]=0,S=1;S<=k;++S)H[S+16]=K=K+H[S-1]<<1;for(S=0;S<B;++S)K=v[S],K!=0&&(W[S]=H[K+16]++);var Z=0;for(S=0;S<B;++S)if(Z=v[S],Z!=0)for(K=N(W[S],k)>>k-Z,U=(1<<k+4-Z)-1;U>=0;--U)b[K|U<<Z]=Z&15|S<<4;return k}var Yr=te?new Uint16Array(512):fr(512),Ot=te?new Uint16Array(32):fr(32);if(!te){for(var ar=0;ar<512;++ar)Yr[ar]=0;for(ar=0;ar<32;++ar)Ot[ar]=0}(function(){for(var v=[],b=0;b<32;b++)v.push(5);Mr(v,Ot,32);var w=[];for(b=0;b<=143;b++)w.push(8);for(;b<=255;b++)w.push(9);for(;b<=279;b++)w.push(7);for(;b<=287;b++)w.push(8);Mr(w,Yr,288)})();var Cr=function(){for(var b=te?new Uint8Array(32768):[],w=0,k=0;w<se.length-1;++w)for(;k<se[w+1];++k)b[k]=w;for(;k<32768;++k)b[k]=29;var A=te?new Uint8Array(259):[];for(w=0,k=0;w<q.length-1;++w)for(;k<q[w+1];++k)A[k]=w;function S(K,B){for(var H=0;H<K.length;){var W=Math.min(65535,K.length-H),Z=H+W==K.length;for(B.write_shift(1,+Z),B.write_shift(2,W),B.write_shift(2,~W&65535);W-- >0;)B[B.l++]=K[H++]}return B.l}function U(K,B){for(var H=0,W=0,Z=te?new Uint16Array(32768):[];W<K.length;){var ae=Math.min(65535,K.length-W);if(ae<10){for(H=dr(B,H,+(W+ae==K.length)),H&7&&(H+=8-(H&7)),B.l=H/8|0,B.write_shift(2,ae),B.write_shift(2,~ae&65535);ae-- >0;)B[B.l++]=K[W++];H=B.l*8;continue}H=dr(B,H,+(W+ae==K.length)+2);for(var oe=0;ae-- >0;){var ee=K[W];oe=(oe<<5^ee)&32767;var ce=-1,pe=0;if((ce=Z[oe])&&(ce|=W&-32768,ce>W&&(ce-=32768),ce<W))for(;K[ce+pe]==K[W+pe]&&pe<250;)++pe;if(pe>2){ee=A[pe],ee<=22?H=jr(B,H,Q[ee+1]>>1)-1:(jr(B,H,3),H+=5,jr(B,H,Q[ee-23]>>5),H+=3);var Ce=ee<8?0:ee-4>>2;Ce>0&&(It(B,H,pe-q[ee]),H+=Ce),ee=b[W-ce],H=jr(B,H,Q[ee]>>3),H-=3;var Ne=ee<4?0:ee-2>>1;Ne>0&&(It(B,H,W-ce-se[ee]),H+=Ne);for(var Ke=0;Ke<pe;++Ke)Z[oe]=W&32767,oe=(oe<<5^K[W])&32767,++W;ae-=pe-1}else ee<=143?ee=ee+48:H=Fr(B,H,1),H=jr(B,H,Q[ee]),Z[oe]=W&32767,++W}H=jr(B,H,0)-1}return B.l=(H+7)/8|0,B.l}return function(B,H){return B.length<8?S(B,H):U(B,H)}}();function ge(v){var b=Ve(50+Math.floor(v.length*1.1)),w=Cr(v,b);return b.slice(0,w)}var Pe=te?new Uint16Array(32768):fr(32768),pr=te?new Uint16Array(32768):fr(32768),Ue=te?new Uint16Array(128):fr(128),at=1,Us=1;function z0(v,b){var w=ve(v,b)+257;b+=5;var k=ve(v,b)+1;b+=5;var A=Ae(v,b)+4;b+=4;for(var S=0,U=te?new Uint8Array(19):fr(19),K=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],B=1,H=te?new Uint8Array(8):fr(8),W=te?new Uint8Array(8):fr(8),Z=U.length,ae=0;ae<A;++ae)U[O[ae]]=S=Ee(v,b),B<S&&(B=S),H[S]++,b+=3;var oe=0;for(H[0]=0,ae=1;ae<=B;++ae)W[ae]=oe=oe+H[ae-1]<<1;for(ae=0;ae<Z;++ae)(oe=U[ae])!=0&&(K[ae]=W[oe]++);var ee=0;for(ae=0;ae<Z;++ae)if(ee=U[ae],ee!=0){oe=Q[K[ae]]>>8-ee;for(var ce=(1<<7-ee)-1;ce>=0;--ce)Ue[oe|ce<<ee]=ee&7|ae<<3}var pe=[];for(B=1;pe.length<w+k;)switch(oe=Ue[ie(v,b)],b+=oe&7,oe>>>=3){case 16:for(S=3+Ie(v,b),b+=2,oe=pe[pe.length-1];S-- >0;)pe.push(oe);break;case 17:for(S=3+Ee(v,b),b+=3;S-- >0;)pe.push(0);break;case 18:for(S=11+ie(v,b),b+=7;S-- >0;)pe.push(0);break;default:pe.push(oe),B<oe&&(B=oe);break}var Ce=pe.slice(0,w),Ne=pe.slice(w);for(ae=w;ae<286;++ae)Ce[ae]=0;for(ae=k;ae<30;++ae)Ne[ae]=0;return at=Mr(Ce,Pe,286),Us=Mr(Ne,pr,30),b}function Y0(v,b){if(v[0]==3&&!(v[1]&3))return[et(b),2];for(var w=0,k=0,A=Zs(b||1<<18),S=0,U=A.length>>>0,K=0,B=0;!(k&1);){if(k=Ee(v,w),w+=3,k>>>1)k>>1==1?(K=9,B=5):(w=z0(v,w),K=at,B=Us);else{w&7&&(w+=8-(w&7));var H=v[w>>>3]|v[(w>>>3)+1]<<8;if(w+=32,H>0)for(!b&&U<S+H&&(A=zr(A,S+H),U=A.length);H-- >0;)A[S++]=v[w>>>3],w+=8;continue}for(;;){!b&&U<S+32767&&(A=zr(A,S+32767),U=A.length);var W=Oe(v,w,K),Z=k>>>1==1?Yr[W]:Pe[W];if(w+=Z&15,Z>>>=4,!(Z>>>8&255))A[S++]=Z;else{if(Z==256)break;Z-=257;var ae=Z<8?0:Z-4>>2;ae>5&&(ae=0);var oe=S+q[Z];ae>0&&(oe+=Oe(v,w,ae),w+=ae),W=Oe(v,w,B),Z=k>>>1==1?Ot[W]:pr[W],w+=Z&15,Z>>>=4;var ee=Z<4?0:Z-2>>1,ce=se[Z];for(ee>0&&(ce+=Oe(v,w,ee),w+=ee),!b&&U<oe&&(A=zr(A,oe+100),U=A.length);S<oe;)A[S]=A[S-ce],++S}}}return b?[A,w+7>>>3]:[A.slice(0,S),w+7>>>3]}function Vs(v,b){var w=v.slice(v.l||0),k=Y0(w,b);return v.l+=k[1],k[0]}function Hs(v,b){if(v)typeof console<"u"&&console.error(b);else throw new Error(b)}function Gs(v,b){var w=v;ze(w,0);var k=[],A=[],S={FileIndex:k,FullPaths:A};T(S,{root:b.root});for(var U=w.length-4;(w[U]!=80||w[U+1]!=75||w[U+2]!=5||w[U+3]!=6)&&U>=0;)--U;w.l=U+4,w.l+=4;var K=w.read_shift(2);w.l+=6;var B=w.read_shift(4);for(w.l=B,U=0;U<K;++U){w.l+=20;var H=w.read_shift(4),W=w.read_shift(4),Z=w.read_shift(2),ae=w.read_shift(2),oe=w.read_shift(2);w.l+=8;var ee=w.read_shift(4),ce=c(w.slice(w.l+Z,w.l+Z+ae));w.l+=Z+ae+oe;var pe=w.l;w.l=ee+4,X0(w,H,W,S,ce),w.l=pe}return S}function X0(v,b,w,k,A){v.l+=2;var S=v.read_shift(2),U=v.read_shift(2),K=i(v);if(S&8257)throw new Error("Unsupported ZIP encryption");for(var B=v.read_shift(4),H=v.read_shift(4),W=v.read_shift(4),Z=v.read_shift(2),ae=v.read_shift(2),oe="",ee=0;ee<Z;++ee)oe+=String.fromCharCode(v[v.l++]);if(ae){var ce=c(v.slice(v.l,v.l+ae));(ce[21589]||{}).mt&&(K=ce[21589].mt),((A||{})[21589]||{}).mt&&(K=A[21589].mt)}v.l+=ae;var pe=v.slice(v.l,v.l+H);switch(U){case 8:pe=G(v,W);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+U)}var Ce=!1;S&8&&(B=v.read_shift(4),B==134695760&&(B=v.read_shift(4),Ce=!0),H=v.read_shift(4),W=v.read_shift(4)),H!=b&&Hs(Ce,"Bad compressed size: "+b+" != "+H),W!=w&&Hs(Ce,"Bad uncompressed size: "+w+" != "+W),Ba(k,oe,pe,{unsafe:!0,mt:K})}function K0(v,b){var w=b||{},k=[],A=[],S=Ve(1),U=w.compression?8:0,K=0,B=0,H=0,W=0,Z=0,ae=v.FullPaths[0],oe=ae,ee=v.FileIndex[0],ce=[],pe=0;for(B=1;B<v.FullPaths.length;++B)if(oe=v.FullPaths[B].slice(ae.length),ee=v.FileIndex[B],!(!ee.size||!ee.content||oe=="Sh33tJ5")){var Ce=W,Ne=Ve(oe.length);for(H=0;H<oe.length;++H)Ne.write_shift(1,oe.charCodeAt(H)&127);Ne=Ne.slice(0,Ne.l),ce[Z]=Hl.buf(ee.content,0);var Ke=ee.content;U==8&&(Ke=j(Ke)),S=Ve(30),S.write_shift(4,67324752),S.write_shift(2,20),S.write_shift(2,K),S.write_shift(2,U),ee.mt?n(S,ee.mt):S.write_shift(4,0),S.write_shift(-4,ce[Z]),S.write_shift(4,Ke.length),S.write_shift(4,ee.content.length),S.write_shift(2,Ne.length),S.write_shift(2,0),W+=S.length,k.push(S),W+=Ne.length,k.push(Ne),W+=Ke.length,k.push(Ke),S=Ve(46),S.write_shift(4,33639248),S.write_shift(2,0),S.write_shift(2,20),S.write_shift(2,K),S.write_shift(2,U),S.write_shift(4,0),S.write_shift(-4,ce[Z]),S.write_shift(4,Ke.length),S.write_shift(4,ee.content.length),S.write_shift(2,Ne.length),S.write_shift(2,0),S.write_shift(2,0),S.write_shift(2,0),S.write_shift(2,0),S.write_shift(4,0),S.write_shift(4,Ce),pe+=S.l,A.push(S),pe+=Ne.length,A.push(Ne),++Z}return S=Ve(22),S.write_shift(4,101010256),S.write_shift(2,0),S.write_shift(2,0),S.write_shift(2,Z),S.write_shift(2,Z),S.write_shift(4,pe),S.write_shift(4,W),S.write_shift(2,0),qr([qr(k),qr(A),S])}var ua={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function q0(v,b){if(v.ctype)return v.ctype;var w=v.name||"",k=w.match(/\.([^\.]+)$/);return k&&ua[k[1]]||b&&(k=(w=b).match(/[\.\\]([^\.\\])+$/),k&&ua[k[1]])?ua[k[1]]:"application/octet-stream"}function J0(v){for(var b=Js(v),w=[],k=0;k<b.length;k+=76)w.push(b.slice(k,k+76));return w.join(`\r
`)+`\r
`}function Z0(v){var b=v.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(H){var W=H.charCodeAt(0).toString(16).toUpperCase();return"="+(W.length==1?"0"+W:W)});b=b.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),b.charAt(0)==`
`&&(b="=0D"+b.slice(1)),b=b.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var w=[],k=b.split(`\r
`),A=0;A<k.length;++A){var S=k[A];if(S.length==0){w.push("");continue}for(var U=0;U<S.length;){var K=76,B=S.slice(U,U+K);B.charAt(K-1)=="="?K--:B.charAt(K-2)=="="?K-=2:B.charAt(K-3)=="="&&(K-=3),B=S.slice(U,U+K),U+=K,U<S.length&&(B+="="),w.push(B)}}return w.join(`\r
`)}function Q0(v){for(var b=[],w=0;w<v.length;++w){for(var k=v[w];w<=v.length&&k.charAt(k.length-1)=="=";)k=k.slice(0,k.length-1)+v[++w];b.push(k)}for(var A=0;A<b.length;++A)b[A]=b[A].replace(/[=][0-9A-Fa-f]{2}/g,function(S){return String.fromCharCode(parseInt(S.slice(1),16))});return Er(b.join(`\r
`))}function ec(v,b,w){for(var k="",A="",S="",U,K=0;K<10;++K){var B=b[K];if(!B||B.match(/^\s*$/))break;var H=B.match(/^(.*?):\s*([^\s].*)$/);if(H)switch(H[1].toLowerCase()){case"content-location":k=H[2].trim();break;case"content-type":S=H[2].trim();break;case"content-transfer-encoding":A=H[2].trim();break}}switch(++K,A.toLowerCase()){case"base64":U=Er(xr(b.slice(K).join("")));break;case"quoted-printable":U=Q0(b.slice(K));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+A)}var W=Ba(v,k.slice(w.length),U,{unsafe:!0});S&&(W.ctype=S)}function rc(v,b){if(z(v.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var w=b&&b.root||"",k=(ye&&Buffer.isBuffer(v)?v.toString("binary"):z(v)).split(`\r
`),A=0,S="";for(A=0;A<k.length;++A)if(S=k[A],!!/^Content-Location:/i.test(S)&&(S=S.slice(S.indexOf("file")),w||(w=S.slice(0,S.lastIndexOf("/")+1)),S.slice(0,w.length)!=w))for(;w.length>0&&(w=w.slice(0,w.length-1),w=w.slice(0,w.lastIndexOf("/")+1),S.slice(0,w.length)!=w););var U=(k[1]||"").match(/boundary="(.*?)"/);if(!U)throw new Error("MAD cannot find boundary");var K="--"+(U[1]||""),B=[],H=[],W={FileIndex:B,FullPaths:H};T(W);var Z,ae=0;for(A=0;A<k.length;++A){var oe=k[A];oe!==K&&oe!==K+"--"||(ae++&&ec(W,k.slice(Z,A),w),Z=A)}return W}function tc(v,b){var w=b||{},k=w.boundary||"SheetJS";k="------="+k;for(var A=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+k.slice(2)+'"',"","",""],S=v.FullPaths[0],U=S,K=v.FileIndex[0],B=1;B<v.FullPaths.length;++B)if(U=v.FullPaths[B].slice(S.length),K=v.FileIndex[B],!(!K.size||!K.content||U=="Sh33tJ5")){U=U.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(pe){return"_x"+pe.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(pe){return"_u"+pe.charCodeAt(0).toString(16)+"_"});for(var H=K.content,W=ye&&Buffer.isBuffer(H)?H.toString("binary"):z(H),Z=0,ae=Math.min(1024,W.length),oe=0,ee=0;ee<=ae;++ee)(oe=W.charCodeAt(ee))>=32&&oe<128&&++Z;var ce=Z>=ae*4/5;A.push(k),A.push("Content-Location: "+(w.root||"file:///C:/SheetJS/")+U),A.push("Content-Transfer-Encoding: "+(ce?"quoted-printable":"base64")),A.push("Content-Type: "+q0(K,U)),A.push(""),A.push(ce?Z0(W):J0(W))}return A.push(k+`--\r
`),A.join(`\r
`)}function ac(v){var b={};return T(b,v),b}function Ba(v,b,w,k){var A=k&&k.unsafe;A||T(v);var S=!A&&we.find(v,b);if(!S){var U=v.FullPaths[0];b.slice(0,U.length)==U?U=b:(U.slice(-1)!="/"&&(U+="/"),U=(U+b).replace("//","/")),S={name:s(b),type:2},v.FileIndex.push(S),v.FullPaths.push(U),A||we.utils.cfb_gc(v)}return S.content=w,S.size=w?w.length:0,k&&(k.CLSID&&(S.clsid=k.CLSID),k.mt&&(S.mt=k.mt),k.ct&&(S.ct=k.ct)),S}function sc(v,b){T(v);var w=we.find(v,b);if(w){for(var k=0;k<v.FileIndex.length;++k)if(v.FileIndex[k]==w)return v.FileIndex.splice(k,1),v.FullPaths.splice(k,1),!0}return!1}function nc(v,b,w){T(v);var k=we.find(v,b);if(k){for(var A=0;A<v.FileIndex.length;++A)if(v.FileIndex[A]==k)return v.FileIndex[A].name=s(w),v.FullPaths[A]=w,!0}return!1}function ic(v){I(v,!0)}return t.find=L,t.read=R,t.parse=o,t.write=ue,t.writeFile=be,t.utils={cfb_new:ac,cfb_add:Ba,cfb_del:sc,cfb_mov:nc,cfb_gc:ic,ReadShift:Ht,CheckField:Xi,prep_blob:ze,bconcat:qr,use_zlib:C,_deflateRaw:ge,_inflateRaw:Vs,consts:ne},t}();function Gl(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(a){if(!a.message||!a.message.match(/onstruct/))throw a}throw new Error("Cannot access file "+e)}function Ir(e){for(var t=Object.keys(e),r=[],a=0;a<t.length;++a)Object.prototype.hasOwnProperty.call(e,t[a])&&r.push(t[a]);return r}function vs(e){for(var t=[],r=Ir(e),a=0;a!==r.length;++a)t[e[r[a]]]=r[a];return t}var Aa=new Date(1899,11,30,0,0,0);function lr(e,t){var r=e.getTime();t&&(r-=1462*24*60*60*1e3);var a=Aa.getTime()+(e.getTimezoneOffset()-Aa.getTimezoneOffset())*6e4;return(r-a)/(24*60*60*1e3)}var Ai=new Date,Wl=Aa.getTime()+(Ai.getTimezoneOffset()-Aa.getTimezoneOffset())*6e4,cn=Ai.getTimezoneOffset();function Pa(e){var t=new Date;return t.setTime(e*24*60*60*1e3+Wl),t.getTimezoneOffset()!==cn&&t.setTime(t.getTime()+(t.getTimezoneOffset()-cn)*6e4),t}function $l(e){var t=0,r=0,a=!1,s=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var n=1;n!=s.length;++n)if(s[n]){switch(r=1,n>3&&(a=!0),s[n].slice(s[n].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[n].slice(s[n].length-1));case"D":r*=24;case"H":r*=60;case"M":if(a)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(s[n],10)}return t}var ln=new Date("2017-02-19T19:06:09.000Z"),Si=isNaN(ln.getFullYear())?new Date("2/19/17"):ln,zl=Si.getFullYear()==2017;function $e(e,t){var r=new Date(e);if(zl)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(Si.getFullYear()==1917&&!isNaN(r.getFullYear())){var a=r.getFullYear();return e.indexOf(""+a)>-1||r.setFullYear(r.getFullYear()+100),r}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],n=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(n=new Date(n.getTime()-n.getTimezoneOffset()*60*1e3)),n}function ht(e,t){if(ye&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Vt(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Vt(xi(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Vt(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Vt(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(n){return r[n]||n})}catch{}for(var a=[],s=0;s!=e.length;++s)a.push(String.fromCharCode(e[s]));return a.join("")}function Ye(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Ye(e[r]));return t}function Re(e,t){for(var r="";r.length<t;)r+=e;return r}function Sr(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,a=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(a))||(a=a.replace(/[(](.*)[)]/,function(s,n){return r=-r,n}),!isNaN(t=Number(a)))?t/r:t}var Yl=["january","february","march","april","may","june","july","august","september","october","november","december"];function Ft(e){var t=new Date(e),r=new Date(NaN),a=t.getYear(),s=t.getMonth(),n=t.getDate();if(isNaN(n))return r;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),i.length>3&&Yl.indexOf(i)==-1)return r}else if(i.match(/[a-z]/))return r;return a<0||a>8099?r:(s>0||n>1)&&a!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var Xl=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,a,s){if(e||typeof a=="string")return r.split(a);for(var n=r.split(a),i=[n[0]],c=1;c<n.length;++c)i.push(s),i.push(n[c]);return i}}();function Fi(e){return e?e.content&&e.type?ht(e.content,!0):e.data?Lt(e.data):e.asNodeBuffer&&ye?Lt(e.asNodeBuffer().toString("binary")):e.asBinary?Lt(e.asBinary()):e._data&&e._data.getContent?Lt(ht(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function Ci(e){if(!e)return null;if(e.data)return Ks(e.data);if(e.asNodeBuffer&&ye)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?Ks(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function Kl(e){return e&&e.name.slice(-4)===".bin"?Ci(e):Fi(e)}function vr(e,t){for(var r=e.FullPaths||Ir(e.files),a=t.toLowerCase().replace(/[\/]/g,"\\"),s=a.replace(/\\/g,"/"),n=0;n<r.length;++n){var i=r[n].replace(/^Root Entry[\/]/,"").toLowerCase();if(a==i||s==i)return e.files?e.files[r[n]]:e.FileIndex[n]}return null}function ys(e,t){var r=vr(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Le(e,t,r){if(!r)return Kl(ys(e,t));if(!t)return null;try{return Le(e,t)}catch{return null}}function ur(e,t,r){if(!r)return Fi(ys(e,t));if(!t)return null;try{return ur(e,t)}catch{return null}}function Ni(e,t,r){if(!r)return Ci(ys(e,t));if(!t)return null;try{return Ni(e,t)}catch{return null}}function on(e){for(var t=e.FullPaths||Ir(e.files),r=[],a=0;a<t.length;++a)t[a].slice(-1)!="/"&&r.push(t[a].replace(/^Root Entry[\/]/,""));return r.sort()}function ql(e,t,r){if(e.FullPaths){if(typeof r=="string"){var a;return ye?a=xt(r):a=ml(r),we.utils.cfb_add(e,t,a)}we.utils.cfb_add(e,t,r)}else e.file(t,r)}function Ri(e,t){switch(t.type){case"base64":return we.read(e,{type:"base64"});case"binary":return we.read(e,{type:"binary"});case"buffer":case"array":return we.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Ut(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var a=e.split("/");a.length!==0;){var s=a.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var Di=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,Jl=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,fn=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,Zl=/<[^>]*>/g,tr=Di.match(fn)?fn:Zl,Ql=/<\w*:/,eo=/<(\/?)\w+:/;function he(e,t,r){for(var a={},s=0,n=0;s!==e.length&&!((n=e.charCodeAt(s))===32||n===10||n===13);++s);if(t||(a[0]=e.slice(0,s)),s===e.length)return a;var i=e.match(Jl),c=0,h="",f=0,o="",x="",d=1;if(i)for(f=0;f!=i.length;++f){for(x=i[f],n=0;n!=x.length&&x.charCodeAt(n)!==61;++n);for(o=x.slice(0,n).trim();x.charCodeAt(n+1)==32;)++n;for(d=(s=x.charCodeAt(n+1))==34||s==39?1:0,h=x.slice(n+1+d,x.length-d),c=0;c!=o.length&&o.charCodeAt(c)!==58;++c);if(c===o.length)o.indexOf("_")>0&&(o=o.slice(0,o.indexOf("_"))),a[o]=h,r||(a[o.toLowerCase()]=h);else{var p=(c===5&&o.slice(0,5)==="xmlns"?"xmlns":"")+o.slice(c+1);if(a[p]&&o.slice(c-3,c)=="ext")continue;a[p]=h,r||(a[p.toLowerCase()]=h)}}return a}function Or(e){return e.replace(eo,"<$1")}var Ii={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},ro=vs(Ii),ke=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(a){var s=a+"",n=s.indexOf("<![CDATA[");if(n==-1)return s.replace(e,function(c,h){return Ii[c]||String.fromCharCode(parseInt(h,c.indexOf("x")>-1?16:10))||c}).replace(t,function(c,h){return String.fromCharCode(parseInt(h,16))});var i=s.indexOf("]]>");return r(s.slice(0,n))+s.slice(n+9,i)+r(s.slice(i+3))}}(),to=/[&<>'"]/g,ao=/[\u0000-\u001f]/g;function ws(e){var t=e+"";return t.replace(to,function(r){return ro[r]}).replace(/\n/g,"<br/>").replace(ao,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var hn=function(){var e=/&#(\d+);/g;function t(r,a){return String.fromCharCode(parseInt(a,10))}return function(a){return a.replace(e,t)}}();function Fe(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Ha(e){for(var t="",r=0,a=0,s=0,n=0,i=0,c=0;r<e.length;){if(a=e.charCodeAt(r++),a<128){t+=String.fromCharCode(a);continue}if(s=e.charCodeAt(r++),a>191&&a<224){i=(a&31)<<6,i|=s&63,t+=String.fromCharCode(i);continue}if(n=e.charCodeAt(r++),a<240){t+=String.fromCharCode((a&15)<<12|(s&63)<<6|n&63);continue}i=e.charCodeAt(r++),c=((a&7)<<18|(s&63)<<12|(n&63)<<6|i&63)-65536,t+=String.fromCharCode(55296+(c>>>10&1023)),t+=String.fromCharCode(56320+(c&1023))}return t}function un(e){var t=et(2*e.length),r,a,s=1,n=0,i=0,c;for(a=0;a<e.length;a+=s)s=1,(c=e.charCodeAt(a))<128?r=c:c<224?(r=(c&31)*64+(e.charCodeAt(a+1)&63),s=2):c<240?(r=(c&15)*4096+(e.charCodeAt(a+1)&63)*64+(e.charCodeAt(a+2)&63),s=3):(s=4,r=(c&7)*262144+(e.charCodeAt(a+1)&63)*4096+(e.charCodeAt(a+2)&63)*64+(e.charCodeAt(a+3)&63),r-=65536,i=55296+(r>>>10&1023),r=56320+(r&1023)),i!==0&&(t[n++]=i&255,t[n++]=i>>>8,i=0),t[n++]=r%256,t[n++]=r>>>8;return t.slice(0,n).toString("ucs2")}function xn(e){return xt(e,"binary").toString("utf8")}var da="foo bar bazâð£",Se=ye&&(xn(da)==Ha(da)&&xn||un(da)==Ha(da)&&un)||Ha,Vt=ye?function(e){return xt(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,a=0,s=0;r<e.length;)switch(a=e.charCodeAt(r++),!0){case a<128:t.push(String.fromCharCode(a));break;case a<2048:t.push(String.fromCharCode(192+(a>>6))),t.push(String.fromCharCode(128+(a&63)));break;case(a>=55296&&a<57344):a-=55296,s=e.charCodeAt(r++)-56320+(a<<10),t.push(String.fromCharCode(240+(s>>18&7))),t.push(String.fromCharCode(144+(s>>12&63))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)));break;default:t.push(String.fromCharCode(224+(a>>12))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)))}return t.join("")},Qt=function(){var e={};return function(r,a){var s=r+"|"+(a||"");return e[s]?e[s]:e[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",a||"")}}(),Oi=function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var a=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)a=a.replace(e[s][0],e[s][1]);return a}}(),so=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),no=/<\/?(?:vt:)?variant>/g,io=/<(?:vt:)([^>]*)>([\s\S]*)</;function dn(e,t){var r=he(e),a=e.match(so(r.baseType))||[],s=[];if(a.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+a.length+" != "+r.size);return s}return a.forEach(function(n){var i=n.replace(no,"").match(io);i&&s.push({v:Se(i[2]),t:i[1]})}),s}var co=/(^\s|\s$|\n)/;function lo(e){return Ir(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function oo(e,t,r){return"<"+e+(r!=null?lo(r):"")+(t!=null?(t.match(co)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Ts(e){if(ye&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Se(dt(ps(e)));throw new Error("Bad input format: expected Buffer or string")}var ea=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,fo={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},ho=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function uo(e,t){for(var r=1-2*(e[t+7]>>>7),a=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),s=e[t+6]&15,n=5;n>=0;--n)s=s*256+e[t+n];return a==2047?s==0?r*(1/0):NaN:(a==0?a=-1022:(a-=1023,s+=Math.pow(2,52)),r*Math.pow(2,a-52)*s)}function xo(e,t,r){var a=(t<0||1/t==-1/0?1:0)<<7,s=0,n=0,i=a?-t:t;isFinite(i)?i==0?s=n=0:(s=Math.floor(Math.log(i)/Math.LN2),n=i*Math.pow(2,52-s),s<=-1023&&(!isFinite(n)||n<Math.pow(2,52))?s=-1022:(n-=Math.pow(2,52),s+=1023)):(s=2047,n=isNaN(t)?26985:0);for(var c=0;c<=5;++c,n/=256)e[r+c]=n&255;e[r+6]=(s&15)<<4|n&15,e[r+7]=s>>4|a}var pn=function(e){for(var t=[],r=10240,a=0;a<e[0].length;++a)if(e[0][a])for(var s=0,n=e[0][a].length;s<n;s+=r)t.push.apply(t,e[0][a].slice(s,s+r));return t},mn=ye?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:xt(t)})):pn(e)}:pn,gn=function(e,t,r){for(var a=[],s=t;s<r;s+=2)a.push(String.fromCharCode(Br(e,s)));return a.join("").replace(cr,"")},_s=ye?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(cr,""):gn(e,t,r)}:gn,vn=function(e,t,r){for(var a=[],s=t;s<t+r;++s)a.push(("0"+e[s].toString(16)).slice(-2));return a.join("")},Pi=ye?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):vn(e,t,r)}:vn,yn=function(e,t,r){for(var a=[],s=t;s<r;s++)a.push(String.fromCharCode(wt(e,s)));return a.join("")},ia=ye?function(t,r,a){return Buffer.isBuffer(t)?t.toString("utf8",r,a):yn(t,r,a)}:yn,ji=function(e,t){var r=hr(e,t);return r>0?ia(e,t+4,t+4+r-1):""},Mi=ji,Li=function(e,t){var r=hr(e,t);return r>0?ia(e,t+4,t+4+r-1):""},Bi=Li,Ui=function(e,t){var r=2*hr(e,t);return r>0?ia(e,t+4,t+4+r-1):""},Vi=Ui,Hi=function(t,r){var a=hr(t,r);return a>0?_s(t,r+4,r+4+a):""},Gi=Hi,Wi=function(e,t){var r=hr(e,t);return r>0?ia(e,t+4,t+4+r):""},$i=Wi,zi=function(e,t){return uo(e,t)},Sa=zi,Yi=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};ye&&(Mi=function(t,r){if(!Buffer.isBuffer(t))return ji(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},Bi=function(t,r){if(!Buffer.isBuffer(t))return Li(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},Vi=function(t,r){if(!Buffer.isBuffer(t))return Ui(t,r);var a=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a-1)},Gi=function(t,r){if(!Buffer.isBuffer(t))return Hi(t,r);var a=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a)},$i=function(t,r){if(!Buffer.isBuffer(t))return Wi(t,r);var a=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+a)},Sa=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):zi(t,r)},Yi=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var wt=function(e,t){return e[t]},Br=function(e,t){return e[t+1]*256+e[t]},po=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},hr=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},nt=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},mo=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Ht(e,t){var r="",a,s,n=[],i,c,h,f;switch(t){case"dbcs":if(f=this.l,ye&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(h=0;h<e;++h)r+=String.fromCharCode(Br(this,f)),f+=2;e*=2;break;case"utf8":r=ia(this,this.l,this.l+e);break;case"utf16le":e*=2,r=_s(this,this.l,this.l+e);break;case"wstr":return Ht.call(this,e,"dbcs");case"lpstr-ansi":r=Mi(this,this.l),e=4+hr(this,this.l);break;case"lpstr-cp":r=Bi(this,this.l),e=4+hr(this,this.l);break;case"lpwstr":r=Vi(this,this.l),e=4+2*hr(this,this.l);break;case"lpp4":e=4+hr(this,this.l),r=Gi(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+hr(this,this.l),r=$i(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(i=wt(this,this.l+e++))!==0;)n.push(xa(i));r=n.join("");break;case"_wstr":for(e=0,r="";(i=Br(this,this.l+e))!==0;)n.push(xa(i)),e+=2;e+=2,r=n.join("");break;case"dbcs-cont":for(r="",f=this.l,h=0;h<e;++h){if(this.lens&&this.lens.indexOf(f)!==-1)return i=wt(this,f),this.l=f+1,c=Ht.call(this,e-h,i?"dbcs-cont":"sbcs-cont"),n.join("")+c;n.push(xa(Br(this,f))),f+=2}r=n.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",f=this.l,h=0;h!=e;++h){if(this.lens&&this.lens.indexOf(f)!==-1)return i=wt(this,f),this.l=f+1,c=Ht.call(this,e-h,i?"dbcs-cont":"sbcs-cont"),n.join("")+c;n.push(xa(wt(this,f))),f+=1}r=n.join("");break;default:switch(e){case 1:return a=wt(this,this.l),this.l++,a;case 2:return a=(t==="i"?po:Br)(this,this.l),this.l+=2,a;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(a=(e>0?nt:mo)(this,this.l),this.l+=4,a):(s=hr(this,this.l),this.l+=4,s);case 8:case-8:if(t==="f")return e==8?s=Sa(this,this.l):s=Sa([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:r=Pi(this,this.l,e);break}}return this.l+=e,r}var go=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},vo=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},yo=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function wo(e,t,r){var a=0,s=0;if(r==="dbcs"){for(s=0;s!=t.length;++s)yo(this,t.charCodeAt(s),this.l+2*s);a=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=t.length;++s)this[this.l+s]=t.charCodeAt(s)&255;a=t.length}else if(r==="hex"){for(;s<e;++s)this[this.l++]=parseInt(t.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var n=Math.min(this.l+e,this.length);for(s=0;s<Math.min(t.length,e);++s){var i=t.charCodeAt(s);this[this.l++]=i&255,this[this.l++]=i>>8}for(;this.l<n;)this[this.l++]=0;return this}else switch(e){case 1:a=1,this[this.l]=t&255;break;case 2:a=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:a=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:a=4,go(this,t,this.l);break;case 8:if(a=8,r==="f"){xo(this,t,this.l);break}case 16:break;case-4:a=4,vo(this,t,this.l);break}return this.l+=a,this}function Xi(e,t){var r=Pi(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function ze(e,t){e.l=t,e.read_shift=Ht,e.chk=Xi,e.write_shift=wo}function rr(e,t){e.l+=t}function Ve(e){var t=et(e);return ze(t,0),t}function $r(e,t,r){if(e){var a,s,n;ze(e,e.l||0);for(var i=e.length,c=0,h=0;e.l<i;){c=e.read_shift(1),c&128&&(c=(c&127)+((e.read_shift(1)&127)<<7));var f=Ia[c]||Ia[65535];for(a=e.read_shift(1),n=a&127,s=1;s<4&&a&128;++s)n+=((a=e.read_shift(1))&127)<<7*s;h=e.l+n;var o=f.f&&f.f(e,n,r);if(e.l=h,t(o,f,c))return}}}function es(){var e=[],t=ye?256:2048,r=function(f){var o=Ve(f);return ze(o,0),o},a=r(t),s=function(){a&&(a.length>a.l&&(a=a.slice(0,a.l),a.l=a.length),a.length>0&&e.push(a),a=null)},n=function(f){return a&&f<a.length-a.l?a:(s(),a=r(Math.max(f+1,t)))},i=function(){return s(),qr(e)},c=function(f){s(),a=f,a.l==null&&(a.l=a.length),n(t)};return{next:n,push:c,end:i,_bufs:e}}function Gt(e,t,r){var a=Ye(e);if(t.s?(a.cRel&&(a.c+=t.s.c),a.rRel&&(a.r+=t.s.r)):(a.cRel&&(a.c+=t.c),a.rRel&&(a.r+=t.r)),!r||r.biff<12){for(;a.c>=256;)a.c-=256;for(;a.r>=65536;)a.r-=65536}return a}function wn(e,t,r){var a=Ye(e);return a.s=Gt(a.s,t.s,r),a.e=Gt(a.e,t.s,r),a}function Wt(e,t){if(e.cRel&&e.c<0)for(e=Ye(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Ye(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=de(e);return!e.cRel&&e.cRel!=null&&(r=ko(r)),!e.rRel&&e.rRel!=null&&(r=To(r)),r}function Ga(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+He(e.s.c)+":"+(e.e.cRel?"":"$")+He(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Xe(e.s.r)+":"+(e.e.rRel?"":"$")+Xe(e.e.r):Wt(e.s,t.biff)+":"+Wt(e.e,t.biff)}function ks(e){return parseInt(_o(e),10)-1}function Xe(e){return""+(e+1)}function To(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function _o(e){return e.replace(/\$(\d+)$/,"$1")}function Es(e){for(var t=Eo(e),r=0,a=0;a!==t.length;++a)r=26*r+t.charCodeAt(a)-64;return r-1}function He(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function ko(e){return e.replace(/^([A-Z])/,"$$$1")}function Eo(e){return e.replace(/^\$([A-Z])/,"$1")}function bo(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function ir(e){for(var t=0,r=0,a=0;a<e.length;++a){var s=e.charCodeAt(a);s>=48&&s<=57?t=10*t+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:t-1}}function de(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Rt(e){var t=e.indexOf(":");return t==-1?{s:ir(e),e:ir(e)}:{s:ir(e.slice(0,t)),e:ir(e.slice(t+1))}}function Te(e,t){return typeof t>"u"||typeof t=="number"?Te(e.s,e.e):(typeof e!="string"&&(e=de(e)),typeof t!="string"&&(t=de(t)),e==t?e:e+":"+t)}function De(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,a=0,s=0,n=e.length;for(r=0;a<n&&!((s=e.charCodeAt(a)-64)<1||s>26);++a)r=26*r+s;for(t.s.c=--r,r=0;a<n&&!((s=e.charCodeAt(a)-48)<0||s>9);++a)r=10*r+s;if(t.s.r=--r,a===n||s!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++a,r=0;a!=n&&!((s=e.charCodeAt(a)-64)<1||s>26);++a)r=26*r+s;for(t.e.c=--r,r=0;a!=n&&!((s=e.charCodeAt(a)-48)<0||s>9);++a)r=10*r+s;return t.e.r=--r,t}function Tn(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=yr(e.z,r?lr(t):t)}catch{}try{return e.w=yr((e.XF||{}).numFmtId||(r?14:0),r?lr(t):t)}catch{return""+t}}function Wr(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?gt[e.v]||e.v:t==null?Tn(e,e.v):Tn(e,t))}function tt(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",a={};return a[r]=e,{SheetNames:[r],Sheets:a}}function Ki(e,t,r){var a=r||{},s=e?Array.isArray(e):a.dense,n=e||(s?[]:{}),i=0,c=0;if(n&&a.origin!=null){if(typeof a.origin=="number")i=a.origin;else{var h=typeof a.origin=="string"?ir(a.origin):a.origin;i=h.r,c=h.c}n["!ref"]||(n["!ref"]="A1:A1")}var f={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(n["!ref"]){var o=De(n["!ref"]);f.s.c=o.s.c,f.s.r=o.s.r,f.e.c=Math.max(f.e.c,o.e.c),f.e.r=Math.max(f.e.r,o.e.r),i==-1&&(f.e.r=i=o.e.r+1)}for(var x=0;x!=t.length;++x)if(t[x]){if(!Array.isArray(t[x]))throw new Error("aoa_to_sheet expects an array of arrays");for(var d=0;d!=t[x].length;++d)if(!(typeof t[x][d]>"u")){var p={v:t[x][d]},m=i+x,u=c+d;if(f.s.r>m&&(f.s.r=m),f.s.c>u&&(f.s.c=u),f.e.r<m&&(f.e.r=m),f.e.c<u&&(f.e.c=u),t[x][d]&&typeof t[x][d]=="object"&&!Array.isArray(t[x][d])&&!(t[x][d]instanceof Date))p=t[x][d];else if(Array.isArray(p.v)&&(p.f=t[x][d][1],p.v=p.v[0]),p.v===null)if(p.f)p.t="n";else if(a.nullError)p.t="e",p.v=0;else if(a.sheetStubs)p.t="z";else continue;else typeof p.v=="number"?p.t="n":typeof p.v=="boolean"?p.t="b":p.v instanceof Date?(p.z=a.dateNF||me[14],a.cellDates?(p.t="d",p.w=yr(p.z,lr(p.v))):(p.t="n",p.v=lr(p.v),p.w=yr(p.z,p.v))):p.t="s";if(s)n[m]||(n[m]=[]),n[m][u]&&n[m][u].z&&(p.z=n[m][u].z),n[m][u]=p;else{var g=de({c:u,r:m});n[g]&&n[g].z&&(p.z=n[g].z),n[g]=p}}}return f.s.c<1e7&&(n["!ref"]=Te(f)),n}function Dt(e,t){return Ki(null,e,t)}function Ao(e){return e.read_shift(4,"i")}function er(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function So(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function bs(e,t){var r=e.l,a=e.read_shift(1),s=er(e),n=[],i={t:s,h:s};if(a&1){for(var c=e.read_shift(4),h=0;h!=c;++h)n.push(So(e));i.r=n}else i.r=[{ich:0,ifnt:0}];return e.l=r+t,i}var Fo=bs;function wr(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function pt(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}var Co=er;function As(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}var No=er,rs=As;function Ss(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,a=t[0]&2;e.l+=4;var s=a===0?Sa([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):nt(t,0)>>2;return r?s/100:s}function qi(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var mt=qi;function Ze(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Ro(e){var t={},r=e.read_shift(1),a=r>>>1,s=e.read_shift(1),n=e.read_shift(2,"i"),i=e.read_shift(1),c=e.read_shift(1),h=e.read_shift(1);switch(e.l++,a){case 0:t.auto=1;break;case 1:t.index=s;var f=ot[s];f&&(t.rgb=ta(f));break;case 2:t.rgb=ta([i,c,h]);break;case 3:t.theme=s;break}return n!=0&&(t.tint=n>0?n/32767:n/32768),t}function Do(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function Ji(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},a=e.read_shift(4);switch(a){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(a>400)throw new Error("Unsupported Clipboard: "+a.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function Io(e){return Ji(e,1)}function Oo(e){return Ji(e,2)}var Fs=2,or=3,pa=11,_n=12,Fa=19,ma=64,Po=65,jo=71,Mo=4108,Lo=4126,We=80,Zi=81,Bo=[We,Zi],Uo={1:{n:"CodePage",t:Fs},2:{n:"Category",t:We},3:{n:"PresentationFormat",t:We},4:{n:"ByteCount",t:or},5:{n:"LineCount",t:or},6:{n:"ParagraphCount",t:or},7:{n:"SlideCount",t:or},8:{n:"NoteCount",t:or},9:{n:"HiddenCount",t:or},10:{n:"MultimediaClipCount",t:or},11:{n:"ScaleCrop",t:pa},12:{n:"HeadingPairs",t:Mo},13:{n:"TitlesOfParts",t:Lo},14:{n:"Manager",t:We},15:{n:"Company",t:We},16:{n:"LinksUpToDate",t:pa},17:{n:"CharacterCount",t:or},19:{n:"SharedDoc",t:pa},22:{n:"HyperlinksChanged",t:pa},23:{n:"AppVersion",t:or,p:"version"},24:{n:"DigSig",t:Po},26:{n:"ContentType",t:We},27:{n:"ContentStatus",t:We},28:{n:"Language",t:We},29:{n:"Version",t:We},255:{},2147483648:{n:"Locale",t:Fa},2147483651:{n:"Behavior",t:Fa},1919054434:{}},Vo={1:{n:"CodePage",t:Fs},2:{n:"Title",t:We},3:{n:"Subject",t:We},4:{n:"Author",t:We},5:{n:"Keywords",t:We},6:{n:"Comments",t:We},7:{n:"Template",t:We},8:{n:"LastAuthor",t:We},9:{n:"RevNumber",t:We},10:{n:"EditTime",t:ma},11:{n:"LastPrinted",t:ma},12:{n:"CreatedDate",t:ma},13:{n:"ModifiedDate",t:ma},14:{n:"PageCount",t:or},15:{n:"WordCount",t:or},16:{n:"CharCount",t:or},17:{n:"Thumbnail",t:jo},18:{n:"Application",t:We},19:{n:"DocSecurity",t:or},255:{},2147483648:{n:"Locale",t:Fa},2147483651:{n:"Behavior",t:Fa},1919054434:{}},kn={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},Ho=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function Go(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var Wo=Go([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),ot=Ye(Wo),gt={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Qi={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},En={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function $o(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function zo(e){var t=$o();if(!e||!e.match)return t;var r={};if((e.match(tr)||[]).forEach(function(a){var s=he(a);switch(s[0].replace(Ql,"<")){case"<?xml":break;case"<Types":t.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":t[En[s.ContentType]]!==void 0&&t[En[s.ContentType]].push(s.PartName);break}}),t.xmlns!==fo.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}var Tt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function ts(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function $t(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var a={};return(e.match(tr)||[]).forEach(function(s){var n=he(s);if(n[0]==="<Relationship"){var i={};i.Type=n.Type,i.Target=n.Target,i.Id=n.Id,n.TargetMode&&(i.TargetMode=n.TargetMode);var c=n.TargetMode==="External"?n.Target:Ut(n.Target,t);r[c]=i,a[n.Id]=i}}),r["!id"]=a,r}var Yo="application/vnd.oasis.opendocument.spreadsheet";function Xo(e,t){for(var r=Ts(e),a,s;a=ea.exec(r);)switch(a[3]){case"manifest":break;case"file-entry":if(s=he(a[0],!1),s.path=="/"&&s.type!==Yo)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw a}}var zt=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],Ko=function(){for(var e=new Array(zt.length),t=0;t<zt.length;++t){var r=zt[t],a="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+a+"[^>]*>([\\s\\S]*?)</"+a+">")}return e}();function e0(e){var t={};e=Se(e);for(var r=0;r<zt.length;++r){var a=zt[r],s=e.match(Ko[r]);s!=null&&s.length>0&&(t[a[1]]=ke(s[1])),a[2]==="date"&&t[a[1]]&&(t[a[1]]=$e(t[a[1]]))}return t}var qo=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function r0(e,t,r,a){var s=[];if(typeof e=="string")s=dn(e,a);else for(var n=0;n<e.length;++n)s=s.concat(e[n].map(function(o){return{v:o}}));var i=typeof t=="string"?dn(t,a).map(function(o){return o.v}):t,c=0,h=0;if(i.length>0)for(var f=0;f!==s.length;f+=2){switch(h=+s[f+1].v,s[f].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":r.Worksheets=h,r.SheetNames=i.slice(c,c+h);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":r.NamedRanges=h,r.DefinedNames=i.slice(c,c+h);break;case"Charts":case"Diagramme":r.Chartsheets=h,r.ChartNames=i.slice(c,c+h);break}c+=h}}function Jo(e,t,r){var a={};return t||(t={}),e=Se(e),qo.forEach(function(s){var n=(e.match(Qt(s[0]))||[])[1];switch(s[2]){case"string":n&&(t[s[1]]=ke(n));break;case"bool":t[s[1]]=n==="true";break;case"raw":var i=e.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));i&&i.length>0&&(a[s[1]]=i[1]);break}}),a.HeadingPairs&&a.TitlesOfParts&&r0(a.HeadingPairs,a.TitlesOfParts,t,r),t}var Zo=/<[^>]+>[^<]*/g;function Qo(e,t){var r={},a="",s=e.match(Zo);if(s)for(var n=0;n!=s.length;++n){var i=s[n],c=he(i);switch(c[0]){case"<?xml":break;case"<Properties":break;case"<property":a=ke(c.name);break;case"</property>":a=null;break;default:if(i.indexOf("<vt:")===0){var h=i.split(">"),f=h[0].slice(4),o=h[1];switch(f){case"lpstr":case"bstr":case"lpwstr":r[a]=ke(o);break;case"bool":r[a]=Fe(o);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[a]=parseInt(o,10);break;case"r4":case"r8":case"decimal":r[a]=parseFloat(o);break;case"filetime":case"date":r[a]=$e(o);break;case"cy":case"error":r[a]=ke(o);break;default:if(f.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",i,f,h)}}else if(i.slice(0,2)!=="</"){if(t.WTF)throw new Error(i)}}}return r}var ef={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Wa;function rf(e,t,r){Wa||(Wa=vs(ef)),t=Wa[t]||t,e[t]=r}function Cs(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function t0(e,t,r){var a=e.l,s=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-a&3;)++e.l;return s}function a0(e,t,r){var a=e.read_shift(0,"lpwstr");return r&&(e.l+=4-(a.length+1&3)&3),a}function s0(e,t,r){return t===31?a0(e):t0(e,t,r)}function as(e,t,r){return s0(e,t,r===!1?0:4)}function tf(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return s0(e,t,0)}function af(e){for(var t=e.read_shift(4),r=[],a=0;a!=t;++a){var s=e.l;r[a]=e.read_shift(0,"lpwstr").replace(cr,""),e.l-s&2&&(e.l+=2)}return r}function sf(e){for(var t=e.read_shift(4),r=[],a=0;a!=t;++a)r[a]=e.read_shift(0,"lpstr-cp").replace(cr,"");return r}function nf(e){var t=e.l,r=Ca(e,Zi);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var a=Ca(e,or);return[r,a]}function cf(e){for(var t=e.read_shift(4),r=[],a=0;a<t/2;++a)r.push(nf(e));return r}function bn(e,t){for(var r=e.read_shift(4),a={},s=0;s!=r;++s){var n=e.read_shift(4),i=e.read_shift(4);a[n]=e.read_shift(i,t===1200?"utf16le":"utf8").replace(cr,"").replace(Bt,"!"),t===1200&&i%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>2+1<<2),a}function n0(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function lf(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function Ca(e,t,r){var a=e.read_shift(2),s,n=r||{};if(e.l+=2,t!==_n&&a!==t&&Bo.indexOf(t)===-1&&!((t&65534)==4126&&(a&65534)==4126))throw new Error("Expected type "+t+" saw "+a);switch(t===_n?a:t){case 2:return s=e.read_shift(2,"i"),n.raw||(e.l+=2),s;case 3:return s=e.read_shift(4,"i"),s;case 11:return e.read_shift(4)!==0;case 19:return s=e.read_shift(4),s;case 30:return t0(e,a,4).replace(cr,"");case 31:return a0(e);case 64:return Cs(e);case 65:return n0(e);case 71:return lf(e);case 80:return as(e,a,!n.raw).replace(cr,"");case 81:return tf(e,a).replace(cr,"");case 4108:return cf(e);case 4126:case 4127:return a==4127?af(e):sf(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+a)}}function An(e,t){var r=e.l,a=e.read_shift(4),s=e.read_shift(4),n=[],i=0,c=0,h=-1,f={};for(i=0;i!=s;++i){var o=e.read_shift(4),x=e.read_shift(4);n[i]=[o,x+r]}n.sort(function(F,y){return F[1]-y[1]});var d={};for(i=0;i!=s;++i){if(e.l!==n[i][1]){var p=!0;if(i>0&&t)switch(t[n[i-1][0]].t){case 2:e.l+2===n[i][1]&&(e.l+=2,p=!1);break;case 80:e.l<=n[i][1]&&(e.l=n[i][1],p=!1);break;case 4108:e.l<=n[i][1]&&(e.l=n[i][1],p=!1);break}if((!t||i==0)&&e.l<=n[i][1]&&(p=!1,e.l=n[i][1]),p)throw new Error("Read Error: Expected address "+n[i][1]+" at "+e.l+" :"+i)}if(t){var m=t[n[i][0]];if(d[m.n]=Ca(e,m.t,{raw:!0}),m.p==="version"&&(d[m.n]=String(d[m.n]>>16)+"."+("0000"+String(d[m.n]&65535)).slice(-4)),m.n=="CodePage")switch(d[m.n]){case 0:d[m.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:br(c=d[m.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+d[m.n])}}else if(n[i][0]===1){if(c=d.CodePage=Ca(e,Fs),br(c),h!==-1){var u=e.l;e.l=n[h][1],f=bn(e,c),e.l=u}}else if(n[i][0]===0){if(c===0){h=i,e.l=n[i+1][1];continue}f=bn(e,c)}else{var g=f[n[i][0]],_;switch(e[e.l]){case 65:e.l+=4,_=n0(e);break;case 30:e.l+=4,_=as(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,_=as(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,_=e.read_shift(4,"i");break;case 19:e.l+=4,_=e.read_shift(4);break;case 5:e.l+=4,_=e.read_shift(8,"f");break;case 11:e.l+=4,_=je(e,4);break;case 64:e.l+=4,_=$e(Cs(e));break;default:throw new Error("unparsed value: "+e[e.l])}d[g]=_}}return e.l=r+a,d}function Sn(e,t,r){var a=e.content;if(!a)return{};ze(a,0);var s,n,i,c,h=0;a.chk("feff","Byte Order: "),a.read_shift(2);var f=a.read_shift(4),o=a.read_shift(16);if(o!==we.utils.consts.HEADER_CLSID&&o!==r)throw new Error("Bad PropertySet CLSID "+o);if(s=a.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(n=a.read_shift(16),c=a.read_shift(4),s===1&&c!==a.l)throw new Error("Length mismatch: "+c+" !== "+a.l);s===2&&(i=a.read_shift(16),h=a.read_shift(4));var x=An(a,t),d={SystemIdentifier:f};for(var p in x)d[p]=x[p];if(d.FMTID=n,s===1)return d;if(h-a.l==2&&(a.l+=2),a.l!==h)throw new Error("Length mismatch 2: "+a.l+" !== "+h);var m;try{m=An(a,null)}catch{}for(p in m)d[p]=m[p];return d.FMTID=[n,i],d}function Xr(e,t){return e.read_shift(t),null}function of(e,t,r){for(var a=[],s=e.l+t;e.l<s;)a.push(r(e,s-e.l));if(s!==e.l)throw new Error("Slurp error");return a}function je(e,t){return e.read_shift(t)===1}function Be(e){return e.read_shift(2,"u")}function i0(e,t){return of(e,t,Be)}function ff(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function ca(e,t,r){var a=e.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var n=e.read_shift(1);n&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var i=a?e.read_shift(a,s):"";return i}function hf(e){var t=e.read_shift(2),r=e.read_shift(1),a=r&4,s=r&8,n=1+(r&1),i=0,c,h={};s&&(i=e.read_shift(2)),a&&(c=e.read_shift(4));var f=n==2?"dbcs-cont":"sbcs-cont",o=t===0?"":e.read_shift(t,f);return s&&(e.l+=4*i),a&&(e.l+=c),h.t=o,s||(h.raw="<t>"+h.t+"</t>",h.r=h.t),h}function ut(e,t,r){var a;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var s=e.read_shift(1);return s===0?a=e.read_shift(t,"sbcs-cont"):a=e.read_shift(t,"dbcs-cont"),a}function la(e,t,r){var a=e.read_shift(r&&r.biff==2?1:2);return a===0?(e.l++,""):ut(e,a,r)}function vt(e,t,r){if(r.biff>5)return la(e,t,r);var a=e.read_shift(1);return a===0?(e.l++,""):e.read_shift(a,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function uf(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function xf(e){var t=e.read_shift(4),r=e.l,a=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(a=!0),e.l=r);var s=e.read_shift((a?t-24:t)>>1,"utf16le").replace(cr,"");return a&&(e.l+=24),s}function df(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var a=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=e.read_shift(4);if(s===0)return r+a.replace(/\\/g,"/");var n=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var i=e.read_shift(n>>1,"utf16le").replace(cr,"");return r+i}function pf(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return xf(e);case"0303000000000000c000000000000046":return df(e);default:throw new Error("Unsupported Moniker "+r)}}function ga(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(cr,""):"";return r}function mf(e,t){var r=e.l+t,a=e.read_shift(4);if(a!==2)throw new Error("Unrecognized streamVersion: "+a);var s=e.read_shift(2);e.l+=2;var n,i,c,h,f="",o,x;s&16&&(n=ga(e,r-e.l)),s&128&&(i=ga(e,r-e.l)),(s&257)===257&&(c=ga(e,r-e.l)),(s&257)===1&&(h=pf(e,r-e.l)),s&8&&(f=ga(e,r-e.l)),s&32&&(o=e.read_shift(16)),s&64&&(x=Cs(e)),e.l=r;var d=i||c||h||"";d&&f&&(d+="#"+f),d||(d="#"+f),s&2&&d.charAt(0)=="/"&&d.charAt(1)!="/"&&(d="file://"+d);var p={Target:d};return o&&(p.guid=o),x&&(p.time=x),n&&(p.Tooltip=n),p}function c0(e){var t=e.read_shift(1),r=e.read_shift(1),a=e.read_shift(1),s=e.read_shift(1);return[t,r,a,s]}function l0(e,t){var r=c0(e);return r[3]=0,r}function Pr(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return{r:t,c:r,ixfe:a}}function gf(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function vf(e,t,r){return t===0?"":vt(e,t,r)}function yf(e,t,r){var a=r.biff>8?4:2,s=e.read_shift(a),n=e.read_shift(a,"i"),i=e.read_shift(a,"i");return[s,n,i]}function o0(e){var t=e.read_shift(2),r=Ss(e);return[t,r]}function wf(e,t,r){e.l+=4,t-=4;var a=e.l+t,s=ca(e,t,r),n=e.read_shift(2);if(a-=e.l,n!==a)throw new Error("Malformed AddinUdf: padding = "+a+" != "+n);return e.l+=n,s}function ja(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2);return{s:{c:a,r:t},e:{c:s,r}}}function f0(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(1),s=e.read_shift(1);return{s:{c:a,r:t},e:{c:s,r}}}var Tf=f0;function h0(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return e.l+=12,[r,t,a]}function _f(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function kf(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function qe(e){e.l+=2,e.l+=e.read_shift(2)}var Ef={0:qe,4:qe,5:qe,6:qe,7:kf,8:qe,9:qe,10:qe,11:qe,12:qe,13:_f,14:qe,15:qe,16:qe,17:qe,18:qe,19:qe,20:qe,21:h0};function bf(e,t){for(var r=e.l+t,a=[];e.l<r;){var s=e.read_shift(2);e.l-=2;try{a.push(Ef[s](e,r-e.l))}catch{return e.l=r,a}}return e.l!=r&&(e.l=r),a}function va(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function Af(e,t){return t===0||e.read_shift(2),1200}function Sf(e,t,r){if(r.enc)return e.l+=t,"";var a=e.l,s=vt(e,0,r);return e.read_shift(t+a-e.l),s}function Ff(e,t,r){var a=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:a&16,fBelow:a&64,fRight:a&128}}function Cf(e,t,r){var a=e.read_shift(4),s=e.read_shift(1)&3,n=e.read_shift(1);switch(n){case 0:n="Worksheet";break;case 1:n="Macrosheet";break;case 2:n="Chartsheet";break;case 6:n="VBAModule";break}var i=ca(e,0,r);return i.length===0&&(i="Sheet1"),{pos:a,hs:s,dt:n,name:i}}function Nf(e,t){for(var r=e.l+t,a=e.read_shift(4),s=e.read_shift(4),n=[],i=0;i!=s&&e.l<r;++i)n.push(hf(e));return n.Count=a,n.Unique=s,n}function Rf(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function Df(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var a=e.read_shift(1);return e.l+=3,a&7&&(t.level=a&7),a&32&&(t.hidden=!0),a&64&&(t.hpt=r/20),t}function If(e){var t=gf(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function Of(e){return e.read_shift(2),e.read_shift(4)}function Fn(e,t,r){var a=0;r&&r.biff==2||(a=e.read_shift(2));var s=e.read_shift(2);r&&r.biff==2&&(a=1-(s>>15),s&=32767);var n={Unsynced:a&1,DyZero:(a&2)>>1,ExAsc:(a&4)>>2,ExDsc:(a&8)>>3};return[n,s]}function Pf(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),c=e.read_shift(2),h=e.read_shift(2),f=e.read_shift(2);return{Pos:[t,r],Dim:[a,s],Flags:n,CurTab:i,FirstTab:c,Selected:h,TabRatio:f}}function jf(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var a=e.read_shift(2);return{RTL:a&64}}function Mf(){}function Lf(e,t,r){var a={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return a.name=ca(e,0,r),a}function Bf(e){var t=Pr(e);return t.isst=e.read_shift(4),t}function Uf(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=e.l+t,s=Pr(e);r.biff==2&&e.l++;var n=la(e,a-e.l,r);return s.val=n,s}function Vf(e,t,r){var a=e.read_shift(2),s=vt(e,0,r);return[a,s]}var Hf=vt;function Cn(e,t,r){var a=e.l+t,s=r.biff==8||!r.biff?4:2,n=e.read_shift(s),i=e.read_shift(s),c=e.read_shift(2),h=e.read_shift(2);return e.l=a,{s:{r:n,c},e:{r:i,c:h}}}function Gf(e){var t=e.read_shift(2),r=e.read_shift(2),a=o0(e);return{r:t,c:r,ixfe:a[0],rknum:a[1]}}function Wf(e,t){for(var r=e.l+t-2,a=e.read_shift(2),s=e.read_shift(2),n=[];e.l<r;)n.push(o0(e));if(e.l!==r)throw new Error("MulRK read error");var i=e.read_shift(2);if(n.length!=i-s+1)throw new Error("MulRK length mismatch");return{r:a,c:s,C:i,rkrec:n}}function $f(e,t){for(var r=e.l+t-2,a=e.read_shift(2),s=e.read_shift(2),n=[];e.l<r;)n.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var i=e.read_shift(2);if(n.length!=i-s+1)throw new Error("MulBlank length mismatch");return{r:a,c:s,C:i,ixfe:n}}function zf(e,t,r,a){var s={},n=e.read_shift(4),i=e.read_shift(4),c=e.read_shift(4),h=e.read_shift(2);return s.patternType=Ho[c>>26],a.cellStyles&&(s.alc=n&7,s.fWrap=n>>3&1,s.alcV=n>>4&7,s.fJustLast=n>>7&1,s.trot=n>>8&255,s.cIndent=n>>16&15,s.fShrinkToFit=n>>20&1,s.iReadOrder=n>>22&2,s.fAtrNum=n>>26&1,s.fAtrFnt=n>>27&1,s.fAtrAlc=n>>28&1,s.fAtrBdr=n>>29&1,s.fAtrPat=n>>30&1,s.fAtrProt=n>>31&1,s.dgLeft=i&15,s.dgRight=i>>4&15,s.dgTop=i>>8&15,s.dgBottom=i>>12&15,s.icvLeft=i>>16&127,s.icvRight=i>>23&127,s.grbitDiag=i>>30&3,s.icvTop=c&127,s.icvBottom=c>>7&127,s.icvDiag=c>>14&127,s.dgDiag=c>>21&15,s.icvFore=h&127,s.icvBack=h>>7&127,s.fsxButton=h>>14&1),s}function Yf(e,t,r){var a={};return a.ifnt=e.read_shift(2),a.numFmtId=e.read_shift(2),a.flags=e.read_shift(2),a.fStyle=a.flags>>2&1,t-=6,a.data=zf(e,t,a.fStyle,r),a}function Xf(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function Nn(e,t,r){var a=Pr(e);(r.biff==2||t==9)&&++e.l;var s=ff(e);return a.val=s,a.t=s===!0||s===!1?"b":"e",a}function Kf(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=Pr(e),s=Ze(e);return a.val=s,a}var Rn=vf;function qf(e,t,r){var a=e.l+t,s=e.read_shift(2),n=e.read_shift(2);if(r.sbcch=n,n==1025||n==14849)return[n,s];if(n<1||n>255)throw new Error("Unexpected SupBook type: "+n);for(var i=ut(e,n),c=[];a>e.l;)c.push(la(e));return[n,s,i,c]}function Dn(e,t,r){var a=e.read_shift(2),s,n={fBuiltIn:a&1,fWantAdvise:a>>>1&1,fWantPict:a>>>2&1,fOle:a>>>3&1,fOleLink:a>>>4&1,cf:a>>>5&1023,fIcon:a>>>15&1};return r.sbcch===14849&&(s=wf(e,t-2,r)),n.body=s||e.read_shift(t-2),typeof s=="string"&&(n.Name=s),n}var Jf=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function In(e,t,r){var a=e.l+t,s=e.read_shift(2),n=e.read_shift(1),i=e.read_shift(1),c=e.read_shift(r&&r.biff==2?1:2),h=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),h=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var f=ut(e,i,r);s&32&&(f=Jf[f.charCodeAt(0)]);var o=a-e.l;r&&r.biff==2&&--o;var x=a==e.l||c===0||!(o>0)?[]:Dd(e,o,r,c);return{chKey:n,Name:f,itab:h,rgce:x}}function u0(e,t,r){if(r.biff<8)return Zf(e,t,r);for(var a=[],s=e.l+t,n=e.read_shift(r.biff>8?4:2);n--!==0;)a.push(yf(e,r.biff>8?12:6,r));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return a}function Zf(e,t,r){e[e.l+1]==3&&e[e.l]++;var a=ca(e,t,r);return a.charCodeAt(0)==3?a.slice(1):a}function Qf(e,t,r){if(r.biff<8){e.l+=t;return}var a=e.read_shift(2),s=e.read_shift(2),n=ut(e,a,r),i=ut(e,s,r);return[n,i]}function eh(e,t,r){var a=f0(e);e.l++;var s=e.read_shift(1);return t-=8,[Id(e,t,r),s,a]}function On(e,t,r){var a=Tf(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[a,Nd(e,t,r)]}function rh(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,a=e.read_shift(4);return[t,r,a]}function th(e,t,r){if(!(r.biff<8)){var a=e.read_shift(2),s=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),c=vt(e,0,r);return r.biff<8&&e.read_shift(1),[{r:a,c:s},c,i,n]}}function ah(e,t,r){return th(e,t,r)}function sh(e,t){for(var r=[],a=e.read_shift(2);a--;)r.push(ja(e));return r}function nh(e,t,r){if(r&&r.biff<8)return ch(e,t,r);var a=h0(e),s=bf(e,t-22,a[1]);return{cmo:a,ft:s}}var ih={8:function(e,t){var r=e.l+t;e.l+=10;var a=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var s=e.read_shift(1);return e.l+=s,e.l=r,{fmt:a}}};function ch(e,t,r){e.l+=4;var a=e.read_shift(2),s=e.read_shift(2),n=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var i=[];return i.push((ih[a]||rr)(e,t,r)),{cmo:[s,a,n],ft:i}}function lh(e,t,r){var a=e.l,s="";try{e.l+=4;var n=(r.lastobj||{cmo:[0,0]}).cmo[1],i;[0,5,7,11,12,14].indexOf(n)==-1?e.l+=6:i=uf(e,6,r);var c=e.read_shift(2);e.read_shift(2),Be(e,2);var h=e.read_shift(2);e.l+=h;for(var f=1;f<e.lens.length-1;++f){if(e.l-a!=e.lens[f])throw new Error("TxO: bad continue record");var o=e[e.l],x=ut(e,e.lens[f+1]-e.lens[f]-1);if(s+=x,s.length>=(o?c:2*c))break}if(s.length!==c&&s.length!==c*2)throw new Error("cchText: "+c+" != "+s.length);return e.l=a+t,{t:s}}catch{return e.l=a+t,{t:s}}}function oh(e,t){var r=ja(e);e.l+=16;var a=mf(e,t-24);return[r,a]}function fh(e,t){e.read_shift(2);var r=ja(e),a=e.read_shift((t-10)/2,"dbcs-cont");return a=a.replace(cr,""),[r,a]}function hh(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=kn[r]||r,r=e.read_shift(2),t[1]=kn[r]||r,t}function uh(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(l0(e));return r}function xh(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(l0(e));return r}function dh(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function x0(e,t,r){if(!r.cellStyles)return rr(e,t);var a=r&&r.biff>=12?4:2,s=e.read_shift(a),n=e.read_shift(a),i=e.read_shift(a),c=e.read_shift(a),h=e.read_shift(2);a==2&&(e.l+=2);var f={s,e:n,w:i,ixfe:c,flags:h};return(r.biff>=5||!r.biff)&&(f.level=h>>8&7),f}function ph(e,t){var r={};return t<32||(e.l+=16,r.header=Ze(e),r.footer=Ze(e),e.l+=2),r}function mh(e,t,r){var a={area:!1};if(r.biff!=5)return e.l+=t,a;var s=e.read_shift(1);return e.l+=3,s&16&&(a.area=!0),a}var gh=Pr,vh=i0,yh=la;function wh(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),s={fmt:t,env:r,len:a,data:e.slice(e.l,e.l+a)};return e.l+=a,s}function Th(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var a=Pr(e);++e.l;var s=vt(e,t-7,r);return a.t="str",a.val=s,a}function _h(e){var t=Pr(e);++e.l;var r=Ze(e);return t.t="n",t.val=r,t}function kh(e){var t=Pr(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function Eh(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function bh(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function Ah(e,t,r){var a=e.l+t,s=Pr(e),n=e.read_shift(2),i=ut(e,n,r);return e.l=a,s.t="str",s.val=i,s}var Sh=[2,3,48,49,131,139,140,245],Pn=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=vs({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(c,h){var f=[],o=et(1);switch(h.type){case"base64":o=Er(xr(c));break;case"binary":o=Er(c);break;case"buffer":case"array":o=c;break}ze(o,0);var x=o.read_shift(1),d=!!(x&136),p=!1,m=!1;switch(x){case 2:break;case 3:break;case 48:p=!0,d=!0;break;case 49:p=!0,d=!0;break;case 131:break;case 139:break;case 140:m=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+x.toString(16))}var u=0,g=521;x==2&&(u=o.read_shift(2)),o.l+=3,x!=2&&(u=o.read_shift(4)),u>1048576&&(u=1e6),x!=2&&(g=o.read_shift(2));var _=o.read_shift(2),F=h.codepage||1252;x!=2&&(o.l+=16,o.read_shift(1),o[o.l]!==0&&(F=e[o[o.l]]),o.l+=1,o.l+=2),m&&(o.l+=36);for(var y=[],E={},D=Math.min(o.length,x==2?521:g-10-(p?264:0)),R=m?32:11;o.l<D&&o[o.l]!=13;)switch(E={},E.name=Kr.utils.decode(F,o.slice(o.l,o.l+R)).replace(/[\u0000\r\n].*$/g,""),o.l+=R,E.type=String.fromCharCode(o.read_shift(1)),x!=2&&!m&&(E.offset=o.read_shift(4)),E.len=o.read_shift(1),x==2&&(E.offset=o.read_shift(2)),E.dec=o.read_shift(1),E.name.length&&y.push(E),x!=2&&(o.l+=m?13:14),E.type){case"B":(!p||E.len!=8)&&h.WTF&&console.log("Skipping "+E.name+":"+E.type);break;case"G":case"P":h.WTF&&console.log("Skipping "+E.name+":"+E.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+E.type)}if(o[o.l]!==13&&(o.l=g-1),o.read_shift(1)!==13)throw new Error("DBF Terminator not found "+o.l+" "+o[o.l]);o.l=g;var T=0,M=0;for(f[0]=[],M=0;M!=y.length;++M)f[0][M]=y[M].name;for(;u-- >0;){if(o[o.l]===42){o.l+=_;continue}for(++o.l,f[++T]=[],M=0,M=0;M!=y.length;++M){var I=o.slice(o.l,o.l+y[M].len);o.l+=y[M].len,ze(I,0);var V=Kr.utils.decode(F,I);switch(y[M].type){case"C":V.trim().length&&(f[T][M]=V.replace(/\s+$/,""));break;case"D":V.length===8?f[T][M]=new Date(+V.slice(0,4),+V.slice(4,6)-1,+V.slice(6,8)):f[T][M]=V;break;case"F":f[T][M]=parseFloat(V.trim());break;case"+":case"I":f[T][M]=m?I.read_shift(-4,"i")^2147483648:I.read_shift(4,"i");break;case"L":switch(V.trim().toUpperCase()){case"Y":case"T":f[T][M]=!0;break;case"N":case"F":f[T][M]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+V+"|")}break;case"M":if(!d)throw new Error("DBF Unexpected MEMO for type "+x.toString(16));f[T][M]="##MEMO##"+(m?parseInt(V.trim(),10):I.read_shift(4));break;case"N":V=V.replace(/\u0000/g,"").trim(),V&&V!="."&&(f[T][M]=+V||0);break;case"@":f[T][M]=new Date(I.read_shift(-8,"f")-621356832e5);break;case"T":f[T][M]=new Date((I.read_shift(4)-2440588)*864e5+I.read_shift(4));break;case"Y":f[T][M]=I.read_shift(4,"i")/1e4+I.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":f[T][M]=-I.read_shift(-8,"f");break;case"B":if(p&&y[M].len==8){f[T][M]=I.read_shift(8,"f");break}case"G":case"P":I.l+=y[M].len;break;case"0":if(y[M].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+y[M].type)}}}if(x!=2&&o.l<o.length&&o[o.l++]!=26)throw new Error("DBF EOF Marker missing "+(o.l-1)+" of "+o.length+" "+o[o.l-1].toString(16));return h&&h.sheetRows&&(f=f.slice(0,h.sheetRows)),h.DBF=y,f}function a(c,h){var f=h||{};f.dateNF||(f.dateNF="yyyymmdd");var o=Dt(r(c,f),f);return o["!cols"]=f.DBF.map(function(x){return{wch:x.len,DBF:x}}),delete f.DBF,o}function s(c,h){try{return tt(a(c,h),h)}catch(f){if(h&&h.WTF)throw f}return{SheetNames:[],Sheets:{}}}var n={B:8,C:250,L:1,D:8,"?":0,"":0};function i(c,h){var f=h||{};if(+f.codepage>=0&&br(+f.codepage),f.type=="string")throw new Error("Cannot write DBF to JS string");var o=es(),x=fs(c,{header:1,raw:!0,cellDates:!0}),d=x[0],p=x.slice(1),m=c["!cols"]||[],u=0,g=0,_=0,F=1;for(u=0;u<d.length;++u){if(((m[u]||{}).DBF||{}).name){d[u]=m[u].DBF.name,++_;continue}if(d[u]!=null){if(++_,typeof d[u]=="number"&&(d[u]=d[u].toString(10)),typeof d[u]!="string")throw new Error("DBF Invalid column name "+d[u]+" |"+typeof d[u]+"|");if(d.indexOf(d[u])!==u){for(g=0;g<1024;++g)if(d.indexOf(d[u]+"_"+g)==-1){d[u]+="_"+g;break}}}}var y=De(c["!ref"]),E=[],D=[],R=[];for(u=0;u<=y.e.c-y.s.c;++u){var T="",M="",I=0,V=[];for(g=0;g<p.length;++g)p[g][u]!=null&&V.push(p[g][u]);if(V.length==0||d[u]==null){E[u]="?";continue}for(g=0;g<V.length;++g){switch(typeof V[g]){case"number":M="B";break;case"string":M="C";break;case"boolean":M="L";break;case"object":M=V[g]instanceof Date?"D":"C";break;default:M="C"}I=Math.max(I,String(V[g]).length),T=T&&T!=M?"C":M}I>250&&(I=250),M=((m[u]||{}).DBF||{}).type,M=="C"&&m[u].DBF.len>I&&(I=m[u].DBF.len),T=="B"&&M=="N"&&(T="N",R[u]=m[u].DBF.dec,I=m[u].DBF.len),D[u]=T=="C"||M=="N"?I:n[T]||0,F+=D[u],E[u]=T}var L=o.next(32);for(L.write_shift(4,318902576),L.write_shift(4,p.length),L.write_shift(2,296+32*_),L.write_shift(2,F),u=0;u<4;++u)L.write_shift(4,0);for(L.write_shift(4,0|(+t[hi]||3)<<8),u=0,g=0;u<d.length;++u)if(d[u]!=null){var P=o.next(32),J=(d[u].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);P.write_shift(1,J,"sbcs"),P.write_shift(1,E[u]=="?"?"C":E[u],"sbcs"),P.write_shift(4,g),P.write_shift(1,D[u]||n[E[u]]||0),P.write_shift(1,R[u]||0),P.write_shift(1,2),P.write_shift(4,0),P.write_shift(1,0),P.write_shift(4,0),P.write_shift(4,0),g+=D[u]||n[E[u]]||0}var Y=o.next(264);for(Y.write_shift(4,13),u=0;u<65;++u)Y.write_shift(4,0);for(u=0;u<p.length;++u){var X=o.next(F);for(X.write_shift(1,0),g=0;g<d.length;++g)if(d[g]!=null)switch(E[g]){case"L":X.write_shift(1,p[u][g]==null?63:p[u][g]?84:70);break;case"B":X.write_shift(8,p[u][g]||0,"f");break;case"N":var re="0";for(typeof p[u][g]=="number"&&(re=p[u][g].toFixed(R[g]||0)),_=0;_<D[g]-re.length;++_)X.write_shift(1,32);X.write_shift(1,re,"sbcs");break;case"D":p[u][g]?(X.write_shift(4,("0000"+p[u][g].getFullYear()).slice(-4),"sbcs"),X.write_shift(2,("00"+(p[u][g].getMonth()+1)).slice(-2),"sbcs"),X.write_shift(2,("00"+p[u][g].getDate()).slice(-2),"sbcs")):X.write_shift(8,"00000000","sbcs");break;case"C":var ne=String(p[u][g]!=null?p[u][g]:"").slice(0,D[g]);for(X.write_shift(1,ne,"sbcs"),_=0;_<D[g]-ne.length;++_)X.write_shift(1,32);break}}return o.next(1).write_shift(1,26),o.end()}return{to_workbook:s,to_sheet:a,from_sheet:i}}(),Fh=function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Ir(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(d,p){var m=e[p];return typeof m=="number"?qs(m):m},a=function(d,p,m){var u=p.charCodeAt(0)-32<<4|m.charCodeAt(0)-48;return u==59?d:qs(u)};e["|"]=254;function s(d,p){switch(p.type){case"base64":return n(xr(d),p);case"binary":return n(d,p);case"buffer":return n(ye&&Buffer.isBuffer(d)?d.toString("binary"):dt(d),p);case"array":return n(ht(d),p)}throw new Error("Unrecognized type "+p.type)}function n(d,p){var m=d.split(/[\n\r]+/),u=-1,g=-1,_=0,F=0,y=[],E=[],D=null,R={},T=[],M=[],I=[],V=0,L;for(+p.codepage>=0&&br(+p.codepage);_!==m.length;++_){V=0;var P=m[_].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,a).replace(t,r),J=P.replace(/;;/g,"\0").split(";").map(function(O){return O.replace(/\u0000/g,";")}),Y=J[0],X;if(P.length>0)switch(Y){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":J[1].charAt(0)=="P"&&E.push(P.slice(3).replace(/;;/g,";"));break;case"C":var re=!1,ne=!1,be=!1,z=!1,ue=-1,xe=-1;for(F=1;F<J.length;++F)switch(J[F].charAt(0)){case"A":break;case"X":g=parseInt(J[F].slice(1))-1,ne=!0;break;case"Y":for(u=parseInt(J[F].slice(1))-1,ne||(g=0),L=y.length;L<=u;++L)y[L]=[];break;case"K":X=J[F].slice(1),X.charAt(0)==='"'?X=X.slice(1,X.length-1):X==="TRUE"?X=!0:X==="FALSE"?X=!1:isNaN(Sr(X))?isNaN(Ft(X).getDate())||(X=$e(X)):(X=Sr(X),D!==null&&Nt(D)&&(X=Pa(X))),re=!0;break;case"E":z=!0;var C=Et(J[F].slice(1),{r:u,c:g});y[u][g]=[y[u][g],C];break;case"S":be=!0,y[u][g]=[y[u][g],"S5S"];break;case"G":break;case"R":ue=parseInt(J[F].slice(1))-1;break;case"C":xe=parseInt(J[F].slice(1))-1;break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+P)}if(re&&(y[u][g]&&y[u][g].length==2?y[u][g][0]=X:y[u][g]=X,D=null),be){if(z)throw new Error("SYLK shared formula cannot have own formula");var G=ue>-1&&y[ue][xe];if(!G||!G[1])throw new Error("SYLK shared formula cannot find base");y[u][g][1]=k0(G[1],{r:u-ue,c:g-xe})}break;case"F":var j=0;for(F=1;F<J.length;++F)switch(J[F].charAt(0)){case"X":g=parseInt(J[F].slice(1))-1,++j;break;case"Y":for(u=parseInt(J[F].slice(1))-1,L=y.length;L<=u;++L)y[L]=[];break;case"M":V=parseInt(J[F].slice(1))/20;break;case"F":break;case"G":break;case"P":D=E[parseInt(J[F].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(I=J[F].slice(1).split(" "),L=parseInt(I[0],10);L<=parseInt(I[1],10);++L)V=parseInt(I[2],10),M[L-1]=V===0?{hidden:!0}:{wch:V},Ct(M[L-1]);break;case"C":g=parseInt(J[F].slice(1))-1,M[g]||(M[g]={});break;case"R":u=parseInt(J[F].slice(1))-1,T[u]||(T[u]={}),V>0?(T[u].hpt=V,T[u].hpx=aa(V)):V===0&&(T[u].hidden=!0);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+P)}j<1&&(D=null);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+P)}}return T.length>0&&(R["!rows"]=T),M.length>0&&(R["!cols"]=M),p&&p.sheetRows&&(y=y.slice(0,p.sheetRows)),[y,R]}function i(d,p){var m=s(d,p),u=m[0],g=m[1],_=Dt(u,p);return Ir(g).forEach(function(F){_[F]=g[F]}),_}function c(d,p){return tt(i(d,p),p)}function h(d,p,m,u){var g="C;Y"+(m+1)+";X"+(u+1)+";K";switch(d.t){case"n":g+=d.v||0,d.f&&!d.F&&(g+=";E"+dx(d.f,{r:m,c:u}));break;case"b":g+=d.v?"TRUE":"FALSE";break;case"e":g+=d.w||d.v;break;case"d":g+='"'+(d.w||d.v)+'"';break;case"s":g+='"'+d.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return g}function f(d,p){p.forEach(function(m,u){var g="F;W"+(u+1)+" "+(u+1)+" ";m.hidden?g+="0":(typeof m.width=="number"&&!m.wpx&&(m.wpx=Ra(m.width)),typeof m.wpx=="number"&&!m.wch&&(m.wch=Da(m.wpx)),typeof m.wch=="number"&&(g+=Math.round(m.wch))),g.charAt(g.length-1)!=" "&&d.push(g)})}function o(d,p){p.forEach(function(m,u){var g="F;";m.hidden?g+="M0;":m.hpt?g+="M"+20*m.hpt+";":m.hpx&&(g+="M"+20*w0(m.hpx)+";"),g.length>2&&d.push(g+"R"+(u+1))})}function x(d,p){var m=["ID;PWXL;N;E"],u=[],g=De(d["!ref"]),_,F=Array.isArray(d),y=`\r
`;m.push("P;PGeneral"),m.push("F;P0;DG0G8;M255"),d["!cols"]&&f(m,d["!cols"]),d["!rows"]&&o(m,d["!rows"]),m.push("B;Y"+(g.e.r-g.s.r+1)+";X"+(g.e.c-g.s.c+1)+";D"+[g.s.c,g.s.r,g.e.c,g.e.r].join(" "));for(var E=g.s.r;E<=g.e.r;++E)for(var D=g.s.c;D<=g.e.c;++D){var R=de({r:E,c:D});_=F?(d[E]||[])[D]:d[R],!(!_||_.v==null&&(!_.f||_.F))&&u.push(h(_,d,E,D))}return m.join(y)+y+u.join(y)+y+"E"+y}return{to_workbook:c,to_sheet:i,from_sheet:x}}(),Ch=function(){function e(n,i){switch(i.type){case"base64":return t(xr(n),i);case"binary":return t(n,i);case"buffer":return t(ye&&Buffer.isBuffer(n)?n.toString("binary"):dt(n),i);case"array":return t(ht(n),i)}throw new Error("Unrecognized type "+i.type)}function t(n,i){for(var c=n.split(`
`),h=-1,f=-1,o=0,x=[];o!==c.length;++o){if(c[o].trim()==="BOT"){x[++h]=[],f=0;continue}if(!(h<0)){var d=c[o].trim().split(","),p=d[0],m=d[1];++o;for(var u=c[o]||"";(u.match(/["]/g)||[]).length&1&&o<c.length-1;)u+=`
`+c[++o];switch(u=u.trim(),+p){case-1:if(u==="BOT"){x[++h]=[],f=0;continue}else if(u!=="EOD")throw new Error("Unrecognized DIF special command "+u);break;case 0:u==="TRUE"?x[h][f]=!0:u==="FALSE"?x[h][f]=!1:isNaN(Sr(m))?isNaN(Ft(m).getDate())?x[h][f]=m:x[h][f]=$e(m):x[h][f]=Sr(m),++f;break;case 1:u=u.slice(1,u.length-1),u=u.replace(/""/g,'"'),u&&u.match(/^=".*"$/)&&(u=u.slice(2,-1)),x[h][f++]=u!==""?u:null;break}if(u==="EOD")break}}return i&&i.sheetRows&&(x=x.slice(0,i.sheetRows)),x}function r(n,i){return Dt(e(n,i),i)}function a(n,i){return tt(r(n,i),i)}var s=function(){var n=function(h,f,o,x,d){h.push(f),h.push(o+","+x),h.push('"'+d.replace(/"/g,'""')+'"')},i=function(h,f,o,x){h.push(f+","+o),h.push(f==1?'"'+x.replace(/"/g,'""')+'"':x)};return function(h){var f=[],o=De(h["!ref"]),x,d=Array.isArray(h);n(f,"TABLE",0,1,"sheetjs"),n(f,"VECTORS",0,o.e.r-o.s.r+1,""),n(f,"TUPLES",0,o.e.c-o.s.c+1,""),n(f,"DATA",0,0,"");for(var p=o.s.r;p<=o.e.r;++p){i(f,-1,0,"BOT");for(var m=o.s.c;m<=o.e.c;++m){var u=de({r:p,c:m});if(x=d?(h[p]||[])[m]:h[u],!x){i(f,1,0,"");continue}switch(x.t){case"n":var g=x.w;!g&&x.v!=null&&(g=x.v),g==null?x.f&&!x.F?i(f,1,0,"="+x.f):i(f,1,0,""):i(f,0,g,"V");break;case"b":i(f,0,x.v?1:0,x.v?"TRUE":"FALSE");break;case"s":i(f,1,0,isNaN(x.v)?x.v:'="'+x.v+'"');break;case"d":x.w||(x.w=yr(x.z||me[14],lr($e(x.v)))),i(f,0,x.w,"V");break;default:i(f,1,0,"")}}}i(f,-1,0,"EOD");var _=`\r
`,F=f.join(_);return F}}();return{to_workbook:a,to_sheet:r,from_sheet:s}}(),Nh=function(){function e(x){return x.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(x){return x.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(x,d){for(var p=x.split(`
`),m=-1,u=-1,g=0,_=[];g!==p.length;++g){var F=p[g].trim().split(":");if(F[0]==="cell"){var y=ir(F[1]);if(_.length<=y.r)for(m=_.length;m<=y.r;++m)_[m]||(_[m]=[]);switch(m=y.r,u=y.c,F[2]){case"t":_[m][u]=e(F[3]);break;case"v":_[m][u]=+F[3];break;case"vtf":var E=F[F.length-1];case"vtc":switch(F[3]){case"nl":_[m][u]=!!+F[4];break;default:_[m][u]=+F[4];break}F[2]=="vtf"&&(_[m][u]=[_[m][u],E])}}}return d&&d.sheetRows&&(_=_.slice(0,d.sheetRows)),_}function a(x,d){return Dt(r(x,d),d)}function s(x,d){return tt(a(x,d),d)}var n=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,c=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),h="--SocialCalcSpreadsheetControlSave--";function f(x){if(!x||!x["!ref"])return"";for(var d=[],p=[],m,u="",g=Rt(x["!ref"]),_=Array.isArray(x),F=g.s.r;F<=g.e.r;++F)for(var y=g.s.c;y<=g.e.c;++y)if(u=de({r:F,c:y}),m=_?(x[F]||[])[y]:x[u],!(!m||m.v==null||m.t==="z")){switch(p=["cell",u,"t"],m.t){case"s":case"str":p.push(t(m.v));break;case"n":m.f?(p[2]="vtf",p[3]="n",p[4]=m.v,p[5]=t(m.f)):(p[2]="v",p[3]=m.v);break;case"b":p[2]="vt"+(m.f?"f":"c"),p[3]="nl",p[4]=m.v?"1":"0",p[5]=t(m.f||(m.v?"TRUE":"FALSE"));break;case"d":var E=lr($e(m.v));p[2]="vtc",p[3]="nd",p[4]=""+E,p[5]=m.w||yr(m.z||me[14],E);break;case"e":continue}d.push(p.join(":"))}return d.push("sheet:c:"+(g.e.c-g.s.c+1)+":r:"+(g.e.r-g.s.r+1)+":tvf:1"),d.push("valueformat:1:text-wiki"),d.join(`
`)}function o(x){return[n,i,c,i,f(x),h].join(`
`)}return{to_workbook:s,to_sheet:a,from_sheet:o}}(),ra=function(){function e(o,x,d,p,m){m.raw?x[d][p]=o:o===""||(o==="TRUE"?x[d][p]=!0:o==="FALSE"?x[d][p]=!1:isNaN(Sr(o))?isNaN(Ft(o).getDate())?x[d][p]=o:x[d][p]=$e(o):x[d][p]=Sr(o))}function t(o,x){var d=x||{},p=[];if(!o||o.length===0)return p;for(var m=o.split(/[\r\n]/),u=m.length-1;u>=0&&m[u].length===0;)--u;for(var g=10,_=0,F=0;F<=u;++F)_=m[F].indexOf(" "),_==-1?_=m[F].length:_++,g=Math.max(g,_);for(F=0;F<=u;++F){p[F]=[];var y=0;for(e(m[F].slice(0,g).trim(),p,F,y,d),y=1;y<=(m[F].length-g)/10+1;++y)e(m[F].slice(g+(y-1)*10,g+y*10).trim(),p,F,y,d)}return d.sheetRows&&(p=p.slice(0,d.sheetRows)),p}var r={44:",",9:"	",59:";",124:"|"},a={44:3,9:2,59:1,124:0};function s(o){for(var x={},d=!1,p=0,m=0;p<o.length;++p)(m=o.charCodeAt(p))==34?d=!d:!d&&m in r&&(x[m]=(x[m]||0)+1);m=[];for(p in x)Object.prototype.hasOwnProperty.call(x,p)&&m.push([x[p],p]);if(!m.length){x=a;for(p in x)Object.prototype.hasOwnProperty.call(x,p)&&m.push([x[p],p])}return m.sort(function(u,g){return u[0]-g[0]||a[u[1]]-a[g[1]]}),r[m.pop()[1]]||44}function n(o,x){var d=x||{},p="",m=d.dense?[]:{},u={s:{c:0,r:0},e:{c:0,r:0}};o.slice(0,4)=="sep="?o.charCodeAt(5)==13&&o.charCodeAt(6)==10?(p=o.charAt(4),o=o.slice(7)):o.charCodeAt(5)==13||o.charCodeAt(5)==10?(p=o.charAt(4),o=o.slice(6)):p=s(o.slice(0,1024)):d&&d.FS?p=d.FS:p=s(o.slice(0,1024));var g=0,_=0,F=0,y=0,E=0,D=p.charCodeAt(0),R=!1,T=0,M=o.charCodeAt(0);o=o.replace(/\r\n/mg,`
`);var I=d.dateNF!=null?Ul(d.dateNF):null;function V(){var L=o.slice(y,E),P={};if(L.charAt(0)=='"'&&L.charAt(L.length-1)=='"'&&(L=L.slice(1,-1).replace(/""/g,'"')),L.length===0)P.t="z";else if(d.raw)P.t="s",P.v=L;else if(L.trim().length===0)P.t="s",P.v=L;else if(L.charCodeAt(0)==61)L.charCodeAt(1)==34&&L.charCodeAt(L.length-1)==34?(P.t="s",P.v=L.slice(2,-1).replace(/""/g,'"')):mx(L)?(P.t="n",P.f=L.slice(1)):(P.t="s",P.v=L);else if(L=="TRUE")P.t="b",P.v=!0;else if(L=="FALSE")P.t="b",P.v=!1;else if(!isNaN(F=Sr(L)))P.t="n",d.cellText!==!1&&(P.w=L),P.v=F;else if(!isNaN(Ft(L).getDate())||I&&L.match(I)){P.z=d.dateNF||me[14];var J=0;I&&L.match(I)&&(L=Vl(L,d.dateNF,L.match(I)||[]),J=1),d.cellDates?(P.t="d",P.v=$e(L,J)):(P.t="n",P.v=lr($e(L,J))),d.cellText!==!1&&(P.w=yr(P.z,P.v instanceof Date?lr(P.v):P.v)),d.cellNF||delete P.z}else P.t="s",P.v=L;if(P.t=="z"||(d.dense?(m[g]||(m[g]=[]),m[g][_]=P):m[de({c:_,r:g})]=P),y=E+1,M=o.charCodeAt(y),u.e.c<_&&(u.e.c=_),u.e.r<g&&(u.e.r=g),T==D)++_;else if(_=0,++g,d.sheetRows&&d.sheetRows<=g)return!0}e:for(;E<o.length;++E)switch(T=o.charCodeAt(E)){case 34:M===34&&(R=!R);break;case D:case 10:case 13:if(!R&&V())break e;break}return E-y>0&&V(),m["!ref"]=Te(u),m}function i(o,x){return!(x&&x.PRN)||x.FS||o.slice(0,4)=="sep="||o.indexOf("	")>=0||o.indexOf(",")>=0||o.indexOf(";")>=0?n(o,x):Dt(t(o,x),x)}function c(o,x){var d="",p=x.type=="string"?[0,0,0,0]:Ms(o,x);switch(x.type){case"base64":d=xr(o);break;case"binary":d=o;break;case"buffer":x.codepage==65001?d=o.toString("utf8"):x.codepage&&typeof Kr<"u"?d=Kr.utils.decode(x.codepage,o):d=ye&&Buffer.isBuffer(o)?o.toString("binary"):dt(o);break;case"array":d=ht(o);break;case"string":d=o;break;default:throw new Error("Unrecognized type "+x.type)}return p[0]==239&&p[1]==187&&p[2]==191?d=Se(d.slice(3)):x.type!="string"&&x.type!="buffer"&&x.codepage==65001?d=Se(d):x.type=="binary"&&typeof Kr<"u"&&x.codepage&&(d=Kr.utils.decode(x.codepage,Kr.utils.encode(28591,d))),d.slice(0,19)=="socialcalc:version:"?Nh.to_sheet(x.type=="string"?d:Se(d),x):i(d,x)}function h(o,x){return tt(c(o,x),x)}function f(o){for(var x=[],d=De(o["!ref"]),p,m=Array.isArray(o),u=d.s.r;u<=d.e.r;++u){for(var g=[],_=d.s.c;_<=d.e.c;++_){var F=de({r:u,c:_});if(p=m?(o[u]||[])[_]:o[F],!p||p.v==null){g.push("          ");continue}for(var y=(p.w||(Wr(p),p.w)||"").slice(0,10);y.length<10;)y+=" ";g.push(y+(_===0?" ":""))}x.push(g.join(""))}return x.join(`
`)}return{to_workbook:h,to_sheet:c,from_sheet:f}}();function Rh(e,t){var r=t||{},a=!!r.WTF;r.WTF=!0;try{var s=Fh.to_workbook(e,r);return r.WTF=a,s}catch(n){if(r.WTF=a,!n.message.match(/SYLK bad record ID/)&&a)throw n;return ra.to_workbook(e,t)}}var Yt=function(){function e(C,G,j){if(C){ze(C,C.l||0);for(var O=j.Enum||ue;C.l<C.length;){var q=C.read_shift(2),se=O[q]||O[65535],le=C.read_shift(2),te=C.l+le,Q=se.f&&se.f(C,le,j);if(C.l=te,G(Q,se,q))return}}}function t(C,G){switch(G.type){case"base64":return r(Er(xr(C)),G);case"binary":return r(Er(C),G);case"buffer":case"array":return r(C,G)}throw"Unsupported type "+G.type}function r(C,G){if(!C)return C;var j=G||{},O=j.dense?[]:{},q="Sheet1",se="",le=0,te={},Q=[],_e=[],N={s:{r:0,c:0},e:{r:0,c:0}},Ie=j.sheetRows||0;if(C[2]==0&&(C[3]==8||C[3]==9)&&C.length>=16&&C[14]==5&&C[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(C[2]==2)j.Enum=ue,e(C,function(ie,Oe,dr){switch(dr){case 0:j.vers=ie,ie>=4096&&(j.qpro=!0);break;case 6:N=ie;break;case 204:ie&&(se=ie);break;case 222:se=ie;break;case 15:case 51:j.qpro||(ie[1].v=ie[1].v.slice(1));case 13:case 14:case 16:dr==14&&(ie[2]&112)==112&&(ie[2]&15)>1&&(ie[2]&15)<15&&(ie[1].z=j.dateNF||me[14],j.cellDates&&(ie[1].t="d",ie[1].v=Pa(ie[1].v))),j.qpro&&ie[3]>le&&(O["!ref"]=Te(N),te[q]=O,Q.push(q),O=j.dense?[]:{},N={s:{r:0,c:0},e:{r:0,c:0}},le=ie[3],q=se||"Sheet"+(le+1),se="");var Fr=j.dense?(O[ie[0].r]||[])[ie[0].c]:O[de(ie[0])];if(Fr){Fr.t=ie[1].t,Fr.v=ie[1].v,ie[1].z!=null&&(Fr.z=ie[1].z),ie[1].f!=null&&(Fr.f=ie[1].f);break}j.dense?(O[ie[0].r]||(O[ie[0].r]=[]),O[ie[0].r][ie[0].c]=ie[1]):O[de(ie[0])]=ie[1];break}},j);else if(C[2]==26||C[2]==14)j.Enum=xe,C[2]==14&&(j.qpro=!0,C.l=0),e(C,function(ie,Oe,dr){switch(dr){case 204:q=ie;break;case 22:ie[1].v=ie[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ie[3]>le&&(O["!ref"]=Te(N),te[q]=O,Q.push(q),O=j.dense?[]:{},N={s:{r:0,c:0},e:{r:0,c:0}},le=ie[3],q="Sheet"+(le+1)),Ie>0&&ie[0].r>=Ie)break;j.dense?(O[ie[0].r]||(O[ie[0].r]=[]),O[ie[0].r][ie[0].c]=ie[1]):O[de(ie[0])]=ie[1],N.e.c<ie[0].c&&(N.e.c=ie[0].c),N.e.r<ie[0].r&&(N.e.r=ie[0].r);break;case 27:ie[14e3]&&(_e[ie[14e3][0]]=ie[14e3][1]);break;case 1537:_e[ie[0]]=ie[1],ie[0]==le&&(q=ie[1]);break}},j);else throw new Error("Unrecognized LOTUS BOF "+C[2]);if(O["!ref"]=Te(N),te[se||q]=O,Q.push(se||q),!_e.length)return{SheetNames:Q,Sheets:te};for(var Ee={},Ae=[],ve=0;ve<_e.length;++ve)te[Q[ve]]?(Ae.push(_e[ve]||Q[ve]),Ee[_e[ve]]=te[_e[ve]]||te[Q[ve]]):(Ae.push(_e[ve]),Ee[_e[ve]]={"!ref":"A1"});return{SheetNames:Ae,Sheets:Ee}}function a(C,G){var j=G||{};if(+j.codepage>=0&&br(+j.codepage),j.type=="string")throw new Error("Cannot write WK1 to JS string");var O=es(),q=De(C["!ref"]),se=Array.isArray(C),le=[];_r(O,0,n(1030)),_r(O,6,h(q));for(var te=Math.min(q.e.r,8191),Q=q.s.r;Q<=te;++Q)for(var _e=Xe(Q),N=q.s.c;N<=q.e.c;++N){Q===q.s.r&&(le[N]=He(N));var Ie=le[N]+_e,Ee=se?(C[Q]||[])[N]:C[Ie];if(!(!Ee||Ee.t=="z"))if(Ee.t=="n")(Ee.v|0)==Ee.v&&Ee.v>=-32768&&Ee.v<=32767?_r(O,13,p(Q,N,Ee.v)):_r(O,14,u(Q,N,Ee.v));else{var Ae=Wr(Ee);_r(O,15,x(Q,N,Ae.slice(0,239)))}}return _r(O,1),O.end()}function s(C,G){var j=G||{};if(+j.codepage>=0&&br(+j.codepage),j.type=="string")throw new Error("Cannot write WK3 to JS string");var O=es();_r(O,0,i(C));for(var q=0,se=0;q<C.SheetNames.length;++q)(C.Sheets[C.SheetNames[q]]||{})["!ref"]&&_r(O,27,z(C.SheetNames[q],se++));var le=0;for(q=0;q<C.SheetNames.length;++q){var te=C.Sheets[C.SheetNames[q]];if(!(!te||!te["!ref"])){for(var Q=De(te["!ref"]),_e=Array.isArray(te),N=[],Ie=Math.min(Q.e.r,8191),Ee=Q.s.r;Ee<=Ie;++Ee)for(var Ae=Xe(Ee),ve=Q.s.c;ve<=Q.e.c;++ve){Ee===Q.s.r&&(N[ve]=He(ve));var ie=N[ve]+Ae,Oe=_e?(te[Ee]||[])[ve]:te[ie];if(!(!Oe||Oe.t=="z"))if(Oe.t=="n")_r(O,23,V(Ee,ve,le,Oe.v));else{var dr=Wr(Oe);_r(O,22,T(Ee,ve,le,dr.slice(0,239)))}}++le}}return _r(O,1),O.end()}function n(C){var G=Ve(2);return G.write_shift(2,C),G}function i(C){var G=Ve(26);G.write_shift(2,4096),G.write_shift(2,4),G.write_shift(4,0);for(var j=0,O=0,q=0,se=0;se<C.SheetNames.length;++se){var le=C.SheetNames[se],te=C.Sheets[le];if(!(!te||!te["!ref"])){++q;var Q=Rt(te["!ref"]);j<Q.e.r&&(j=Q.e.r),O<Q.e.c&&(O=Q.e.c)}}return j>8191&&(j=8191),G.write_shift(2,j),G.write_shift(1,q),G.write_shift(1,O),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(1,1),G.write_shift(1,2),G.write_shift(4,0),G.write_shift(4,0),G}function c(C,G,j){var O={s:{c:0,r:0},e:{c:0,r:0}};return G==8&&j.qpro?(O.s.c=C.read_shift(1),C.l++,O.s.r=C.read_shift(2),O.e.c=C.read_shift(1),C.l++,O.e.r=C.read_shift(2),O):(O.s.c=C.read_shift(2),O.s.r=C.read_shift(2),G==12&&j.qpro&&(C.l+=2),O.e.c=C.read_shift(2),O.e.r=C.read_shift(2),G==12&&j.qpro&&(C.l+=2),O.s.c==65535&&(O.s.c=O.e.c=O.s.r=O.e.r=0),O)}function h(C){var G=Ve(8);return G.write_shift(2,C.s.c),G.write_shift(2,C.s.r),G.write_shift(2,C.e.c),G.write_shift(2,C.e.r),G}function f(C,G,j){var O=[{c:0,r:0},{t:"n",v:0},0,0];return j.qpro&&j.vers!=20768?(O[0].c=C.read_shift(1),O[3]=C.read_shift(1),O[0].r=C.read_shift(2),C.l+=2):(O[2]=C.read_shift(1),O[0].c=C.read_shift(2),O[0].r=C.read_shift(2)),O}function o(C,G,j){var O=C.l+G,q=f(C,G,j);if(q[1].t="s",j.vers==20768){C.l++;var se=C.read_shift(1);return q[1].v=C.read_shift(se,"utf8"),q}return j.qpro&&C.l++,q[1].v=C.read_shift(O-C.l,"cstr"),q}function x(C,G,j){var O=Ve(7+j.length);O.write_shift(1,255),O.write_shift(2,G),O.write_shift(2,C),O.write_shift(1,39);for(var q=0;q<O.length;++q){var se=j.charCodeAt(q);O.write_shift(1,se>=128?95:se)}return O.write_shift(1,0),O}function d(C,G,j){var O=f(C,G,j);return O[1].v=C.read_shift(2,"i"),O}function p(C,G,j){var O=Ve(7);return O.write_shift(1,255),O.write_shift(2,G),O.write_shift(2,C),O.write_shift(2,j,"i"),O}function m(C,G,j){var O=f(C,G,j);return O[1].v=C.read_shift(8,"f"),O}function u(C,G,j){var O=Ve(13);return O.write_shift(1,255),O.write_shift(2,G),O.write_shift(2,C),O.write_shift(8,j,"f"),O}function g(C,G,j){var O=C.l+G,q=f(C,G,j);if(q[1].v=C.read_shift(8,"f"),j.qpro)C.l=O;else{var se=C.read_shift(2);E(C.slice(C.l,C.l+se),q),C.l+=se}return q}function _(C,G,j){var O=G&32768;return G&=-32769,G=(O?C:0)+(G>=8192?G-16384:G),(O?"":"$")+(j?He(G):Xe(G))}var F={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},y=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function E(C,G){ze(C,0);for(var j=[],O=0,q="",se="",le="",te="";C.l<C.length;){var Q=C[C.l++];switch(Q){case 0:j.push(C.read_shift(8,"f"));break;case 1:se=_(G[0].c,C.read_shift(2),!0),q=_(G[0].r,C.read_shift(2),!1),j.push(se+q);break;case 2:{var _e=_(G[0].c,C.read_shift(2),!0),N=_(G[0].r,C.read_shift(2),!1);se=_(G[0].c,C.read_shift(2),!0),q=_(G[0].r,C.read_shift(2),!1),j.push(_e+N+":"+se+q)}break;case 3:if(C.l<C.length){console.error("WK1 premature formula end");return}break;case 4:j.push("("+j.pop()+")");break;case 5:j.push(C.read_shift(2));break;case 6:{for(var Ie="";Q=C[C.l++];)Ie+=String.fromCharCode(Q);j.push('"'+Ie.replace(/"/g,'""')+'"')}break;case 8:j.push("-"+j.pop());break;case 23:j.push("+"+j.pop());break;case 22:j.push("NOT("+j.pop()+")");break;case 20:case 21:te=j.pop(),le=j.pop(),j.push(["AND","OR"][Q-20]+"("+le+","+te+")");break;default:if(Q<32&&y[Q])te=j.pop(),le=j.pop(),j.push(le+y[Q]+te);else if(F[Q]){if(O=F[Q][1],O==69&&(O=C[C.l++]),O>j.length){console.error("WK1 bad formula parse 0x"+Q.toString(16)+":|"+j.join("|")+"|");return}var Ee=j.slice(-O);j.length-=O,j.push(F[Q][0]+"("+Ee.join(",")+")")}else return Q<=7?console.error("WK1 invalid opcode "+Q.toString(16)):Q<=24?console.error("WK1 unsupported op "+Q.toString(16)):Q<=30?console.error("WK1 invalid opcode "+Q.toString(16)):Q<=115?console.error("WK1 unsupported function opcode "+Q.toString(16)):console.error("WK1 unrecognized opcode "+Q.toString(16))}}j.length==1?G[1].f=""+j[0]:console.error("WK1 bad formula parse |"+j.join("|")+"|")}function D(C){var G=[{c:0,r:0},{t:"n",v:0},0];return G[0].r=C.read_shift(2),G[3]=C[C.l++],G[0].c=C[C.l++],G}function R(C,G){var j=D(C);return j[1].t="s",j[1].v=C.read_shift(G-4,"cstr"),j}function T(C,G,j,O){var q=Ve(6+O.length);q.write_shift(2,C),q.write_shift(1,j),q.write_shift(1,G),q.write_shift(1,39);for(var se=0;se<O.length;++se){var le=O.charCodeAt(se);q.write_shift(1,le>=128?95:le)}return q.write_shift(1,0),q}function M(C,G){var j=D(C);j[1].v=C.read_shift(2);var O=j[1].v>>1;if(j[1].v&1)switch(O&7){case 0:O=(O>>3)*5e3;break;case 1:O=(O>>3)*500;break;case 2:O=(O>>3)/20;break;case 3:O=(O>>3)/200;break;case 4:O=(O>>3)/2e3;break;case 5:O=(O>>3)/2e4;break;case 6:O=(O>>3)/16;break;case 7:O=(O>>3)/64;break}return j[1].v=O,j}function I(C,G){var j=D(C),O=C.read_shift(4),q=C.read_shift(4),se=C.read_shift(2);if(se==65535)return O===0&&q===3221225472?(j[1].t="e",j[1].v=15):O===0&&q===3489660928?(j[1].t="e",j[1].v=42):j[1].v=0,j;var le=se&32768;return se=(se&32767)-16446,j[1].v=(1-le*2)*(q*Math.pow(2,se+32)+O*Math.pow(2,se)),j}function V(C,G,j,O){var q=Ve(14);if(q.write_shift(2,C),q.write_shift(1,j),q.write_shift(1,G),O==0)return q.write_shift(4,0),q.write_shift(4,0),q.write_shift(2,65535),q;var se=0,le=0,te=0,Q=0;return O<0&&(se=1,O=-O),le=Math.log2(O)|0,O/=Math.pow(2,le-31),Q=O>>>0,Q&2147483648||(O/=2,++le,Q=O>>>0),O-=Q,Q|=2147483648,Q>>>=0,O*=Math.pow(2,32),te=O>>>0,q.write_shift(4,te),q.write_shift(4,Q),le+=16383+(se?32768:0),q.write_shift(2,le),q}function L(C,G){var j=I(C);return C.l+=G-14,j}function P(C,G){var j=D(C),O=C.read_shift(4);return j[1].v=O>>6,j}function J(C,G){var j=D(C),O=C.read_shift(8,"f");return j[1].v=O,j}function Y(C,G){var j=J(C);return C.l+=G-10,j}function X(C,G){return C[C.l+G-1]==0?C.read_shift(G,"cstr"):""}function re(C,G){var j=C[C.l++];j>G-1&&(j=G-1);for(var O="";O.length<j;)O+=String.fromCharCode(C[C.l++]);return O}function ne(C,G,j){if(!(!j.qpro||G<21)){var O=C.read_shift(1);C.l+=17,C.l+=1,C.l+=2;var q=C.read_shift(G-21,"cstr");return[O,q]}}function be(C,G){for(var j={},O=C.l+G;C.l<O;){var q=C.read_shift(2);if(q==14e3){for(j[q]=[0,""],j[q][0]=C.read_shift(2);C[C.l];)j[q][1]+=String.fromCharCode(C[C.l]),C.l++;C.l++}}return j}function z(C,G){var j=Ve(5+C.length);j.write_shift(2,14e3),j.write_shift(2,G);for(var O=0;O<C.length;++O){var q=C.charCodeAt(O);j[j.l++]=q>127?95:q}return j[j.l++]=0,j}var ue={0:{n:"BOF",f:Be},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:c},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:d},14:{n:"NUMBER",f:m},15:{n:"LABEL",f:o},16:{n:"FORMULA",f:g},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:o},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:X},222:{n:"SHEETNAMELP",f:re},65535:{n:""}},xe={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:R},23:{n:"NUMBER17",f:I},24:{n:"NUMBER18",f:M},25:{n:"FORMULA19",f:L},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:be},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:P},38:{n:"??"},39:{n:"NUMBER27",f:J},40:{n:"FORMULA28",f:Y},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:X},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ne},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:a,book_to_wk3:s,to_workbook:t}}();function Dh(e){var t={},r=e.match(tr),a=0,s=!1;if(r)for(;a!=r.length;++a){var n=he(r[a]);switch(n[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!n.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(n.val=="1")break;t.cp=xs[parseInt(n.val,10)];break;case"<outline":if(!n.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=n.val;break;case"<sz":t.sz=n.val;break;case"<strike":if(!n.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!n.val)break;switch(n.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(n.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(n.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":n.rgb&&(t.color=n.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=n.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=n.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+n[0])}}return t}var Ih=function(){var e=Qt("t"),t=Qt("rPr");function r(n){var i=n.match(e);if(!i)return{t:"s",v:""};var c={t:"s",v:ke(i[1])},h=n.match(t);return h&&(c.s=Dh(h[1])),c}var a=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(i){return i.replace(a,"").split(s).map(r).filter(function(c){return c.v})}}(),Oh=function(){var t=/(\r\n|\n)/g;function r(s,n,i){var c=[];s.u&&c.push("text-decoration: underline;"),s.uval&&c.push("text-underline-style:"+s.uval+";"),s.sz&&c.push("font-size:"+s.sz+"pt;"),s.outline&&c.push("text-effect: outline;"),s.shadow&&c.push("text-shadow: auto;"),n.push('<span style="'+c.join("")+'">'),s.b&&(n.push("<b>"),i.push("</b>")),s.i&&(n.push("<i>"),i.push("</i>")),s.strike&&(n.push("<s>"),i.push("</s>"));var h=s.valign||"";return h=="superscript"||h=="super"?h="sup":h=="subscript"&&(h="sub"),h!=""&&(n.push("<"+h+">"),i.push("</"+h+">")),i.push("</span>"),s}function a(s){var n=[[],s.v,[]];return s.v?(s.s&&r(s.s,n[0],n[2]),n[0].join("")+n[1].replace(t,"<br/>")+n[2].join("")):""}return function(n){return n.map(a).join("")}}(),Ph=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,jh=/<(?:\w+:)?r>/,Mh=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Ns(e,t){var r=t?t.cellHTML:!0,a={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(a.t=ke(Se(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),a.r=Se(e),r&&(a.h=ws(a.t))):e.match(jh)&&(a.r=Se(e),a.t=ke(Se((e.replace(Mh,"").match(Ph)||[]).join("").replace(tr,""))),r&&(a.h=Oh(Ih(a.r)))),a):{t:""}}var Lh=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,Bh=/<(?:\w+:)?(?:si|sstItem)>/g,Uh=/<\/(?:\w+:)?(?:si|sstItem)>/;function Vh(e,t){var r=[],a="";if(!e)return r;var s=e.match(Lh);if(s){a=s[2].replace(Bh,"").split(Uh);for(var n=0;n!=a.length;++n){var i=Ns(a[n].trim(),t);i!=null&&(r[r.length]=i)}s=he(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}function Hh(e){return[e.read_shift(4),e.read_shift(4)]}function Gh(e,t){var r=[],a=!1;return $r(e,function(n,i,c){switch(c){case 159:r.Count=n[0],r.Unique=n[1];break;case 19:r.push(n);break;case 160:return!0;case 35:a=!0;break;case 36:a=!1;break;default:if(i.T,!a||t.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}),r}function d0(e){for(var t=[],r=e.split(""),a=0;a<r.length;++a)t[a]=r[a].charCodeAt(0);return t}function Gr(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function Wh(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=Gr(e,4),t.U=Gr(e,4),t.W=Gr(e,4),t}function $h(e){for(var t=e.read_shift(4),r=e.l+t-4,a={},s=e.read_shift(4),n=[];s-- >0;)n.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(a.name=e.read_shift(0,"lpp4"),a.comps=n,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return a}function zh(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push($h(e));return t}function Yh(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function Xh(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Gr(e,4),t.U=Gr(e,4),t.W=Gr(e,4),t}function Kh(e){var t=Xh(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function p0(e,t){var r=e.l+t,a={};a.Flags=e.read_shift(4)&63,e.l+=4,a.AlgID=e.read_shift(4);var s=!1;switch(a.AlgID){case 26126:case 26127:case 26128:s=a.Flags==36;break;case 26625:s=a.Flags==4;break;case 0:s=a.Flags==16||a.Flags==4||a.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+a.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return a.AlgIDHash=e.read_shift(4),a.KeySize=e.read_shift(4),a.ProviderType=e.read_shift(4),e.l+=8,a.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,a}function m0(e,t){var r={},a=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,a),e.l=a,r}function qh(e){var t=Gr(e);switch(t.Minor){case 2:return[t.Minor,Jh(e)];case 3:return[t.Minor,Zh()];case 4:return[t.Minor,Qh(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function Jh(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),a=p0(e,r),s=m0(e,e.length-e.l);return{t:"Std",h:a,v:s}}function Zh(){throw new Error("File is password-protected: ECMA-376 Extensible")}function Qh(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),a={};return r.replace(tr,function(n){var i=he(n);switch(Or(i[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(c){a[c]=i[c]});break;case"<dataIntegrity":a.encryptedHmacKey=i.encryptedHmacKey,a.encryptedHmacValue=i.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":a.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":a.uri=i.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":a.encs.push(i);break;default:throw i[0]}}),a}function eu(e,t){var r={},a=r.EncryptionVersionInfo=Gr(e,4);if(t-=4,a.Minor!=2)throw new Error("unrecognized minor version code: "+a.Minor);if(a.Major>4||a.Major<2)throw new Error("unrecognized major version code: "+a.Major);r.Flags=e.read_shift(4),t-=4;var s=e.read_shift(4);return t-=4,r.EncryptionHeader=p0(e,s),t-=s,r.EncryptionVerifier=m0(e,t),r}function ru(e){var t={},r=t.EncryptionVersionInfo=Gr(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function tu(e){var t=0,r,a=d0(e),s=a.length+1,n,i,c,h,f;for(r=et(s),r[0]=a.length,n=1;n!=s;++n)r[n]=a[n-1];for(n=s-1;n>=0;--n)i=r[n],c=t&16384?1:0,h=t<<1&32767,f=c|h,t=f^i;return t^52811}var g0=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],a=function(i){return(i/2|i*128)&255},s=function(i,c){return a(i^c)},n=function(i){for(var c=t[i.length-1],h=104,f=i.length-1;f>=0;--f)for(var o=i[f],x=0;x!=7;++x)o&64&&(c^=r[h]),o*=2,--h;return c};return function(i){for(var c=d0(i),h=n(c),f=c.length,o=et(16),x=0;x!=16;++x)o[x]=0;var d,p,m;for((f&1)===1&&(d=h>>8,o[f]=s(e[0],d),--f,d=h&255,p=c[c.length-1],o[f]=s(p,d));f>0;)--f,d=h>>8,o[f]=s(c[f],d),--f,d=h&255,o[f]=s(c[f],d);for(f=15,m=15-c.length;m>0;)d=h>>8,o[f]=s(e[m],d),--f,--m,d=h&255,o[f]=s(c[f],d),--f,--m;return o}}(),au=function(e,t,r,a,s){s||(s=t),a||(a=g0(e));var n,i;for(n=0;n!=t.length;++n)i=t[n],i^=a[r],i=(i>>5|i<<3)&255,s[n]=i,++r;return[s,r,a]},su=function(e){var t=0,r=g0(e);return function(a){var s=au("",a,t,r);return t=s[1],s[0]}};function nu(e,t,r,a){var s={key:Be(e),verificationBytes:Be(e)};return r.password&&(s.verifier=tu(r.password)),a.valid=s.verificationBytes===s.verifier,a.valid&&(a.insitu=su(r.password)),s}function iu(e,t,r){var a=r||{};return a.Info=e.read_shift(2),e.l-=2,a.Info===1?a.Data=ru(e):a.Data=eu(e,t),a}function cu(e,t,r){var a={Type:r.biff>=8?e.read_shift(2):0};return a.Type?iu(e,t-2,a):nu(e,r.biff>=8?t:t-2,r,a),a}var lu=function(){function e(s,n){switch(n.type){case"base64":return t(xr(s),n);case"binary":return t(s,n);case"buffer":return t(ye&&Buffer.isBuffer(s)?s.toString("binary"):dt(s),n);case"array":return t(ht(s),n)}throw new Error("Unrecognized type "+n.type)}function t(s,n){var i=n||{},c=i.dense?[]:{},h=s.match(/\\trowd.*?\\row\b/g);if(!h.length)throw new Error("RTF missing table");var f={s:{c:0,r:0},e:{c:0,r:h.length-1}};return h.forEach(function(o,x){Array.isArray(c)&&(c[x]=[]);for(var d=/\\\w+\b/g,p=0,m,u=-1;m=d.exec(o);){switch(m[0]){case"\\cell":var g=o.slice(p,d.lastIndex-m[0].length);if(g[0]==" "&&(g=g.slice(1)),++u,g.length){var _={v:g,t:"s"};Array.isArray(c)?c[x][u]=_:c[de({r:x,c:u})]=_}break}p=d.lastIndex}u>f.e.c&&(f.e.c=u)}),c["!ref"]=Te(f),c}function r(s,n){return tt(e(s,n),n)}function a(s){for(var n=["{\\rtf1\\ansi"],i=De(s["!ref"]),c,h=Array.isArray(s),f=i.s.r;f<=i.e.r;++f){n.push("\\trowd\\trautofit1");for(var o=i.s.c;o<=i.e.c;++o)n.push("\\cellx"+(o+1));for(n.push("\\pard\\intbl"),o=i.s.c;o<=i.e.c;++o){var x=de({r:f,c:o});c=h?(s[f]||[])[o]:s[x],!(!c||c.v==null&&(!c.f||c.F))&&(n.push(" "+(c.w||(Wr(c),c.w))),n.push("\\cell"))}n.push("\\pard\\intbl\\row")}return n.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:a}}();function ou(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function ta(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function fu(e){var t=e[0]/255,r=e[1]/255,a=e[2]/255,s=Math.max(t,r,a),n=Math.min(t,r,a),i=s-n;if(i===0)return[0,0,t];var c=0,h=0,f=s+n;switch(h=i/(f>1?2-f:f),s){case t:c=((r-a)/i+6)%6;break;case r:c=(a-t)/i+2;break;case a:c=(t-r)/i+4;break}return[c/6,h,f/2]}function hu(e){var t=e[0],r=e[1],a=e[2],s=r*2*(a<.5?a:1-a),n=a-s/2,i=[n,n,n],c=6*t,h;if(r!==0)switch(c|0){case 0:case 6:h=s*c,i[0]+=s,i[1]+=h;break;case 1:h=s*(2-c),i[0]+=h,i[1]+=s;break;case 2:h=s*(c-2),i[1]+=s,i[2]+=h;break;case 3:h=s*(4-c),i[1]+=h,i[2]+=s;break;case 4:h=s*(c-4),i[2]+=s,i[0]+=h;break;case 5:h=s*(6-c),i[2]+=h,i[0]+=s;break}for(var f=0;f!=3;++f)i[f]=Math.round(i[f]*255);return i}function Na(e,t){if(t===0)return e;var r=fu(ou(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),ta(hu(r))}var v0=6,uu=15,xu=1,nr=v0;function Ra(e){return Math.floor((e+Math.round(128/nr)/256)*nr)}function Da(e){return Math.floor((e-5)/nr*100+.5)/100}function ss(e){return Math.round((e*nr+5)/nr*256)/256}function $a(e){return ss(Da(Ra(e)))}function Rs(e){var t=Math.abs(e-$a(e)),r=nr;if(t>.005)for(nr=xu;nr<uu;++nr)Math.abs(e-$a(e))<=t&&(t=Math.abs(e-$a(e)),r=nr);nr=r}function Ct(e){e.width?(e.wpx=Ra(e.width),e.wch=Da(e.wpx),e.MDW=nr):e.wpx?(e.wch=Da(e.wpx),e.width=ss(e.wch),e.MDW=nr):typeof e.wch=="number"&&(e.width=ss(e.wch),e.wpx=Ra(e.width),e.MDW=nr),e.customWidth&&delete e.customWidth}var du=96,y0=du;function w0(e){return e*96/y0}function aa(e){return e*y0/96}var pu={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function mu(e,t,r,a){t.Borders=[];var s={},n=!1;(e[0].match(tr)||[]).forEach(function(i){var c=he(i);switch(Or(c[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},c.diagonalUp&&(s.diagonalUp=Fe(c.diagonalUp)),c.diagonalDown&&(s.diagonalDown=Fe(c.diagonalDown)),t.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(a&&a.WTF&&!n)throw new Error("unrecognized "+c[0]+" in borders")}})}function gu(e,t,r,a){t.Fills=[];var s={},n=!1;(e[0].match(tr)||[]).forEach(function(i){var c=he(i);switch(Or(c[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},t.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":c.patternType&&(s.patternType=c.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),c.indexed&&(s.bgColor.indexed=parseInt(c.indexed,10)),c.theme&&(s.bgColor.theme=parseInt(c.theme,10)),c.tint&&(s.bgColor.tint=parseFloat(c.tint)),c.rgb&&(s.bgColor.rgb=c.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),c.theme&&(s.fgColor.theme=parseInt(c.theme,10)),c.tint&&(s.fgColor.tint=parseFloat(c.tint)),c.rgb!=null&&(s.fgColor.rgb=c.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(a&&a.WTF&&!n)throw new Error("unrecognized "+c[0]+" in fills")}})}function vu(e,t,r,a){t.Fonts=[];var s={},n=!1;(e[0].match(tr)||[]).forEach(function(i){var c=he(i);switch(Or(c[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(s),s={};break;case"<name":c.val&&(s.name=Se(c.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=c.val?Fe(c.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=c.val?Fe(c.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(c.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=c.val?Fe(c.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=c.val?Fe(c.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=c.val?Fe(c.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=c.val?Fe(c.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=c.val?Fe(c.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":c.val&&(s.sz=+c.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":c.val&&(s.vertAlign=c.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":c.val&&(s.family=parseInt(c.val,10));break;case"<family/>":case"</family>":break;case"<scheme":c.val&&(s.scheme=c.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(c.val=="1")break;c.codepage=xs[parseInt(c.val,10)];break;case"<color":if(s.color||(s.color={}),c.auto&&(s.color.auto=Fe(c.auto)),c.rgb)s.color.rgb=c.rgb.slice(-6);else if(c.indexed){s.color.index=parseInt(c.indexed,10);var h=ot[s.color.index];s.color.index==81&&(h=ot[1]),h||(h=ot[1]),s.color.rgb=h[0].toString(16)+h[1].toString(16)+h[2].toString(16)}else c.theme&&(s.color.theme=parseInt(c.theme,10),c.tint&&(s.color.tint=parseFloat(c.tint)),c.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=Na(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":n=!0;break;case"</AlternateContent>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(a&&a.WTF&&!n)throw new Error("unrecognized "+c[0]+" in fonts")}})}function yu(e,t,r){t.NumberFmt=[];for(var a=Ir(me),s=0;s<a.length;++s)t.NumberFmt[a[s]]=me[a[s]];var n=e[0].match(tr);if(n)for(s=0;s<n.length;++s){var i=he(n[s]);switch(Or(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var c=ke(Se(i.formatCode)),h=parseInt(i.numFmtId,10);if(t.NumberFmt[h]=c,h>0){if(h>392){for(h=392;h>60&&t.NumberFmt[h]!=null;--h);t.NumberFmt[h]=c}lt(c,h)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}var ya=["numFmtId","fillId","fontId","borderId","xfId"],wa=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function wu(e,t,r){t.CellXf=[];var a,s=!1;(e[0].match(tr)||[]).forEach(function(n){var i=he(n),c=0;switch(Or(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(a=i,delete a[0],c=0;c<ya.length;++c)a[ya[c]]&&(a[ya[c]]=parseInt(a[ya[c]],10));for(c=0;c<wa.length;++c)a[wa[c]]&&(a[wa[c]]=Fe(a[wa[c]]));if(t.NumberFmt&&a.numFmtId>392){for(c=392;c>60;--c)if(t.NumberFmt[a.numFmtId]==t.NumberFmt[c]){a.numFmtId=c;break}}t.CellXf.push(a);break;case"</xf>":break;case"<alignment":case"<alignment/>":var h={};i.vertical&&(h.vertical=i.vertical),i.horizontal&&(h.horizontal=i.horizontal),i.textRotation!=null&&(h.textRotation=i.textRotation),i.indent&&(h.indent=i.indent),i.wrapText&&(h.wrapText=Fe(i.wrapText)),a.alignment=h;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+i[0]+" in cellXfs")}})}var Tu=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,a=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,n=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(c,h,f){var o={};if(!c)return o;c=c.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var x;return(x=c.match(t))&&yu(x,o,f),(x=c.match(s))&&vu(x,o,h,f),(x=c.match(a))&&gu(x,o,h,f),(x=c.match(n))&&mu(x,o,h,f),(x=c.match(r))&&wu(x,o,f),o}}();function _u(e,t){var r=e.read_shift(2),a=er(e);return[r,a]}function ku(e,t,r){var a={};a.sz=e.read_shift(2)/20;var s=Do(e);s.fItalic&&(a.italic=1),s.fCondense&&(a.condense=1),s.fExtend&&(a.extend=1),s.fShadow&&(a.shadow=1),s.fOutline&&(a.outline=1),s.fStrikeout&&(a.strike=1);var n=e.read_shift(2);switch(n===700&&(a.bold=1),e.read_shift(2)){case 1:a.vertAlign="superscript";break;case 2:a.vertAlign="subscript";break}var i=e.read_shift(1);i!=0&&(a.underline=i);var c=e.read_shift(1);c>0&&(a.family=c);var h=e.read_shift(1);switch(h>0&&(a.charset=h),e.l++,a.color=Ro(e),e.read_shift(1)){case 1:a.scheme="major";break;case 2:a.scheme="minor";break}return a.name=er(e),a}var Eu=rr;function bu(e,t){var r=e.l+t,a=e.read_shift(2),s=e.read_shift(2);return e.l=r,{ixfe:a,numFmtId:s}}var Au=rr;function Su(e,t,r){var a={};a.NumberFmt=[];for(var s in me)a.NumberFmt[s]=me[s];a.CellXf=[],a.Fonts=[];var n=[],i=!1;return $r(e,function(h,f,o){switch(o){case 44:a.NumberFmt[h[0]]=h[1],lt(h[1],h[0]);break;case 43:a.Fonts.push(h),h.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(h.color.rgb=Na(t.themeElements.clrScheme[h.color.theme].rgb,h.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:n[n.length-1]==617&&a.CellXf.push(h);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:n.push(o),i=!0;break;case 38:n.pop(),i=!1;break;default:if(f.T>0)n.push(o);else if(f.T<0)n.pop();else if(!i||r.WTF&&n[n.length-1]!=37)throw new Error("Unexpected record 0x"+o.toString(16))}}),a}var Fu=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function Cu(e,t,r){t.themeElements.clrScheme=[];var a={};(e[0].match(tr)||[]).forEach(function(s){var n=he(s);switch(n[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":a.rgb=n.val;break;case"<a:sysClr":a.rgb=n.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":n[0].charAt(1)==="/"?(t.themeElements.clrScheme[Fu.indexOf(n[0])]=a,a={}):a.name=n[0].slice(3,n[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+n[0]+" in clrScheme")}})}function Nu(){}function Ru(){}var Du=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,Iu=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,Ou=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function Pu(e,t,r){t.themeElements={};var a;[["clrScheme",Du,Cu],["fontScheme",Iu,Nu],["fmtScheme",Ou,Ru]].forEach(function(s){if(!(a=e.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](a,t,r)})}var ju=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function T0(e,t){(!e||e.length===0)&&(e=Mu());var r,a={};if(!(r=e.match(ju)))throw new Error("themeElements not found in theme");return Pu(r[0],a,t),a.raw=e,a}function Mu(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Di];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function Lu(e,t,r){var a=e.l+t,s=e.read_shift(4);if(s!==124226){if(!r.cellStyles){e.l=a;return}var n=e.slice(e.l);e.l=a;var i;try{i=Ri(n,{type:"array"})}catch{return}var c=ur(i,"theme/theme/theme1.xml",!0);if(c)return T0(c,r)}}function Bu(e){return e.read_shift(4)}function Uu(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=Vu(e,4);break;case 2:t.xclrValue=c0(e);break;case 3:t.xclrValue=Bu(e);break;case 4:e.l+=4;break}return e.l+=8,t}function Vu(e,t){return rr(e,t)}function Hu(e,t){return rr(e,t)}function Gu(e){var t=e.read_shift(2),r=e.read_shift(2)-4,a=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:a[1]=Uu(e);break;case 6:a[1]=Hu(e,r);break;case 14:case 15:a[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return a}function Wu(e,t){var r=e.l+t;e.l+=2;var a=e.read_shift(2);e.l+=2;for(var s=e.read_shift(2),n=[];s-- >0;)n.push(Gu(e,r-e.l));return{ixfe:a,ext:n}}function $u(e,t){t.forEach(function(r){switch(r[0]){}})}function zu(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:er(e)}}function Yu(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function Xu(e){return e.l+=4,e.read_shift(4)!=0}function Ku(e,t,r){var a={Types:[],Cell:[],Value:[]},s=r||{},n=[],i=!1,c=2;return $r(e,function(h,f,o){switch(o){case 335:a.Types.push({name:h.name});break;case 51:h.forEach(function(x){c==1?a.Cell.push({type:a.Types[x[0]-1].name,index:x[1]}):c==0&&a.Value.push({type:a.Types[x[0]-1].name,index:x[1]})});break;case 337:c=h?1:0;break;case 338:c=2;break;case 35:n.push(o),i=!0;break;case 36:n.pop(),i=!1;break;default:if(!f.T){if(!i||s.WTF&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+o.toString(16))}}}),a}function qu(e,t,r){var a={Types:[],Cell:[],Value:[]};if(!e)return a;var s=!1,n=2,i;return e.replace(tr,function(c){var h=he(c);switch(Or(h[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":a.Types.push({name:h.name});break;case"</metadataType>":break;case"<futureMetadata":for(var f=0;f<a.Types.length;++f)a.Types[f].name==h.name&&(i=a.Types[f]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":n==1?a.Cell.push({type:a.Types[h.t-1].name,index:+h.v}):n==0&&a.Value.push({type:a.Types[h.t-1].name,index:+h.v});break;case"</rc>":break;case"<cellMetadata":n=1;break;case"</cellMetadata>":n=2;break;case"<valueMetadata":n=0;break;case"</valueMetadata>":n=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!i)break;i.offsets||(i.offsets=[]),i.offsets.push(+h.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+h[0]+" in metadata")}return c}),a}function Ju(e){var t=[];if(!e)return t;var r=1;return(e.match(tr)||[]).forEach(function(a){var s=he(a);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,t.push(s);break}}),t}function Zu(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=de(r);var a=e.read_shift(1);return a&2&&(t.l="1"),a&8&&(t.a="1"),t}function Qu(e,t,r){var a=[];return $r(e,function(n,i,c){switch(c){case 63:a.push(n);break;default:if(!i.T)throw new Error("Unexpected record 0x"+c.toString(16))}}),a}function ex(e,t,r,a){if(!e)return e;var s=a||{},n=!1;$r(e,function(c,h,f){switch(f){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:n=!0;break;case 36:n=!1;break;default:if(!h.T){if(!n||s.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}},s)}function rx(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}function jn(e,t,r,a){var s=Array.isArray(e),n;t.forEach(function(i){var c=ir(i.ref);if(s?(e[c.r]||(e[c.r]=[]),n=e[c.r][c.c]):n=e[i.ref],!n){n={t:"z"},s?e[c.r][c.c]=n:e[i.ref]=n;var h=De(e["!ref"]||"BDWGO1000001:A1");h.s.r>c.r&&(h.s.r=c.r),h.e.r<c.r&&(h.e.r=c.r),h.s.c>c.c&&(h.s.c=c.c),h.e.c<c.c&&(h.e.c=c.c);var f=Te(h);f!==e["!ref"]&&(e["!ref"]=f)}n.c||(n.c=[]);var o={a:i.author,t:i.t,r:i.r,T:r};i.h&&(o.h=i.h);for(var x=n.c.length-1;x>=0;--x){if(!r&&n.c[x].T)return;r&&!n.c[x].T&&n.c.splice(x,1)}if(r&&a){for(x=0;x<a.length;++x)if(o.a==a[x].id){o.a=a[x].name||o.a;break}}n.c.push(o)})}function tx(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],a=[],s=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(i){if(!(i===""||i.trim()==="")){var c=i.match(/<(?:\w+:)?author[^>]*>(.*)/);c&&r.push(c[1])}});var n=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return n&&n[1]&&n[1].split(/<\/\w*:?comment>/).forEach(function(i){if(!(i===""||i.trim()==="")){var c=i.match(/<(?:\w+:)?comment[^>]*>/);if(c){var h=he(c[0]),f={author:h.authorId&&r[h.authorId]||"sheetjsghost",ref:h.ref,guid:h.guid},o=ir(h.ref);if(!(t.sheetRows&&t.sheetRows<=o.r)){var x=i.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),d=!!x&&!!x[1]&&Ns(x[1])||{r:"",t:"",h:""};f.r=d.r,d.r=="<t></t>"&&(d.t=d.h=""),f.t=(d.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(f.h=d.h),a.push(f)}}}}),a}function ax(e,t){var r=[],a=!1,s={},n=0;return e.replace(tr,function(c,h){var f=he(c);switch(Or(f[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:f.personId,guid:f.id,ref:f.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":n=h+c.length;break;case"</text>":s.t=e.slice(n,h).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":a=!0;break;case"</mentions>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+f[0]+" in threaded comments")}return c}),r}function sx(e,t){var r=[],a=!1;return e.replace(tr,function(n){var i=he(n);switch(Or(i[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:i.displayname,id:i.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+i[0]+" in threaded comments")}return n}),r}function nx(e){var t={};t.iauthor=e.read_shift(4);var r=mt(e);return t.rfx=r.s,t.ref=de(r.s),e.l+=16,t}var ix=er;function cx(e,t){var r=[],a=[],s={},n=!1;return $r(e,function(c,h,f){switch(f){case 632:a.push(c);break;case 635:s=c;break;case 637:s.t=c.t,s.h=c.h,s.r=c.r;break;case 636:if(s.author=a[s.iauthor],delete s.iauthor,t.sheetRows&&s.rfx&&t.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:n=!0;break;case 36:n=!1;break;case 37:break;case 38:break;default:if(!h.T){if(!n||t.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}),r}var lx="application/vnd.ms-office.vbaProject";function ox(e){var t=we.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,a){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");we.utils.cfb_add(t,s,e.FileIndex[a].content)}}),we.write(t)}function fx(){return{"!type":"dialog"}}function hx(){return{"!type":"dialog"}}function ux(){return{"!type":"macro"}}function xx(){return{"!type":"macro"}}var Et=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(a,s,n,i){var c=!1,h=!1;n.length==0?h=!0:n.charAt(0)=="["&&(h=!0,n=n.slice(1,-1)),i.length==0?c=!0:i.charAt(0)=="["&&(c=!0,i=i.slice(1,-1));var f=n.length>0?parseInt(n,10)|0:0,o=i.length>0?parseInt(i,10)|0:0;return c?o+=t.c:--o,h?f+=t.r:--f,s+(c?"":"$")+He(o)+(h?"":"$")+Xe(f)}return function(s,n){return t=n,s.replace(e,r)}}(),_0=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,dx=function(){return function(t,r){return t.replace(_0,function(a,s,n,i,c,h){var f=Es(i)-(n?0:r.c),o=ks(h)-(c?0:r.r),x=o==0?"":c?o+1:"["+o+"]",d=f==0?"":n?f+1:"["+f+"]";return s+"R"+x+"C"+d})}}();function k0(e,t){return e.replace(_0,function(r,a,s,n,i,c){return a+(s=="$"?s+n:He(Es(n)+t.c))+(i=="$"?i+c:Xe(ks(c)+t.r))})}function px(e,t,r){var a=Rt(t),s=a.s,n=ir(r),i={r:n.r-s.r,c:n.c-s.c};return k0(e,i)}function mx(e){return e.length!=1}function Mn(e){return e.replace(/_xlfn\./g,"")}function Me(e){e.l+=1}function rt(e,t){var r=e.read_shift(t==1?1:2);return[r&16383,r>>14&1,r>>15&1]}function E0(e,t,r){var a=2;if(r){if(r.biff>=2&&r.biff<=5)return b0(e);r.biff==12&&(a=4)}var s=e.read_shift(a),n=e.read_shift(a),i=rt(e,2),c=rt(e,2);return{s:{r:s,c:i[0],cRel:i[1],rRel:i[2]},e:{r:n,c:c[0],cRel:c[1],rRel:c[2]}}}function b0(e){var t=rt(e,2),r=rt(e,2),a=e.read_shift(1),s=e.read_shift(1);return{s:{r:t[0],c:a,cRel:t[1],rRel:t[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function gx(e,t,r){if(r.biff<8)return b0(e);var a=e.read_shift(r.biff==12?4:2),s=e.read_shift(r.biff==12?4:2),n=rt(e,2),i=rt(e,2);return{s:{r:a,c:n[0],cRel:n[1],rRel:n[2]},e:{r:s,c:i[0],cRel:i[1],rRel:i[2]}}}function A0(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return vx(e);var a=e.read_shift(r&&r.biff==12?4:2),s=rt(e,2);return{r:a,c:s[0],cRel:s[1],rRel:s[2]}}function vx(e){var t=rt(e,2),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function yx(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function wx(e,t,r){var a=r&&r.biff?r.biff:8;if(a>=2&&a<=5)return Tx(e);var s=e.read_shift(a>=12?4:2),n=e.read_shift(2),i=(n&16384)>>14,c=(n&32768)>>15;if(n&=16383,c==1)for(;s>524287;)s-=1048576;if(i==1)for(;n>8191;)n=n-16384;return{r:s,c:n,cRel:i,rRel:c}}function Tx(e){var t=e.read_shift(2),r=e.read_shift(1),a=(t&32768)>>15,s=(t&16384)>>14;return t&=16383,a==1&&t>=8192&&(t=t-16384),s==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:s,rRel:a}}function _x(e,t,r){var a=(e[e.l++]&96)>>5,s=E0(e,r.biff>=2&&r.biff<=5?6:8,r);return[a,s]}function kx(e,t,r){var a=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),n=8;if(r)switch(r.biff){case 5:e.l+=12,n=6;break;case 12:n=12;break}var i=E0(e,n,r);return[a,s,i]}function Ex(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[a]}function bx(e,t,r){var a=(e[e.l++]&96)>>5,s=e.read_shift(2),n=8;if(r)switch(r.biff){case 5:e.l+=12,n=6;break;case 12:n=12;break}return e.l+=n,[a,s]}function Ax(e,t,r){var a=(e[e.l++]&96)>>5,s=gx(e,t-1,r);return[a,s]}function Sx(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[a]}function Ln(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function Fx(e,t,r){e.l+=2;for(var a=e.read_shift(r&&r.biff==2?1:2),s=[],n=0;n<=a;++n)s.push(e.read_shift(r&&r.biff==2?1:2));return s}function Cx(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function Nx(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function Rx(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function Dx(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[a]}function S0(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function Ix(e){return e.read_shift(2),S0(e)}function Ox(e){return e.read_shift(2),S0(e)}function Px(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var s=A0(e,0,r);return[a,s]}function jx(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var s=wx(e,0,r);return[a,s]}function Mx(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var n=A0(e,0,r);return[a,s,n]}function Lx(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(r&&r.biff<=3?1:2);return[Bd[s],N0[s],a]}function Bx(e,t,r){var a=e[e.l++],s=e.read_shift(1),n=r&&r.biff<=3?[a==88?-1:0,e.read_shift(1)]:Ux(e);return[s,(n[0]===0?N0:Ld)[n[1]]]}function Ux(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function Vx(e,t,r){e.l+=r&&r.biff==2?3:4}function Hx(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var a=e.read_shift(2),s=e.read_shift(r&&r.biff==2?1:2);return[a,s]}function Gx(e){return e.l++,gt[e.read_shift(1)]}function Wx(e){return e.l++,e.read_shift(2)}function $x(e){return e.l++,e.read_shift(1)!==0}function zx(e){return e.l++,Ze(e)}function Yx(e,t,r){return e.l++,ca(e,t-1,r)}function Xx(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=je(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=gt[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Ze(e);break;case 2:r[1]=vt(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function Kx(e,t,r){for(var a=e.read_shift(r.biff==12?4:2),s=[],n=0;n!=a;++n)s.push((r.biff==12?mt:ja)(e));return s}function qx(e,t,r){var a=0,s=0;r.biff==12?(a=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),a=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--a,--s==0&&(s=256));for(var n=0,i=[];n!=a&&(i[n]=[]);++n)for(var c=0;c!=s;++c)i[n][c]=Xx(e,r.biff);return i}function Jx(e,t,r){var a=e.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,n=e.read_shift(s);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[a,0,n]}function Zx(e,t,r){if(r.biff==5)return Qx(e);var a=e.read_shift(1)>>>5&3,s=e.read_shift(2),n=e.read_shift(4);return[a,s,n]}function Qx(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var a=e.read_shift(2);return e.l+=12,[t,r,a]}function ed(e,t,r){var a=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var s=e.read_shift(r&&r.biff==2?1:2);return[a,s]}function rd(e,t,r){var a=e.read_shift(1)>>>5&3,s=e.read_shift(r&&r.biff==2?1:2);return[a,s]}function td(e,t,r){var a=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[a]}function ad(e,t,r){var a=(e[e.l++]&96)>>5,s=e.read_shift(2),n=4;if(r)switch(r.biff){case 5:n=15;break;case 12:n=6;break}return e.l+=n,[a,s]}var sd=rr,nd=rr,id=rr;function oa(e,t,r){return e.l+=2,[yx(e)]}function Ds(e){return e.l+=6,[]}var cd=oa,ld=Ds,od=Ds,fd=oa;function F0(e){return e.l+=2,[Be(e),e.read_shift(2)&1]}var hd=oa,ud=F0,xd=Ds,dd=oa,pd=oa,md=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function gd(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),s=e.read_shift(2),n=e.read_shift(2),i=md[r>>2&31];return{ixti:t,coltype:r&3,rt:i,idx:a,c:s,C:n}}function vd(e){return e.l+=2,[e.read_shift(4)]}function yd(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function wd(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function Td(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function _d(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function kd(e){return e.l+=4,[0,0]}var Bn={1:{n:"PtgExp",f:Hx},2:{n:"PtgTbl",f:id},3:{n:"PtgAdd",f:Me},4:{n:"PtgSub",f:Me},5:{n:"PtgMul",f:Me},6:{n:"PtgDiv",f:Me},7:{n:"PtgPower",f:Me},8:{n:"PtgConcat",f:Me},9:{n:"PtgLt",f:Me},10:{n:"PtgLe",f:Me},11:{n:"PtgEq",f:Me},12:{n:"PtgGe",f:Me},13:{n:"PtgGt",f:Me},14:{n:"PtgNe",f:Me},15:{n:"PtgIsect",f:Me},16:{n:"PtgUnion",f:Me},17:{n:"PtgRange",f:Me},18:{n:"PtgUplus",f:Me},19:{n:"PtgUminus",f:Me},20:{n:"PtgPercent",f:Me},21:{n:"PtgParen",f:Me},22:{n:"PtgMissArg",f:Me},23:{n:"PtgStr",f:Yx},26:{n:"PtgSheet",f:yd},27:{n:"PtgEndSheet",f:wd},28:{n:"PtgErr",f:Gx},29:{n:"PtgBool",f:$x},30:{n:"PtgInt",f:Wx},31:{n:"PtgNum",f:zx},32:{n:"PtgArray",f:Sx},33:{n:"PtgFunc",f:Lx},34:{n:"PtgFuncVar",f:Bx},35:{n:"PtgName",f:Jx},36:{n:"PtgRef",f:Px},37:{n:"PtgArea",f:_x},38:{n:"PtgMemArea",f:ed},39:{n:"PtgMemErr",f:sd},40:{n:"PtgMemNoMem",f:nd},41:{n:"PtgMemFunc",f:rd},42:{n:"PtgRefErr",f:td},43:{n:"PtgAreaErr",f:Ex},44:{n:"PtgRefN",f:jx},45:{n:"PtgAreaN",f:Ax},46:{n:"PtgMemAreaN",f:Td},47:{n:"PtgMemNoMemN",f:_d},57:{n:"PtgNameX",f:Zx},58:{n:"PtgRef3d",f:Mx},59:{n:"PtgArea3d",f:kx},60:{n:"PtgRefErr3d",f:ad},61:{n:"PtgAreaErr3d",f:bx},255:{}},Ed={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},bd={1:{n:"PtgElfLel",f:F0},2:{n:"PtgElfRw",f:dd},3:{n:"PtgElfCol",f:cd},6:{n:"PtgElfRwV",f:pd},7:{n:"PtgElfColV",f:fd},10:{n:"PtgElfRadical",f:hd},11:{n:"PtgElfRadicalS",f:xd},13:{n:"PtgElfColS",f:ld},15:{n:"PtgElfColSV",f:od},16:{n:"PtgElfRadicalLel",f:ud},25:{n:"PtgList",f:gd},29:{n:"PtgSxName",f:vd},255:{}},Ad={0:{n:"PtgAttrNoop",f:kd},1:{n:"PtgAttrSemi",f:Dx},2:{n:"PtgAttrIf",f:Nx},4:{n:"PtgAttrChoose",f:Fx},8:{n:"PtgAttrGoto",f:Cx},16:{n:"PtgAttrSum",f:Vx},32:{n:"PtgAttrBaxcel",f:Ln},33:{n:"PtgAttrBaxcel",f:Ln},64:{n:"PtgAttrSpace",f:Ix},65:{n:"PtgAttrSpaceSemi",f:Ox},128:{n:"PtgAttrIfError",f:Rx},255:{}};function fa(e,t,r,a){if(a.biff<8)return rr(e,t);for(var s=e.l+t,n=[],i=0;i!==r.length;++i)switch(r[i][0]){case"PtgArray":r[i][1]=qx(e,0,a),n.push(r[i][1]);break;case"PtgMemArea":r[i][2]=Kx(e,r[i][1],a),n.push(r[i][2]);break;case"PtgExp":a&&a.biff==12&&(r[i][1][1]=e.read_shift(4),n.push(r[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[i][0]}return t=s-e.l,t!==0&&n.push(rr(e,t)),n}function ha(e,t,r){for(var a=e.l+t,s,n,i=[];a!=e.l;)t=a-e.l,n=e[e.l],s=Bn[n]||Bn[Ed[n]],(n===24||n===25)&&(s=(n===24?bd:Ad)[e[e.l+1]]),!s||!s.f?rr(e,t):i.push([s.n,s.f(e,t,r)]);return i}function Sd(e){for(var t=[],r=0;r<e.length;++r){for(var a=e[r],s=[],n=0;n<a.length;++n){var i=a[n];if(i)switch(i[0]){case 2:s.push('"'+i[1].replace(/"/g,'""')+'"');break;default:s.push(i[1])}else s.push("")}t.push(s.join(","))}return t.join(";")}var Fd={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Cd(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function C0(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var a=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!a)return"SH33TJSERR1";var s="";if(r.biff>8)switch(e[a[0]][0]){case 357:return s=a[1]==-1?"#REF":e.SheetNames[a[1]],a[1]==a[2]?s:s+":"+e.SheetNames[a[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[a[0]][0];case 355:default:return"SH33TJSSRC"+e[a[0]][0]}switch(e[a[0]][0][0]){case 1025:return s=a[1]==-1?"#REF":e.SheetNames[a[1]]||"SH33TJSERR3",a[1]==a[2]?s:s+":"+e.SheetNames[a[2]];case 14849:return e[a[0]].slice(1).map(function(n){return n.Name}).join(";;");default:return e[a[0]][0][3]?(s=a[1]==-1?"#REF":e[a[0]][0][3][a[1]]||"SH33TJSERR4",a[1]==a[2]?s:s+":"+e[a[0]][0][3][a[2]]):"SH33TJSERR2"}}function Un(e,t,r){var a=C0(e,t,r);return a=="#REF"?a:Cd(a,r)}function Je(e,t,r,a,s){var n=s&&s.biff||8,i={s:{c:0,r:0},e:{c:0,r:0}},c=[],h,f,o,x=0,d=0,p,m="";if(!e[0]||!e[0][0])return"";for(var u=-1,g="",_=0,F=e[0].length;_<F;++_){var y=e[0][_];switch(y[0]){case"PtgUminus":c.push("-"+c.pop());break;case"PtgUplus":c.push("+"+c.pop());break;case"PtgPercent":c.push(c.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(h=c.pop(),f=c.pop(),u>=0){switch(e[0][u][1][0]){case 0:g=Re(" ",e[0][u][1][1]);break;case 1:g=Re("\r",e[0][u][1][1]);break;default:if(g="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][u][1][0])}f=f+g,u=-1}c.push(f+Fd[y[0]]+h);break;case"PtgIsect":h=c.pop(),f=c.pop(),c.push(f+" "+h);break;case"PtgUnion":h=c.pop(),f=c.pop(),c.push(f+","+h);break;case"PtgRange":h=c.pop(),f=c.pop(),c.push(f+":"+h);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":o=Gt(y[1][1],i,s),c.push(Wt(o,n));break;case"PtgRefN":o=r?Gt(y[1][1],r,s):y[1][1],c.push(Wt(o,n));break;case"PtgRef3d":x=y[1][1],o=Gt(y[1][2],i,s),m=Un(a,x,s),c.push(m+"!"+Wt(o,n));break;case"PtgFunc":case"PtgFuncVar":var E=y[1][0],D=y[1][1];E||(E=0),E&=127;var R=E==0?[]:c.slice(-E);c.length-=E,D==="User"&&(D=R.shift()),c.push(D+"("+R.join(",")+")");break;case"PtgBool":c.push(y[1]?"TRUE":"FALSE");break;case"PtgInt":c.push(y[1]);break;case"PtgNum":c.push(String(y[1]));break;case"PtgStr":c.push('"'+y[1].replace(/"/g,'""')+'"');break;case"PtgErr":c.push(y[1]);break;case"PtgAreaN":p=wn(y[1][1],r?{s:r}:i,s),c.push(Ga(p,s));break;case"PtgArea":p=wn(y[1][1],i,s),c.push(Ga(p,s));break;case"PtgArea3d":x=y[1][1],p=y[1][2],m=Un(a,x,s),c.push(m+"!"+Ga(p,s));break;case"PtgAttrSum":c.push("SUM("+c.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":d=y[1][2];var T=(a.names||[])[d-1]||(a[0]||[])[d],M=T?T.Name:"SH33TJSNAME"+String(d);M&&M.slice(0,6)=="_xlfn."&&!s.xlfn&&(M=M.slice(6)),c.push(M);break;case"PtgNameX":var I=y[1][1];d=y[1][2];var V;if(s.biff<=5)I<0&&(I=-I),a[I]&&(V=a[I][d]);else{var L="";if(((a[I]||[])[0]||[])[0]==14849||(((a[I]||[])[0]||[])[0]==1025?a[I][d]&&a[I][d].itab>0&&(L=a.SheetNames[a[I][d].itab-1]+"!"):L=a.SheetNames[d-1]+"!"),a[I]&&a[I][d])L+=a[I][d].Name;else if(a[0]&&a[0][d])L+=a[0][d].Name;else{var P=(C0(a,I,s)||"").split(";;");P[d-1]?L=P[d-1]:L+="SH33TJSERRX"}c.push(L);break}V||(V={Name:"SH33TJSERRY"}),c.push(V.Name);break;case"PtgParen":var J="(",Y=")";if(u>=0){switch(g="",e[0][u][1][0]){case 2:J=Re(" ",e[0][u][1][1])+J;break;case 3:J=Re("\r",e[0][u][1][1])+J;break;case 4:Y=Re(" ",e[0][u][1][1])+Y;break;case 5:Y=Re("\r",e[0][u][1][1])+Y;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][u][1][0])}u=-1}c.push(J+c.pop()+Y);break;case"PtgRefErr":c.push("#REF!");break;case"PtgRefErr3d":c.push("#REF!");break;case"PtgExp":o={c:y[1][1],r:y[1][0]};var X={c:r.c,r:r.r};if(a.sharedf[de(o)]){var re=a.sharedf[de(o)];c.push(Je(re,i,X,a,s))}else{var ne=!1;for(h=0;h!=a.arrayf.length;++h)if(f=a.arrayf[h],!(o.c<f[0].s.c||o.c>f[0].e.c)&&!(o.r<f[0].s.r||o.r>f[0].e.r)){c.push(Je(f[1],i,X,a,s)),ne=!0;break}ne||c.push(y[1])}break;case"PtgArray":c.push("{"+Sd(y[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":u=_;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":c.push("");break;case"PtgAreaErr":c.push("#REF!");break;case"PtgAreaErr3d":c.push("#REF!");break;case"PtgList":c.push("Table"+y[1].idx+"[#"+y[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(y));default:throw new Error("Unrecognized Formula Token: "+String(y))}var be=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&u>=0&&be.indexOf(e[0][_][0])==-1){y=e[0][u];var z=!0;switch(y[1][0]){case 4:z=!1;case 0:g=Re(" ",y[1][1]);break;case 5:z=!1;case 1:g=Re("\r",y[1][1]);break;default:if(g="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+y[1][0])}c.push((z?g:"")+c.pop()+(z?"":g)),u=-1}}if(c.length>1&&s.WTF)throw new Error("bad formula stack");return c[0]}function Nd(e,t,r){var a=e.l+t,s=r.biff==2?1:2,n,i=e.read_shift(s);if(i==65535)return[[],rr(e,t-2)];var c=ha(e,i,r);return t!==i+s&&(n=fa(e,t-i-s,c,r)),e.l=a,[c,n]}function Rd(e,t,r){var a=e.l+t,s=r.biff==2?1:2,n,i=e.read_shift(s);if(i==65535)return[[],rr(e,t-2)];var c=ha(e,i,r);return t!==i+s&&(n=fa(e,t-i-s,c,r)),e.l=a,[c,n]}function Dd(e,t,r,a){var s=e.l+t,n=ha(e,a,r),i;return s!==e.l&&(i=fa(e,s-e.l,n,r)),[n,i]}function Id(e,t,r){var a=e.l+t,s,n=e.read_shift(2),i=ha(e,n,r);return n==65535?[[],rr(e,t-2)]:(t!==n+2&&(s=fa(e,a-n-2,i,r)),[i,s])}function Od(e){var t;if(Br(e,e.l+6)!==65535)return[Ze(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function za(e,t,r){var a=e.l+t,s=Pr(e);r.biff==2&&++e.l;var n=Od(e),i=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var c=Rd(e,a-e.l,r);return{cell:s,val:n[0],formula:c,shared:i>>3&1,tt:n[1]}}function Ma(e,t,r){var a=e.read_shift(4),s=ha(e,a,r),n=e.read_shift(4),i=n>0?fa(e,n,s,r):null;return[s,i]}var Pd=Ma,La=Ma,jd=Ma,Md=Ma,Ld={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},N0={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Bd={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Vn(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function Ya(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var Xt={},bt={};function Kt(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function R0(e,t,r,a,s,n){try{a.cellNF&&(e.z=me[t])}catch(c){if(a.WTF)throw c}if(!(e.t==="z"&&!a.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=$e(e.v)),(!a||a.cellText!==!1)&&e.t!=="z")try{if(me[t]==null&&lt(Bl[t]||"General",t),e.t==="e")e.w=e.w||gt[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Zt(e.v);else if(e.t==="d"){var i=lr(e.v);(i|0)===i?e.w=i.toString(10):e.w=Zt(i)}else{if(e.v===void 0)return"";e.w=ft(e.v,bt)}else e.t==="d"?e.w=yr(t,lr(e.v),bt):e.w=yr(t,e.v,bt)}catch(c){if(a.WTF)throw c}if(a.cellStyles&&r!=null)try{e.s=n.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Na(s.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),a.WTF&&(e.s.fgColor.raw_rgb=s.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Na(s.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),a.WTF&&(e.s.bgColor.raw_rgb=s.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(c){if(a.WTF&&n.Fills)throw c}}}function Ud(e,t){var r=De(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Te(r))}var Vd=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,Hd=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,Gd=/<(?:\w:)?hyperlink [^>]*>/mg,Wd=/"(\w*:\w*)"/,$d=/<(?:\w:)?col\b[^>]*[\/]?>/g,zd=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,Yd=/<(?:\w:)?pageMargins[^>]*\/>/g,D0=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,Xd=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,Kd=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function qd(e,t,r,a,s,n,i){if(!e)return e;a||(a={"!id":{}});var c=t.dense?[]:{},h={s:{r:2e6,c:2e6},e:{r:0,c:0}},f="",o="",x=e.match(Hd);x?(f=e.slice(0,x.index),o=e.slice(x.index+x[0].length)):f=o=e;var d=f.match(D0);d?Is(d[0],c,s,r):(d=f.match(Xd))&&Jd(d[0],d[1]||"",c,s,r);var p=(f.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(p>0){var m=f.slice(p,p+50).match(Wd);m&&Ud(c,m[1])}var u=f.match(Kd);u&&u[1]&&a1(u[1],s);var g=[];if(t.cellStyles){var _=f.match($d);_&&e1(g,_)}x&&s1(x[1],c,t,h,n,i);var F=o.match(zd);F&&(c["!autofilter"]=r1(F[0]));var y=[],E=o.match(Vd);if(E)for(p=0;p!=E.length;++p)y[p]=De(E[p].slice(E[p].indexOf('"')+1));var D=o.match(Gd);D&&Zd(c,D,a);var R=o.match(Yd);if(R&&(c["!margins"]=Qd(he(R[0]))),!c["!ref"]&&h.e.c>=h.s.c&&h.e.r>=h.s.r&&(c["!ref"]=Te(h)),t.sheetRows>0&&c["!ref"]){var T=De(c["!ref"]);t.sheetRows<=+T.e.r&&(T.e.r=t.sheetRows-1,T.e.r>h.e.r&&(T.e.r=h.e.r),T.e.r<T.s.r&&(T.s.r=T.e.r),T.e.c>h.e.c&&(T.e.c=h.e.c),T.e.c<T.s.c&&(T.s.c=T.e.c),c["!fullref"]=c["!ref"],c["!ref"]=Te(T))}return g.length>0&&(c["!cols"]=g),y.length>0&&(c["!merges"]=y),c}function Is(e,t,r,a){var s=he(e);r.Sheets[a]||(r.Sheets[a]={}),s.codeName&&(r.Sheets[a].CodeName=ke(Se(s.codeName)))}function Jd(e,t,r,a,s){Is(e.slice(0,e.indexOf(">")),r,a,s)}function Zd(e,t,r){for(var a=Array.isArray(e),s=0;s!=t.length;++s){var n=he(Se(t[s]),!0);if(!n.ref)return;var i=((r||{})["!id"]||[])[n.id];i?(n.Target=i.Target,n.location&&(n.Target+="#"+ke(n.location))):(n.Target="#"+ke(n.location),i={Target:n.Target,TargetMode:"Internal"}),n.Rel=i,n.tooltip&&(n.Tooltip=n.tooltip,delete n.tooltip);for(var c=De(n.ref),h=c.s.r;h<=c.e.r;++h)for(var f=c.s.c;f<=c.e.c;++f){var o=de({c:f,r:h});a?(e[h]||(e[h]=[]),e[h][f]||(e[h][f]={t:"z",v:void 0}),e[h][f].l=n):(e[o]||(e[o]={t:"z",v:void 0}),e[o].l=n)}}}function Qd(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function e1(e,t){for(var r=!1,a=0;a!=t.length;++a){var s=he(t[a],!0);s.hidden&&(s.hidden=Fe(s.hidden));var n=parseInt(s.min,10)-1,i=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,Rs(s.width)),Ct(s);n<=i;)e[n++]=Ye(s)}}function r1(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}var t1=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function a1(e,t){t.Views||(t.Views=[{}]),(e.match(t1)||[]).forEach(function(r,a){var s=he(r);t.Views[a]||(t.Views[a]={}),+s.zoomScale&&(t.Views[a].zoom=+s.zoomScale),Fe(s.rightToLeft)&&(t.Views[a].RTL=!0)})}var s1=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,a=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,n=Qt("v"),i=Qt("f");return function(h,f,o,x,d,p){for(var m=0,u="",g=[],_=[],F=0,y=0,E=0,D="",R,T,M=0,I=0,V,L,P=0,J=0,Y=Array.isArray(p.CellXf),X,re=[],ne=[],be=Array.isArray(f),z=[],ue={},xe=!1,C=!!o.sheetStubs,G=h.split(t),j=0,O=G.length;j!=O;++j){u=G[j].trim();var q=u.length;if(q!==0){var se=0;e:for(m=0;m<q;++m)switch(u[m]){case">":if(u[m-1]!="/"){++m;break e}if(o&&o.cellStyles){if(T=he(u.slice(se,m),!0),M=T.r!=null?parseInt(T.r,10):M+1,I=-1,o.sheetRows&&o.sheetRows<M)continue;ue={},xe=!1,T.ht&&(xe=!0,ue.hpt=parseFloat(T.ht),ue.hpx=aa(ue.hpt)),T.hidden=="1"&&(xe=!0,ue.hidden=!0),T.outlineLevel!=null&&(xe=!0,ue.level=+T.outlineLevel),xe&&(z[M-1]=ue)}break;case"<":se=m;break}if(se>=m)break;if(T=he(u.slice(se,m),!0),M=T.r!=null?parseInt(T.r,10):M+1,I=-1,!(o.sheetRows&&o.sheetRows<M)){x.s.r>M-1&&(x.s.r=M-1),x.e.r<M-1&&(x.e.r=M-1),o&&o.cellStyles&&(ue={},xe=!1,T.ht&&(xe=!0,ue.hpt=parseFloat(T.ht),ue.hpx=aa(ue.hpt)),T.hidden=="1"&&(xe=!0,ue.hidden=!0),T.outlineLevel!=null&&(xe=!0,ue.level=+T.outlineLevel),xe&&(z[M-1]=ue)),g=u.slice(m).split(e);for(var le=0;le!=g.length&&g[le].trim().charAt(0)=="<";++le);for(g=g.slice(le),m=0;m!=g.length;++m)if(u=g[m].trim(),u.length!==0){if(_=u.match(r),F=m,y=0,E=0,u="<c "+(u.slice(0,1)=="<"?">":"")+u,_!=null&&_.length===2){for(F=0,D=_[1],y=0;y!=D.length&&!((E=D.charCodeAt(y)-64)<1||E>26);++y)F=26*F+E;--F,I=F}else++I;for(y=0;y!=u.length&&u.charCodeAt(y)!==62;++y);if(++y,T=he(u.slice(0,y),!0),T.r||(T.r=de({r:M-1,c:I})),D=u.slice(y),R={t:""},(_=D.match(n))!=null&&_[1]!==""&&(R.v=ke(_[1])),o.cellFormula){if((_=D.match(i))!=null&&_[1]!==""){if(R.f=ke(Se(_[1])).replace(/\r\n/g,`
`),o.xlfn||(R.f=Mn(R.f)),_[0].indexOf('t="array"')>-1)R.F=(D.match(s)||[])[1],R.F.indexOf(":")>-1&&re.push([De(R.F),R.F]);else if(_[0].indexOf('t="shared"')>-1){L=he(_[0]);var te=ke(Se(_[1]));o.xlfn||(te=Mn(te)),ne[parseInt(L.si,10)]=[L,te,T.r]}}else(_=D.match(/<f[^>]*\/>/))&&(L=he(_[0]),ne[L.si]&&(R.f=px(ne[L.si][1],ne[L.si][2],T.r)));var Q=ir(T.r);for(y=0;y<re.length;++y)Q.r>=re[y][0].s.r&&Q.r<=re[y][0].e.r&&Q.c>=re[y][0].s.c&&Q.c<=re[y][0].e.c&&(R.F=re[y][1])}if(T.t==null&&R.v===void 0)if(R.f||R.F)R.v=0,R.t="n";else if(C)R.t="z";else continue;else R.t=T.t||"n";switch(x.s.c>I&&(x.s.c=I),x.e.c<I&&(x.e.c=I),R.t){case"n":if(R.v==""||R.v==null){if(!C)continue;R.t="z"}else R.v=parseFloat(R.v);break;case"s":if(typeof R.v>"u"){if(!C)continue;R.t="z"}else V=Xt[parseInt(R.v,10)],R.v=V.t,R.r=V.r,o.cellHTML&&(R.h=V.h);break;case"str":R.t="s",R.v=R.v!=null?Se(R.v):"",o.cellHTML&&(R.h=ws(R.v));break;case"inlineStr":_=D.match(a),R.t="s",_!=null&&(V=Ns(_[1]))?(R.v=V.t,o.cellHTML&&(R.h=V.h)):R.v="";break;case"b":R.v=Fe(R.v);break;case"d":o.cellDates?R.v=$e(R.v,1):(R.v=lr($e(R.v,1)),R.t="n");break;case"e":(!o||o.cellText!==!1)&&(R.w=R.v),R.v=Qi[R.v];break}if(P=J=0,X=null,Y&&T.s!==void 0&&(X=p.CellXf[T.s],X!=null&&(X.numFmtId!=null&&(P=X.numFmtId),o.cellStyles&&X.fillId!=null&&(J=X.fillId))),R0(R,P,J,o,d,p),o.cellDates&&Y&&R.t=="n"&&Nt(me[P])&&(R.t="d",R.v=Pa(R.v)),T.cm&&o.xlmeta){var _e=(o.xlmeta.Cell||[])[+T.cm-1];_e&&_e.type=="XLDAPR"&&(R.D=!0)}if(be){var N=ir(T.r);f[N.r]||(f[N.r]=[]),f[N.r][N.c]=R}else f[T.r]=R}}}}z.length>0&&(f["!rows"]=z)}}();function n1(e,t){var r={},a=e.l+t;r.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var n=e.read_shift(1);return e.l=a,n&7&&(r.level=n&7),n&16&&(r.hidden=!0),n&32&&(r.hpt=s/20),r}var i1=mt;function c1(){}function l1(e,t){var r={},a=e[e.l];return++e.l,r.above=!(a&64),r.left=!(a&128),e.l+=18,r.name=Co(e),r}function o1(e){var t=wr(e);return[t]}function f1(e){var t=pt(e);return[t]}function h1(e){var t=wr(e),r=e.read_shift(1);return[t,r,"b"]}function u1(e){var t=pt(e),r=e.read_shift(1);return[t,r,"b"]}function x1(e){var t=wr(e),r=e.read_shift(1);return[t,r,"e"]}function d1(e){var t=pt(e),r=e.read_shift(1);return[t,r,"e"]}function p1(e){var t=wr(e),r=e.read_shift(4);return[t,r,"s"]}function m1(e){var t=pt(e),r=e.read_shift(4);return[t,r,"s"]}function g1(e){var t=wr(e),r=Ze(e);return[t,r,"n"]}function I0(e){var t=pt(e),r=Ze(e);return[t,r,"n"]}function v1(e){var t=wr(e),r=Ss(e);return[t,r,"n"]}function y1(e){var t=pt(e),r=Ss(e);return[t,r,"n"]}function w1(e){var t=wr(e),r=bs(e);return[t,r,"is"]}function T1(e){var t=wr(e),r=er(e);return[t,r,"str"]}function _1(e){var t=pt(e),r=er(e);return[t,r,"str"]}function k1(e,t,r){var a=e.l+t,s=wr(e);s.r=r["!row"];var n=e.read_shift(1),i=[s,n,"b"];if(r.cellFormula){e.l+=2;var c=La(e,a-e.l,r);i[3]=Je(c,null,s,r.supbooks,r)}else e.l=a;return i}function E1(e,t,r){var a=e.l+t,s=wr(e);s.r=r["!row"];var n=e.read_shift(1),i=[s,n,"e"];if(r.cellFormula){e.l+=2;var c=La(e,a-e.l,r);i[3]=Je(c,null,s,r.supbooks,r)}else e.l=a;return i}function b1(e,t,r){var a=e.l+t,s=wr(e);s.r=r["!row"];var n=Ze(e),i=[s,n,"n"];if(r.cellFormula){e.l+=2;var c=La(e,a-e.l,r);i[3]=Je(c,null,s,r.supbooks,r)}else e.l=a;return i}function A1(e,t,r){var a=e.l+t,s=wr(e);s.r=r["!row"];var n=er(e),i=[s,n,"str"];if(r.cellFormula){e.l+=2;var c=La(e,a-e.l,r);i[3]=Je(c,null,s,r.supbooks,r)}else e.l=a;return i}var S1=mt;function F1(e,t){var r=e.l+t,a=mt(e),s=As(e),n=er(e),i=er(e),c=er(e);e.l=r;var h={rfx:a,relId:s,loc:n,display:c};return i&&(h.Tooltip=i),h}function C1(){}function N1(e,t,r){var a=e.l+t,s=qi(e),n=e.read_shift(1),i=[s];if(i[2]=n,r.cellFormula){var c=Pd(e,a-e.l,r);i[1]=c}else e.l=a;return i}function R1(e,t,r){var a=e.l+t,s=mt(e),n=[s];if(r.cellFormula){var i=Md(e,a-e.l,r);n[1]=i,e.l=a}else e.l=a;return n}var D1=["left","right","top","bottom","header","footer"];function I1(e){var t={};return D1.forEach(function(r){t[r]=Ze(e)}),t}function O1(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function P1(){}function j1(){}function M1(e,t,r,a,s,n,i){if(!e)return e;var c=t||{};a||(a={"!id":{}});var h=c.dense?[]:{},f,o={s:{r:2e6,c:2e6},e:{r:0,c:0}},x=!1,d=!1,p,m,u,g,_,F,y,E,D,R=[];c.biff=12,c["!row"]=0;var T=0,M=!1,I=[],V={},L=c.supbooks||s.supbooks||[[]];if(L.sharedf=V,L.arrayf=I,L.SheetNames=s.SheetNames||s.Sheets.map(function(be){return be.name}),!c.supbooks&&(c.supbooks=L,s.Names))for(var P=0;P<s.Names.length;++P)L[0][P+1]=s.Names[P];var J=[],Y=[],X=!1;Ia[16]={n:"BrtShortReal",f:I0};var re;if($r(e,function(z,ue,xe){if(!d)switch(xe){case 148:f=z;break;case 0:p=z,c.sheetRows&&c.sheetRows<=p.r&&(d=!0),E=Xe(g=p.r),c["!row"]=p.r,(z.hidden||z.hpt||z.level!=null)&&(z.hpt&&(z.hpx=aa(z.hpt)),Y[z.r]=z);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(m={t:z[2]},z[2]){case"n":m.v=z[1];break;case"s":y=Xt[z[1]],m.v=y.t,m.r=y.r;break;case"b":m.v=!!z[1];break;case"e":m.v=z[1],c.cellText!==!1&&(m.w=gt[m.v]);break;case"str":m.t="s",m.v=z[1];break;case"is":m.t="s",m.v=z[1].t;break}if((u=i.CellXf[z[0].iStyleRef])&&R0(m,u.numFmtId,null,c,n,i),_=z[0].c==-1?_+1:z[0].c,c.dense?(h[g]||(h[g]=[]),h[g][_]=m):h[He(_)+E]=m,c.cellFormula){for(M=!1,T=0;T<I.length;++T){var C=I[T];p.r>=C[0].s.r&&p.r<=C[0].e.r&&_>=C[0].s.c&&_<=C[0].e.c&&(m.F=Te(C[0]),M=!0)}!M&&z.length>3&&(m.f=z[3])}if(o.s.r>p.r&&(o.s.r=p.r),o.s.c>_&&(o.s.c=_),o.e.r<p.r&&(o.e.r=p.r),o.e.c<_&&(o.e.c=_),c.cellDates&&u&&m.t=="n"&&Nt(me[u.numFmtId])){var G=it(m.v);G&&(m.t="d",m.v=new Date(G.y,G.m-1,G.d,G.H,G.M,G.S,G.u))}re&&(re.type=="XLDAPR"&&(m.D=!0),re=void 0);break;case 1:case 12:if(!c.sheetStubs||x)break;m={t:"z",v:void 0},_=z[0].c==-1?_+1:z[0].c,c.dense?(h[g]||(h[g]=[]),h[g][_]=m):h[He(_)+E]=m,o.s.r>p.r&&(o.s.r=p.r),o.s.c>_&&(o.s.c=_),o.e.r<p.r&&(o.e.r=p.r),o.e.c<_&&(o.e.c=_),re&&(re.type=="XLDAPR"&&(m.D=!0),re=void 0);break;case 176:R.push(z);break;case 49:re=((c.xlmeta||{}).Cell||[])[z-1];break;case 494:var j=a["!id"][z.relId];for(j?(z.Target=j.Target,z.loc&&(z.Target+="#"+z.loc),z.Rel=j):z.relId==""&&(z.Target="#"+z.loc),g=z.rfx.s.r;g<=z.rfx.e.r;++g)for(_=z.rfx.s.c;_<=z.rfx.e.c;++_)c.dense?(h[g]||(h[g]=[]),h[g][_]||(h[g][_]={t:"z",v:void 0}),h[g][_].l=z):(F=de({c:_,r:g}),h[F]||(h[F]={t:"z",v:void 0}),h[F].l=z);break;case 426:if(!c.cellFormula)break;I.push(z),D=c.dense?h[g][_]:h[He(_)+E],D.f=Je(z[1],o,{r:p.r,c:_},L,c),D.F=Te(z[0]);break;case 427:if(!c.cellFormula)break;V[de(z[0].s)]=z[1],D=c.dense?h[g][_]:h[He(_)+E],D.f=Je(z[1],o,{r:p.r,c:_},L,c);break;case 60:if(!c.cellStyles)break;for(;z.e>=z.s;)J[z.e--]={width:z.w/256,hidden:!!(z.flags&1),level:z.level},X||(X=!0,Rs(z.w/256)),Ct(J[z.e+1]);break;case 161:h["!autofilter"]={ref:Te(z)};break;case 476:h["!margins"]=z;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),z.name&&(s.Sheets[r].CodeName=z.name),(z.above||z.left)&&(h["!outline"]={above:z.above,left:z.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),z.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:x=!0;break;case 36:x=!1;break;case 37:x=!0;break;case 38:x=!1;break;default:if(!ue.T){if(!x||c.WTF)throw new Error("Unexpected record 0x"+xe.toString(16))}}},c),delete c.supbooks,delete c["!row"],!h["!ref"]&&(o.s.r<2e6||f&&(f.e.r>0||f.e.c>0||f.s.r>0||f.s.c>0))&&(h["!ref"]=Te(f||o)),c.sheetRows&&h["!ref"]){var ne=De(h["!ref"]);c.sheetRows<=+ne.e.r&&(ne.e.r=c.sheetRows-1,ne.e.r>o.e.r&&(ne.e.r=o.e.r),ne.e.r<ne.s.r&&(ne.s.r=ne.e.r),ne.e.c>o.e.c&&(ne.e.c=o.e.c),ne.e.c<ne.s.c&&(ne.s.c=ne.e.c),h["!fullref"]=h["!ref"],h["!ref"]=Te(ne))}return R.length>0&&(h["!merges"]=R),J.length>0&&(h["!cols"]=J),Y.length>0&&(h["!rows"]=Y),h}function L1(e){var t=[],r=e.match(/^<c:numCache>/),a;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(n){var i=n.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);i&&(t[+i[1]]=r?+i[2]:i[2])});var s=ke((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(n){a=n.replace(/<.*?>/g,"")}),[t,s,a]}function B1(e,t,r,a,s,n){var i=n||{"!type":"chart"};if(!e)return n;var c=0,h=0,f="A",o={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(x){var d=L1(x);o.s.r=o.s.c=0,o.e.c=c,f=He(c),d[0].forEach(function(p,m){i[f+Xe(m)]={t:"n",v:p,z:d[1]},h=m}),o.e.r<h&&(o.e.r=h),++c}),c>0&&(i["!ref"]=Te(o)),i}function U1(e,t,r,a,s){if(!e)return e;a||(a={"!id":{}});var n={"!type":"chart","!drawel":null,"!rel":""},i,c=e.match(D0);return c&&Is(c[0],n,s,r),(i=e.match(/drawing r:id="(.*?)"/))&&(n["!rel"]=i[1]),a["!id"][n["!rel"]]&&(n["!drawel"]=a["!id"][n["!rel"]]),n}function V1(e,t){e.l+=10;var r=er(e);return{name:r}}function H1(e,t,r,a,s){if(!e)return e;a||(a={"!id":{}});var n={"!type":"chart","!drawel":null,"!rel":""},i=!1;return $r(e,function(h,f,o){switch(o){case 550:n["!rel"]=h;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),h.name&&(s.Sheets[r].CodeName=h.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!(f.T>0)){if(!(f.T<0)){if(!i||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}}},t),a["!id"][n["!rel"]]&&(n["!drawel"]=a["!id"][n["!rel"]]),n}var O0=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],G1=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],W1=[],$1=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Hn(e,t){for(var r=0;r!=e.length;++r)for(var a=e[r],s=0;s!=t.length;++s){var n=t[s];if(a[n[0]]==null)a[n[0]]=n[1];else switch(n[2]){case"bool":typeof a[n[0]]=="string"&&(a[n[0]]=Fe(a[n[0]]));break;case"int":typeof a[n[0]]=="string"&&(a[n[0]]=parseInt(a[n[0]],10));break}}}function Gn(e,t){for(var r=0;r!=t.length;++r){var a=t[r];if(e[a[0]]==null)e[a[0]]=a[1];else switch(a[2]){case"bool":typeof e[a[0]]=="string"&&(e[a[0]]=Fe(e[a[0]]));break;case"int":typeof e[a[0]]=="string"&&(e[a[0]]=parseInt(e[a[0]],10));break}}}function P0(e){Gn(e.WBProps,O0),Gn(e.CalcPr,$1),Hn(e.WBView,G1),Hn(e.Sheets,W1),bt.date1904=Fe(e.WBProps.date1904)}var z1="][*?/\\".split("");function Y1(e,t){if(e.length>31){if(t)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var r=!0;return z1.forEach(function(a){if(e.indexOf(a)!=-1){if(!t)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");r=!1}}),r}var X1=/<\w+:workbook/;function K1(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},a=!1,s="xmlns",n={},i=0;if(e.replace(tr,function(h,f){var o=he(h);switch(Or(o[0])){case"<?xml":break;case"<workbook":h.match(X1)&&(s="xmlns"+h.match(/<(\w+):/)[1]),r.xmlns=o[s];break;case"</workbook>":break;case"<fileVersion":delete o[0],r.AppVersion=o;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":O0.forEach(function(x){if(o[x[0]]!=null)switch(x[2]){case"bool":r.WBProps[x[0]]=Fe(o[x[0]]);break;case"int":r.WBProps[x[0]]=parseInt(o[x[0]],10);break;default:r.WBProps[x[0]]=o[x[0]]}}),o.codeName&&(r.WBProps.CodeName=Se(o.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete o[0],r.WBView.push(o);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(o.state){case"hidden":o.Hidden=1;break;case"veryHidden":o.Hidden=2;break;default:o.Hidden=0}delete o.state,o.name=ke(Se(o.name)),delete o[0],r.Sheets.push(o);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":a=!0;break;case"</definedNames>":a=!1;break;case"<definedName":n={},n.Name=Se(o.name),o.comment&&(n.Comment=o.comment),o.localSheetId&&(n.Sheet=+o.localSheetId),Fe(o.hidden||"0")&&(n.Hidden=!0),i=f+h.length;break;case"</definedName>":n.Ref=ke(Se(e.slice(i,f))),r.Names.push(n);break;case"<definedName/>":break;case"<calcPr":delete o[0],r.CalcPr=o;break;case"<calcPr/>":delete o[0],r.CalcPr=o;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":a=!0;break;case"</AlternateContent>":a=!1;break;case"<revisionPtr":break;default:if(!a&&t.WTF)throw new Error("unrecognized "+o[0]+" in workbook")}return h}),ho.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return P0(r),r}function q1(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=rs(e),r.name=er(e),r}function J1(e,t){var r={},a=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var s=t>8?er(e):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(a&65536),r.backupFile=!!(a&64),r.checkCompatibility=!!(a&4096),r.date1904=!!(a&1),r.filterPrivacy=!!(a&8),r.hidePivotFieldList=!!(a&1024),r.promptedSolutions=!!(a&16),r.publishItems=!!(a&2048),r.refreshAllConnections=!!(a&262144),r.saveExternalLinkValues=!!(a&128),r.showBorderUnselectedTables=!!(a&4),r.showInkAnnotation=!!(a&32),r.showObjects=["all","placeholders","none"][a>>13&3],r.showPivotChartFilter=!!(a&32768),r.updateLinks=["userSet","never","always"][a>>8&3],r}function Z1(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function Q1(e,t,r){var a=e.l+t;e.l+=4,e.l+=1;var s=e.read_shift(4),n=No(e),i=jd(e,0,r),c=As(e);e.l=a;var h={Name:n,Ptg:i};return s<268435455&&(h.Sheet=s),c&&(h.Comment=c),h}function ep(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},a=[],s=!1;t||(t={}),t.biff=12;var n=[],i=[[]];return i.SheetNames=[],i.XTI=[],Ia[16]={n:"BrtFRTArchID$",f:Z1},$r(e,function(h,f,o){switch(o){case 156:i.SheetNames.push(h.name),r.Sheets.push(h);break;case 153:r.WBProps=h;break;case 39:h.Sheet!=null&&(t.SID=h.Sheet),h.Ref=Je(h.Ptg,null,null,i,t),delete t.SID,delete h.Ptg,n.push(h);break;case 1036:break;case 357:case 358:case 355:case 667:i[0].length?i.push([o,h]):i[0]=[o,h],i[i.length-1].XTI=[];break;case 362:i.length===0&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(h),i.XTI=i.XTI.concat(h);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:a.push(o),s=!0;break;case 36:a.pop(),s=!1;break;case 37:a.push(o),s=!0;break;case 38:a.pop(),s=!1;break;case 16:break;default:if(!f.T){if(!s||t.WTF&&a[a.length-1]!=37&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+o.toString(16))}}},t),P0(r),r.Names=n,r.supbooks=i,r}function rp(e,t,r){return t.slice(-4)===".bin"?ep(e,r):K1(e,r)}function tp(e,t,r,a,s,n,i,c){return t.slice(-4)===".bin"?M1(e,a,r,s,n,i,c):qd(e,a,r,s,n,i,c)}function ap(e,t,r,a,s,n,i,c){return t.slice(-4)===".bin"?H1(e,a,r,s,n):U1(e,a,r,s,n)}function sp(e,t,r,a,s,n,i,c){return t.slice(-4)===".bin"?ux():xx()}function np(e,t,r,a,s,n,i,c){return t.slice(-4)===".bin"?fx():hx()}function ip(e,t,r,a){return t.slice(-4)===".bin"?Su(e,r,a):Tu(e,r,a)}function cp(e,t,r){return T0(e,r)}function lp(e,t,r){return t.slice(-4)===".bin"?Gh(e,r):Vh(e,r)}function op(e,t,r){return t.slice(-4)===".bin"?cx(e,r):tx(e,r)}function fp(e,t,r){return t.slice(-4)===".bin"?Qu(e):Ju(e)}function hp(e,t,r,a){return r.slice(-4)===".bin"?ex(e,t,r,a):void 0}function up(e,t,r){return t.slice(-4)===".bin"?Ku(e,t,r):qu(e,t,r)}var j0=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,M0=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Tr(e,t){var r=e.split(/\s+/),a=[];if(t||(a[0]=r[0]),r.length===1)return a;var s=e.match(j0),n,i,c,h;if(s)for(h=0;h!=s.length;++h)n=s[h].match(M0),(i=n[1].indexOf(":"))===-1?a[n[1]]=n[2].slice(1,n[2].length-1):(n[1].slice(0,6)==="xmlns:"?c="xmlns"+n[1].slice(6):c=n[1].slice(i+1),a[c]=n[2].slice(1,n[2].length-1));return a}function xp(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var a=e.match(j0),s,n,i,c;if(a)for(c=0;c!=a.length;++c)s=a[c].match(M0),(n=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?i="xmlns"+s[1].slice(6):i=s[1].slice(n+1),r[i]=s[2].slice(1,s[2].length-1));return r}var qt;function dp(e,t){var r=qt[e]||ke(e);return r==="General"?ft(t):yr(r,t)}function pp(e,t,r,a){var s=a;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=Fe(a);break;case"i2":case"int":s=parseInt(a,10);break;case"r4":case"float":s=parseFloat(a);break;case"date":case"dateTime.tz":s=$e(a);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[ke(t)]=s}function mp(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||gt[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Zt(e.v):e.w=ft(e.v):e.w=dp(t||"General",e.v)}catch(n){if(r.WTF)throw n}try{var a=qt[t]||t||"General";if(r.cellNF&&(e.z=a),r.cellDates&&e.t=="n"&&Nt(a)){var s=it(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(n){if(r.WTF)throw n}}}function gp(e,t,r){if(r.cellStyles&&t.Interior){var a=t.Interior;a.Pattern&&(a.patternType=pu[a.Pattern]||a.Pattern)}e[t.ID]=t}function vp(e,t,r,a,s,n,i,c,h,f){var o="General",x=a.StyleID,d={};f=f||{};var p=[],m=0;for(x===void 0&&c&&(x=c.StyleID),x===void 0&&i&&(x=i.StyleID);n[x]!==void 0&&(n[x].nf&&(o=n[x].nf),n[x].Interior&&p.push(n[x].Interior),!!n[x].Parent);)x=n[x].Parent;switch(r.Type){case"Boolean":a.t="b",a.v=Fe(e);break;case"String":a.t="s",a.r=hn(ke(e)),a.v=e.indexOf("<")>-1?ke(t||e).replace(/<.*?>/g,""):a.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),a.v=($e(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),a.v!==a.v?a.v=ke(e):a.v<60&&(a.v=a.v-1),(!o||o=="General")&&(o="yyyy-mm-dd");case"Number":a.v===void 0&&(a.v=+e),a.t||(a.t="n");break;case"Error":a.t="e",a.v=Qi[e],f.cellText!==!1&&(a.w=e);break;default:e==""&&t==""?a.t="z":(a.t="s",a.v=hn(t||e));break}if(mp(a,o,f),f.cellFormula!==!1)if(a.Formula){var u=ke(a.Formula);u.charCodeAt(0)==61&&(u=u.slice(1)),a.f=Et(u,s),delete a.Formula,a.ArrayRange=="RC"?a.F=Et("RC:RC",s):a.ArrayRange&&(a.F=Et(a.ArrayRange,s),h.push([De(a.F),a.F]))}else for(m=0;m<h.length;++m)s.r>=h[m][0].s.r&&s.r<=h[m][0].e.r&&s.c>=h[m][0].s.c&&s.c<=h[m][0].e.c&&(a.F=h[m][1]);f.cellStyles&&(p.forEach(function(g){!d.patternType&&g.patternType&&(d.patternType=g.patternType)}),a.s=d),a.StyleID!==void 0&&(a.ixfe=a.StyleID)}function yp(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Xa(e,t){var r=t||{};Ei();var a=Lt(Ts(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(a=Se(a));var s=a.slice(0,1024).toLowerCase(),n=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var i=Ye(r);return i.type="string",ra.to_workbook(a,i)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Oe){s.indexOf("<"+Oe)>=0&&(n=!0)}),n)return Fp(a,r);qt={"General Number":"General","General Date":me[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":me[15],"Short Date":me[14],"Long Time":me[19],"Medium Time":me[18],"Short Time":me[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:me[2],Standard:me[4],Percent:me[10],Scientific:me[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var c,h=[],f,o={},x=[],d=r.dense?[]:{},p="",m={},u={},g=Tr('<Data ss:Type="String">'),_=0,F=0,y=0,E={s:{r:2e6,c:2e6},e:{r:0,c:0}},D={},R={},T="",M=0,I=[],V={},L={},P=0,J=[],Y=[],X={},re=[],ne,be=!1,z=[],ue=[],xe={},C=0,G=0,j={Sheets:[],WBProps:{date1904:!1}},O={};ea.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"");for(var q="";c=ea.exec(a);)switch(c[3]=(q=c[3]).toLowerCase()){case"data":if(q=="data"){if(c[1]==="/"){if((f=h.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&h.push([c[3],!0]);break}if(h[h.length-1][1])break;c[1]==="/"?vp(a.slice(_,c.index),T,g,h[h.length-1][0]=="comment"?X:m,{c:F,r:y},D,re[F],u,z,r):(T="",g=Tr(c[0]),_=c.index+c[0].length);break;case"cell":if(c[1]==="/")if(Y.length>0&&(m.c=Y),(!r.sheetRows||r.sheetRows>y)&&m.v!==void 0&&(r.dense?(d[y]||(d[y]=[]),d[y][F]=m):d[He(F)+Xe(y)]=m),m.HRef&&(m.l={Target:ke(m.HRef)},m.HRefScreenTip&&(m.l.Tooltip=m.HRefScreenTip),delete m.HRef,delete m.HRefScreenTip),(m.MergeAcross||m.MergeDown)&&(C=F+(parseInt(m.MergeAcross,10)|0),G=y+(parseInt(m.MergeDown,10)|0),I.push({s:{c:F,r:y},e:{c:C,r:G}})),!r.sheetStubs)m.MergeAcross?F=C+1:++F;else if(m.MergeAcross||m.MergeDown){for(var se=F;se<=C;++se)for(var le=y;le<=G;++le)(se>F||le>y)&&(r.dense?(d[le]||(d[le]=[]),d[le][se]={t:"z"}):d[He(se)+Xe(le)]={t:"z"});F=C+1}else++F;else m=xp(c[0]),m.Index&&(F=+m.Index-1),F<E.s.c&&(E.s.c=F),F>E.e.c&&(E.e.c=F),c[0].slice(-2)==="/>"&&++F,Y=[];break;case"row":c[1]==="/"||c[0].slice(-2)==="/>"?(y<E.s.r&&(E.s.r=y),y>E.e.r&&(E.e.r=y),c[0].slice(-2)==="/>"&&(u=Tr(c[0]),u.Index&&(y=+u.Index-1)),F=0,++y):(u=Tr(c[0]),u.Index&&(y=+u.Index-1),xe={},(u.AutoFitHeight=="0"||u.Height)&&(xe.hpx=parseInt(u.Height,10),xe.hpt=w0(xe.hpx),ue[y]=xe),u.Hidden=="1"&&(xe.hidden=!0,ue[y]=xe));break;case"worksheet":if(c[1]==="/"){if((f=h.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"));x.push(p),E.s.r<=E.e.r&&E.s.c<=E.e.c&&(d["!ref"]=Te(E),r.sheetRows&&r.sheetRows<=E.e.r&&(d["!fullref"]=d["!ref"],E.e.r=r.sheetRows-1,d["!ref"]=Te(E))),I.length&&(d["!merges"]=I),re.length>0&&(d["!cols"]=re),ue.length>0&&(d["!rows"]=ue),o[p]=d}else E={s:{r:2e6,c:2e6},e:{r:0,c:0}},y=F=0,h.push([c[3],!1]),f=Tr(c[0]),p=ke(f.Name),d=r.dense?[]:{},I=[],z=[],ue=[],O={name:p,Hidden:0},j.Sheets.push(O);break;case"table":if(c[1]==="/"){if((f=h.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"))}else{if(c[0].slice(-2)=="/>")break;h.push([c[3],!1]),re=[],be=!1}break;case"style":c[1]==="/"?gp(D,R,r):R=Tr(c[0]);break;case"numberformat":R.nf=ke(Tr(c[0]).Format||"General"),qt[R.nf]&&(R.nf=qt[R.nf]);for(var te=0;te!=392&&me[te]!=R.nf;++te);if(te==392){for(te=57;te!=392;++te)if(me[te]==null){lt(R.nf,te);break}}break;case"column":if(h[h.length-1][0]!=="table")break;if(ne=Tr(c[0]),ne.Hidden&&(ne.hidden=!0,delete ne.Hidden),ne.Width&&(ne.wpx=parseInt(ne.Width,10)),!be&&ne.wpx>10){be=!0,nr=v0;for(var Q=0;Q<re.length;++Q)re[Q]&&Ct(re[Q])}be&&Ct(ne),re[ne.Index-1||re.length]=ne;for(var _e=0;_e<+ne.Span;++_e)re[re.length]=Ye(ne);break;case"namedrange":if(c[1]==="/")break;j.Names||(j.Names=[]);var N=he(c[0]),Ie={Name:N.Name,Ref:Et(N.RefersTo.slice(1),{r:0,c:0})};j.Sheets.length>0&&(Ie.Sheet=j.Sheets.length-1),j.Names.push(Ie);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(c[0].slice(-2)==="/>")break;c[1]==="/"?T+=a.slice(M,c.index):M=c.index+c[0].length;break;case"interior":if(!r.cellStyles)break;R.Interior=Tr(c[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(c[0].slice(-2)==="/>")break;c[1]==="/"?rf(V,q,a.slice(P,c.index)):P=c.index+c[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(c[1]==="/"){if((f=h.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"))}else h.push([c[3],!1]);break;case"comment":if(c[1]==="/"){if((f=h.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"));yp(X),Y.push(X)}else h.push([c[3],!1]),f=Tr(c[0]),X={a:f.Author};break;case"autofilter":if(c[1]==="/"){if((f=h.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"))}else if(c[0].charAt(c[0].length-2)!=="/"){var Ee=Tr(c[0]);d["!autofilter"]={ref:Et(Ee.Range).replace(/\$/g,"")},h.push([c[3],!0])}break;case"name":break;case"datavalidation":if(c[1]==="/"){if((f=h.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&h.push([c[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(c[1]==="/"){if((f=h.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&h.push([c[3],!0]);break;case"null":break;default:if(h.length==0&&c[3]=="document"||h.length==0&&c[3]=="uof")return Kn(a,r);var Ae=!0;switch(h[h.length-1][0]){case"officedocumentsettings":switch(c[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Ae=!1}break;case"componentoptions":switch(c[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Ae=!1}break;case"excelworkbook":switch(c[3]){case"date1904":j.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Ae=!1}break;case"workbookoptions":switch(c[3]){case"owcversion":break;case"height":break;case"width":break;default:Ae=!1}break;case"worksheetoptions":switch(c[3]){case"visible":if(c[0].slice(-2)!=="/>")if(c[1]==="/")switch(a.slice(P,c.index)){case"SheetHidden":O.Hidden=1;break;case"SheetVeryHidden":O.Hidden=2;break}else P=c.index+c[0].length;break;case"header":d["!margins"]||Kt(d["!margins"]={},"xlml"),isNaN(+he(c[0]).Margin)||(d["!margins"].header=+he(c[0]).Margin);break;case"footer":d["!margins"]||Kt(d["!margins"]={},"xlml"),isNaN(+he(c[0]).Margin)||(d["!margins"].footer=+he(c[0]).Margin);break;case"pagemargins":var ve=he(c[0]);d["!margins"]||Kt(d["!margins"]={},"xlml"),isNaN(+ve.Top)||(d["!margins"].top=+ve.Top),isNaN(+ve.Left)||(d["!margins"].left=+ve.Left),isNaN(+ve.Right)||(d["!margins"].right=+ve.Right),isNaN(+ve.Bottom)||(d["!margins"].bottom=+ve.Bottom);break;case"displayrighttoleft":j.Views||(j.Views=[]),j.Views[0]||(j.Views[0]={}),j.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Ae=!1}break;case"pivottable":case"pivotcache":switch(c[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Ae=!1}break;case"pagebreaks":switch(c[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Ae=!1}break;case"autofilter":switch(c[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Ae=!1}break;case"querytable":switch(c[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Ae=!1}break;case"datavalidation":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Ae=!1}break;case"sorting":case"conditionalformatting":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Ae=!1}break;case"mapinfo":case"schema":case"data":switch(c[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Ae=!1}break;case"smarttags":break;default:Ae=!1;break}if(Ae||c[3].match(/!\[CDATA/))break;if(!h[h.length-1][1])throw"Unrecognized tag: "+c[3]+"|"+h.join("|");if(h[h.length-1][0]==="customdocumentproperties"){if(c[0].slice(-2)==="/>")break;c[1]==="/"?pp(L,q,J,a.slice(P,c.index)):(J=c,P=c.index+c[0].length);break}if(r.WTF)throw"Unrecognized tag: "+c[3]+"|"+h.join("|")}var ie={};return!r.bookSheets&&!r.bookProps&&(ie.Sheets=o),ie.SheetNames=x,ie.Workbook=j,ie.SSF=Ye(me),ie.Props=V,ie.Custprops=L,ie}function ns(e,t){switch(js(t=t||{}),t.type||"base64"){case"base64":return Xa(xr(e),t);case"binary":case"buffer":case"file":return Xa(e,t);case"array":return Xa(dt(e),t)}}function wp(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=Io(r),r.length-r.l<=4)return t;var a=r.read_shift(4);if(a==0||a>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(a=r.read_shift(4),a!==1907505652)||(t.UnicodeClipboardFormat=Oo(r),a=r.read_shift(4),a==0||a>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var Tp=[60,1084,2066,2165,2175];function _p(e,t,r,a,s){var n=a,i=[],c=r.slice(r.l,r.l+n);if(s&&s.enc&&s.enc.insitu&&c.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(c)}i.push(c),r.l+=n;for(var h=Br(r,r.l),f=is[h],o=0;f!=null&&Tp.indexOf(h)>-1;)n=Br(r,r.l+2),o=r.l+4,h==2066?o+=4:(h==2165||h==2175)&&(o+=12),c=r.slice(o,r.l+4+n),i.push(c),r.l+=4+n,f=is[h=Br(r,r.l)];var x=qr(i);ze(x,0);var d=0;x.lens=[];for(var p=0;p<i.length;++p)x.lens.push(d),d+=i[p].length;if(x.length<a)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+x.length+" < "+a;return t.f(x,x.length,s)}function Rr(e,t,r){if(e.t!=="z"&&e.XF){var a=0;try{a=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=me[a])}catch(n){if(t.WTF)throw n}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||gt[e.v]:a===0||a=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Zt(e.v):e.w=ft(e.v):e.w=yr(a,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(n){if(t.WTF)throw n}if(t.cellDates&&a&&e.t=="n"&&Nt(me[a]||String(a))){var s=it(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function Ta(e,t,r){return{v:e,ixfe:t,t:r}}function kp(e,t){var r={opts:{}},a={},s=t.dense?[]:{},n={},i={},c=null,h=[],f="",o={},x,d="",p,m,u,g,_={},F=[],y,E,D=[],R=[],T={Sheets:[],WBProps:{date1904:!1},Views:[{}]},M={},I=function(ge){return ge<8?ot[ge]:ge<64&&R[ge-8]||ot[ge]},V=function(ge,Pe,pr){var Ue=Pe.XF.data;if(!(!Ue||!Ue.patternType||!pr||!pr.cellStyles)){Pe.s={},Pe.s.patternType=Ue.patternType;var at;(at=ta(I(Ue.icvFore)))&&(Pe.s.fgColor={rgb:at}),(at=ta(I(Ue.icvBack)))&&(Pe.s.bgColor={rgb:at})}},L=function(ge,Pe,pr){if(!(xe>1)&&!(pr.sheetRows&&ge.r>=pr.sheetRows)){if(pr.cellStyles&&Pe.XF&&Pe.XF.data&&V(ge,Pe,pr),delete Pe.ixfe,delete Pe.XF,x=ge,d=de(ge),(!i||!i.s||!i.e)&&(i={s:{r:0,c:0},e:{r:0,c:0}}),ge.r<i.s.r&&(i.s.r=ge.r),ge.c<i.s.c&&(i.s.c=ge.c),ge.r+1>i.e.r&&(i.e.r=ge.r+1),ge.c+1>i.e.c&&(i.e.c=ge.c+1),pr.cellFormula&&Pe.f){for(var Ue=0;Ue<F.length;++Ue)if(!(F[Ue][0].s.c>ge.c||F[Ue][0].s.r>ge.r)&&!(F[Ue][0].e.c<ge.c||F[Ue][0].e.r<ge.r)){Pe.F=Te(F[Ue][0]),(F[Ue][0].s.c!=ge.c||F[Ue][0].s.r!=ge.r)&&delete Pe.f,Pe.f&&(Pe.f=""+Je(F[Ue][1],i,ge,z,P));break}}pr.dense?(s[ge.r]||(s[ge.r]=[]),s[ge.r][ge.c]=Pe):s[d]=Pe}},P={enc:!1,sbcch:0,snames:[],sharedf:_,arrayf:F,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(P.password=t.password);var J,Y=[],X=[],re=[],ne=[],be=!1,z=[];z.SheetNames=P.snames,z.sharedf=P.sharedf,z.arrayf=P.arrayf,z.names=[],z.XTI=[];var ue=0,xe=0,C=0,G=[],j=[],O;P.codepage=1200,br(1200);for(var q=!1;e.l<e.length-1;){var se=e.l,le=e.read_shift(2);if(le===0&&ue===10)break;var te=e.l===e.length?0:e.read_shift(2),Q=is[le];if(Q&&Q.f){if(t.bookSheets&&ue===133&&le!==133)break;if(ue=le,Q.r===2||Q.r==12){var _e=e.read_shift(2);if(te-=2,!P.enc&&_e!==le&&((_e&255)<<8|_e>>8)!==le)throw new Error("rt mismatch: "+_e+"!="+le);Q.r==12&&(e.l+=10,te-=10)}var N={};if(le===10?N=Q.f(e,te,P):N=_p(le,Q,e,te,P),xe==0&&[9,521,1033,2057].indexOf(ue)===-1)continue;switch(le){case 34:r.opts.Date1904=T.WBProps.date1904=N;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(P.enc||(e.l=0),P.enc=N,!t.password)throw new Error("File is password-protected");if(N.valid==null)throw new Error("Encryption scheme unsupported");if(!N.valid)throw new Error("Password is incorrect");break;case 92:P.lastuser=N;break;case 66:var Ie=Number(N);switch(Ie){case 21010:Ie=1200;break;case 32768:Ie=1e4;break;case 32769:Ie=1252;break}br(P.codepage=Ie),q=!0;break;case 317:P.rrtabid=N;break;case 25:P.winlocked=N;break;case 439:r.opts.RefreshAll=N;break;case 12:r.opts.CalcCount=N;break;case 16:r.opts.CalcDelta=N;break;case 17:r.opts.CalcIter=N;break;case 13:r.opts.CalcMode=N;break;case 14:r.opts.CalcPrecision=N;break;case 95:r.opts.CalcSaveRecalc=N;break;case 15:P.CalcRefMode=N;break;case 2211:r.opts.FullCalc=N;break;case 129:N.fDialog&&(s["!type"]="dialog"),N.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),N.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:D.push(N);break;case 430:z.push([N]),z[z.length-1].XTI=[];break;case 35:case 547:z[z.length-1].push(N);break;case 24:case 536:O={Name:N.Name,Ref:Je(N.rgce,i,null,z,P)},N.itab>0&&(O.Sheet=N.itab-1),z.names.push(O),z[0]||(z[0]=[],z[0].XTI=[]),z[z.length-1].push(N),N.Name=="_xlnm._FilterDatabase"&&N.itab>0&&N.rgce&&N.rgce[0]&&N.rgce[0][0]&&N.rgce[0][0][0]=="PtgArea3d"&&(j[N.itab-1]={ref:Te(N.rgce[0][0][1][2])});break;case 22:P.ExternCount=N;break;case 23:z.length==0&&(z[0]=[],z[0].XTI=[]),z[z.length-1].XTI=z[z.length-1].XTI.concat(N),z.XTI=z.XTI.concat(N);break;case 2196:if(P.biff<8)break;O!=null&&(O.Comment=N[1]);break;case 18:s["!protect"]=N;break;case 19:N!==0&&P.WTF&&console.error("Password verifier: "+N);break;case 133:n[N.pos]=N,P.snames.push(N.name);break;case 10:{if(--xe)break;if(i.e){if(i.e.r>0&&i.e.c>0){if(i.e.r--,i.e.c--,s["!ref"]=Te(i),t.sheetRows&&t.sheetRows<=i.e.r){var Ee=i.e.r;i.e.r=t.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=Te(i),i.e.r=Ee}i.e.r++,i.e.c++}Y.length>0&&(s["!merges"]=Y),X.length>0&&(s["!objects"]=X),re.length>0&&(s["!cols"]=re),ne.length>0&&(s["!rows"]=ne),T.Sheets.push(M)}f===""?o=s:a[f]=s,s=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(P.biff===8&&(P.biff={9:2,521:3,1033:4}[le]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[N.BIFFVer]||8),P.biffguess=N.BIFFVer==0,N.BIFFVer==0&&N.dt==4096&&(P.biff=5,q=!0,br(P.codepage=28591)),P.biff==8&&N.BIFFVer==0&&N.dt==16&&(P.biff=2),xe++)break;if(s=t.dense?[]:{},P.biff<8&&!q&&(q=!0,br(P.codepage=t.codepage||1252)),P.biff<5||N.BIFFVer==0&&N.dt==4096){f===""&&(f="Sheet1"),i={s:{r:0,c:0},e:{r:0,c:0}};var Ae={pos:e.l-te,name:f};n[Ae.pos]=Ae,P.snames.push(f)}else f=(n[se]||{name:""}).name;N.dt==32&&(s["!type"]="chart"),N.dt==64&&(s["!type"]="macro"),Y=[],X=[],P.arrayf=F=[],re=[],ne=[],be=!1,M={Hidden:(n[se]||{hs:0}).hs,name:f}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(t.dense?(s[N.r]||[])[N.c]:s[de({c:N.c,r:N.r})])&&++N.c,y={ixfe:N.ixfe,XF:D[N.ixfe]||{},v:N.val,t:"n"},C>0&&(y.z=G[y.ixfe>>8&63]),Rr(y,t,r.opts.Date1904),L({c:N.c,r:N.r},y,t);break;case 5:case 517:y={ixfe:N.ixfe,XF:D[N.ixfe],v:N.val,t:N.t},C>0&&(y.z=G[y.ixfe>>8&63]),Rr(y,t,r.opts.Date1904),L({c:N.c,r:N.r},y,t);break;case 638:y={ixfe:N.ixfe,XF:D[N.ixfe],v:N.rknum,t:"n"},C>0&&(y.z=G[y.ixfe>>8&63]),Rr(y,t,r.opts.Date1904),L({c:N.c,r:N.r},y,t);break;case 189:for(var ve=N.c;ve<=N.C;++ve){var ie=N.rkrec[ve-N.c][0];y={ixfe:ie,XF:D[ie],v:N.rkrec[ve-N.c][1],t:"n"},C>0&&(y.z=G[y.ixfe>>8&63]),Rr(y,t,r.opts.Date1904),L({c:ve,r:N.r},y,t)}break;case 6:case 518:case 1030:{if(N.val=="String"){c=N;break}if(y=Ta(N.val,N.cell.ixfe,N.tt),y.XF=D[y.ixfe],t.cellFormula){var Oe=N.formula;if(Oe&&Oe[0]&&Oe[0][0]&&Oe[0][0][0]=="PtgExp"){var dr=Oe[0][0][1][0],Fr=Oe[0][0][1][1],jr=de({r:dr,c:Fr});_[jr]?y.f=""+Je(N.formula,i,N.cell,z,P):y.F=((t.dense?(s[dr]||[])[Fr]:s[jr])||{}).F}else y.f=""+Je(N.formula,i,N.cell,z,P)}C>0&&(y.z=G[y.ixfe>>8&63]),Rr(y,t,r.opts.Date1904),L(N.cell,y,t),c=N}break;case 7:case 519:if(c)c.val=N,y=Ta(N,c.cell.ixfe,"s"),y.XF=D[y.ixfe],t.cellFormula&&(y.f=""+Je(c.formula,i,c.cell,z,P)),C>0&&(y.z=G[y.ixfe>>8&63]),Rr(y,t,r.opts.Date1904),L(c.cell,y,t),c=null;else throw new Error("String record expects Formula");break;case 33:case 545:{F.push(N);var It=de(N[0].s);if(p=t.dense?(s[N[0].s.r]||[])[N[0].s.c]:s[It],t.cellFormula&&p){if(!c||!It||!p)break;p.f=""+Je(N[1],i,N[0],z,P),p.F=Te(N[0])}}break;case 1212:{if(!t.cellFormula)break;if(d){if(!c)break;_[de(c.cell)]=N[0],p=t.dense?(s[c.cell.r]||[])[c.cell.c]:s[de(c.cell)],(p||{}).f=""+Je(N[0],i,x,z,P)}}break;case 253:y=Ta(h[N.isst].t,N.ixfe,"s"),h[N.isst].h&&(y.h=h[N.isst].h),y.XF=D[y.ixfe],C>0&&(y.z=G[y.ixfe>>8&63]),Rr(y,t,r.opts.Date1904),L({c:N.c,r:N.r},y,t);break;case 513:t.sheetStubs&&(y={ixfe:N.ixfe,XF:D[N.ixfe],t:"z"},C>0&&(y.z=G[y.ixfe>>8&63]),Rr(y,t,r.opts.Date1904),L({c:N.c,r:N.r},y,t));break;case 190:if(t.sheetStubs)for(var zr=N.c;zr<=N.C;++zr){var fr=N.ixfe[zr-N.c];y={ixfe:fr,XF:D[fr],t:"z"},C>0&&(y.z=G[y.ixfe>>8&63]),Rr(y,t,r.opts.Date1904),L({c:zr,r:N.r},y,t)}break;case 214:case 516:case 4:y=Ta(N.val,N.ixfe,"s"),y.XF=D[y.ixfe],C>0&&(y.z=G[y.ixfe>>8&63]),Rr(y,t,r.opts.Date1904),L({c:N.c,r:N.r},y,t);break;case 0:case 512:xe===1&&(i=N);break;case 252:h=N;break;case 1054:if(P.biff==4){G[C++]=N[1];for(var Mr=0;Mr<C+163&&me[Mr]!=N[1];++Mr);Mr>=163&&lt(N[1],C+163)}else lt(N[1],N[0]);break;case 30:{G[C++]=N;for(var Yr=0;Yr<C+163&&me[Yr]!=N;++Yr);Yr>=163&&lt(N,C+163)}break;case 229:Y=Y.concat(N);break;case 93:X[N.cmo[0]]=P.lastobj=N;break;case 438:P.lastobj.TxO=N;break;case 127:P.lastobj.ImData=N;break;case 440:for(g=N[0].s.r;g<=N[0].e.r;++g)for(u=N[0].s.c;u<=N[0].e.c;++u)p=t.dense?(s[g]||[])[u]:s[de({c:u,r:g})],p&&(p.l=N[1]);break;case 2048:for(g=N[0].s.r;g<=N[0].e.r;++g)for(u=N[0].s.c;u<=N[0].e.c;++u)p=t.dense?(s[g]||[])[u]:s[de({c:u,r:g})],p&&p.l&&(p.l.Tooltip=N[1]);break;case 28:{if(P.biff<=5&&P.biff>=2)break;p=t.dense?(s[N[0].r]||[])[N[0].c]:s[de(N[0])];var Ot=X[N[2]];p||(t.dense?(s[N[0].r]||(s[N[0].r]=[]),p=s[N[0].r][N[0].c]={t:"z"}):p=s[de(N[0])]={t:"z"},i.e.r=Math.max(i.e.r,N[0].r),i.s.r=Math.min(i.s.r,N[0].r),i.e.c=Math.max(i.e.c,N[0].c),i.s.c=Math.min(i.s.c,N[0].c)),p.c||(p.c=[]),m={a:N[1],t:Ot.TxO.t},p.c.push(m)}break;case 2173:$u(D[N.ixfe],N.ext);break;case 125:{if(!P.cellStyles)break;for(;N.e>=N.s;)re[N.e--]={width:N.w/256,level:N.level||0,hidden:!!(N.flags&1)},be||(be=!0,Rs(N.w/256)),Ct(re[N.e+1])}break;case 520:{var ar={};N.level!=null&&(ne[N.r]=ar,ar.level=N.level),N.hidden&&(ne[N.r]=ar,ar.hidden=!0),N.hpt&&(ne[N.r]=ar,ar.hpt=N.hpt,ar.hpx=aa(N.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||Kt(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[le]]=N;break;case 161:s["!margins"]||Kt(s["!margins"]={}),s["!margins"].header=N.header,s["!margins"].footer=N.footer;break;case 574:N.RTL&&(T.Views[0].RTL=!0);break;case 146:R=N;break;case 2198:J=N;break;case 140:E=N;break;case 442:f?M.CodeName=N||M.name:T.WBProps.CodeName=N||"ThisWorkbook";break}}else Q||console.error("Missing Info for XLS Record 0x"+le.toString(16)),e.l+=te}return r.SheetNames=Ir(n).sort(function(Cr,ge){return Number(Cr)-Number(ge)}).map(function(Cr){return n[Cr].name}),t.bookSheets||(r.Sheets=a),!r.SheetNames.length&&o["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=o)):r.Preamble=o,r.Sheets&&j.forEach(function(Cr,ge){r.Sheets[r.SheetNames[ge]]["!autofilter"]=Cr}),r.Strings=h,r.SSF=Ye(me),P.enc&&(r.Encryption=P.enc),J&&(r.Themes=J),r.Metadata={},E!==void 0&&(r.Metadata.Country=E),z.names.length>0&&(T.Names=z.names),r.Workbook=T,r}var Wn={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function Ep(e,t,r){var a=we.find(e,"/!DocumentSummaryInformation");if(a&&a.size>0)try{var s=Sn(a,Uo,Wn.DSI);for(var n in s)t[n]=s[n]}catch(f){if(r.WTF)throw f}var i=we.find(e,"/!SummaryInformation");if(i&&i.size>0)try{var c=Sn(i,Vo,Wn.SI);for(var h in c)t[h]==null&&(t[h]=c[h])}catch(f){if(r.WTF)throw f}t.HeadingPairs&&t.TitlesOfParts&&(r0(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function L0(e,t){t||(t={}),js(t),ui(),t.codepage&&ds(t.codepage);var r,a;if(e.FullPaths){if(we.find(e,"/encryption"))throw new Error("File is password-protected");r=we.find(e,"!CompObj"),a=we.find(e,"/Workbook")||we.find(e,"/Book")}else{switch(t.type){case"base64":e=Er(xr(e));break;case"binary":e=Er(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}ze(e,0),a={content:e}}var s,n;if(r&&wp(r),t.bookProps&&!t.bookSheets)s={};else{var i=ye?"buffer":"array";if(a&&a.content)s=kp(a.content,t);else if((n=we.find(e,"PerfectOffice_MAIN"))&&n.content)s=Yt.to_workbook(n.content,(t.type=i,t));else if((n=we.find(e,"NativeContent_MAIN"))&&n.content)s=Yt.to_workbook(n.content,(t.type=i,t));else throw(n=we.find(e,"MN0"))&&n.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&we.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=ox(e))}var c={};return e.FullPaths&&Ep(e,c,t),s.Props=s.Custprops=c,t.bookFiles&&(s.cfb=e),s}var Ia={0:{f:n1},1:{f:o1},2:{f:v1},3:{f:x1},4:{f:h1},5:{f:g1},6:{f:T1},7:{f:p1},8:{f:A1},9:{f:b1},10:{f:k1},11:{f:E1},12:{f:f1},13:{f:y1},14:{f:d1},15:{f:u1},16:{f:I0},17:{f:_1},18:{f:m1},19:{f:bs},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:Q1},40:{},42:{},43:{f:ku},44:{f:_u},45:{f:Eu},46:{f:Au},47:{f:bu},48:{},49:{f:Ao},50:{},51:{f:Yu},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:x0},62:{f:w1},63:{f:Zu},64:{f:P1},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:rr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:O1},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:l1},148:{f:i1,p:16},151:{f:C1},152:{},153:{f:J1},154:{},155:{},156:{f:q1},157:{},158:{},159:{T:1,f:Hh},160:{T:-1},161:{T:1,f:mt},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:S1},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:zu},336:{T:-1},337:{f:Xu,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:rs},357:{},358:{},359:{},360:{T:1},361:{},362:{f:u0},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:N1},427:{f:R1},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:I1},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:c1},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:F1},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:rs},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:ix},633:{T:1},634:{T:-1},635:{T:1,f:nx},636:{T:-1},637:{f:Fo},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:V1},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:j1},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},is={6:{f:za},10:{f:Xr},12:{f:Be},13:{f:Be},14:{f:je},15:{f:je},16:{f:Ze},17:{f:je},18:{f:je},19:{f:Be},20:{f:Rn},21:{f:Rn},23:{f:u0},24:{f:In},25:{f:je},26:{},27:{},28:{f:ah},29:{},34:{f:je},35:{f:Dn},38:{f:Ze},39:{f:Ze},40:{f:Ze},41:{f:Ze},42:{f:je},43:{f:je},47:{f:cu},49:{f:Lf},51:{f:Be},60:{},61:{f:Pf},64:{f:je},65:{f:Mf},66:{f:Be},77:{},80:{},81:{},82:{},85:{f:Be},89:{},90:{},91:{},92:{f:Sf},93:{f:nh},94:{},95:{f:je},96:{},97:{},99:{f:je},125:{f:x0},128:{f:Xf},129:{f:Ff},130:{f:Be},131:{f:je},132:{f:je},133:{f:Cf},134:{},140:{f:hh},141:{f:Be},144:{},146:{f:xh},151:{},152:{},153:{},154:{},155:{},156:{f:Be},157:{},158:{},160:{f:vh},161:{f:ph},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:Wf},190:{f:$f},193:{f:Xr},197:{},198:{},199:{},200:{},201:{},202:{f:je},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Be},220:{},221:{f:je},222:{},224:{f:Yf},225:{f:Af},226:{f:Xr},227:{},229:{f:sh},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:Nf},253:{f:Bf},255:{f:Rf},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:i0},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:je},353:{f:Xr},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:qf},431:{f:je},432:{},433:{},434:{},437:{},438:{f:lh},439:{f:je},440:{f:oh},441:{},442:{f:la},443:{},444:{f:Be},445:{},446:{},448:{f:Xr},449:{f:Of,r:2},450:{f:Xr},512:{f:Cn},513:{f:gh},515:{f:Kf},516:{f:Uf},517:{f:Nn},519:{f:yh},520:{f:Df},523:{},545:{f:On},549:{f:Fn},566:{},574:{f:jf},638:{f:Gf},659:{},1048:{},1054:{f:Vf},1084:{},1212:{f:eh},2048:{f:fh},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:va},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Xr},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:dh,r:12},2173:{f:Wu,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:je,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:Qf,r:12},2197:{},2198:{f:Lu,r:12},2199:{},2200:{},2201:{},2202:{f:rh,r:12},2203:{f:Xr},2204:{},2205:{},2206:{},2207:{},2211:{f:If},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Be},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:mh},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:uh},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Cn},1:{},2:{f:kh},3:{f:_h},4:{f:Th},5:{f:Nn},7:{f:Eh},8:{},9:{f:va},11:{},22:{f:Be},30:{f:Hf},31:{},32:{},33:{f:On},36:{},37:{f:Fn},50:{f:bh},62:{},52:{},67:{},68:{f:Be},69:{},86:{},126:{},127:{f:wh},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:Ah},223:{},234:{},354:{},421:{},518:{f:za},521:{f:va},536:{f:In},547:{f:Dn},561:{},579:{},1030:{f:za},1033:{f:va},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function _r(e,t,r,a){var s=t;if(!isNaN(s)){var n=a||(r||[]).length||0,i=e.next(4);i.write_shift(2,s),i.write_shift(2,n),n>0&&Yi(r)&&e.push(r)}}function $n(e,t){var r=t||{},a=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var s=e.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var n=e.match(/<\/table/i),i=s.index,c=n&&n.index||e.length,h=Xl(e.slice(i,c),/(:?<tr[^>]*>)/i,"<tr>"),f=-1,o=0,x=0,d=0,p={s:{r:1e7,c:1e7},e:{r:0,c:0}},m=[];for(i=0;i<h.length;++i){var u=h[i].trim(),g=u.slice(0,3).toLowerCase();if(g=="<tr"){if(++f,r.sheetRows&&r.sheetRows<=f){--f;break}o=0;continue}if(!(g!="<td"&&g!="<th")){var _=u.split(/<\/t[dh]>/i);for(c=0;c<_.length;++c){var F=_[c].trim();if(F.match(/<t[dh]/i)){for(var y=F,E=0;y.charAt(0)=="<"&&(E=y.indexOf(">"))>-1;)y=y.slice(E+1);for(var D=0;D<m.length;++D){var R=m[D];R.s.c==o&&R.s.r<f&&f<=R.e.r&&(o=R.e.c+1,D=-1)}var T=he(F.slice(0,F.indexOf(">")));d=T.colspan?+T.colspan:1,((x=+T.rowspan)>1||d>1)&&m.push({s:{r:f,c:o},e:{r:f+(x||1)-1,c:o+d-1}});var M=T.t||T["data-t"]||"";if(!y.length){o+=d;continue}if(y=Oi(y),p.s.r>f&&(p.s.r=f),p.e.r<f&&(p.e.r=f),p.s.c>o&&(p.s.c=o),p.e.c<o&&(p.e.c=o),!y.length){o+=d;continue}var I={t:"s",v:y};r.raw||!y.trim().length||M=="s"||(y==="TRUE"?I={t:"b",v:!0}:y==="FALSE"?I={t:"b",v:!1}:isNaN(Sr(y))?isNaN(Ft(y).getDate())||(I={t:"d",v:$e(y)},r.cellDates||(I={t:"n",v:lr(I.v)}),I.z=r.dateNF||me[14]):I={t:"n",v:Sr(y)}),r.dense?(a[f]||(a[f]=[]),a[f][o]=I):a[de({r:f,c:o})]=I,o+=d}}}}return a["!ref"]=Te(p),m.length&&(a["!merges"]=m),a}function bp(e,t,r,a){for(var s=e["!merges"]||[],n=[],i=t.s.c;i<=t.e.c;++i){for(var c=0,h=0,f=0;f<s.length;++f)if(!(s[f].s.r>r||s[f].s.c>i)&&!(s[f].e.r<r||s[f].e.c<i)){if(s[f].s.r<r||s[f].s.c<i){c=-1;break}c=s[f].e.r-s[f].s.r+1,h=s[f].e.c-s[f].s.c+1;break}if(!(c<0)){var o=de({r,c:i}),x=a.dense?(e[r]||[])[i]:e[o],d=x&&x.v!=null&&(x.h||ws(x.w||(Wr(x),x.w)||""))||"",p={};c>1&&(p.rowspan=c),h>1&&(p.colspan=h),a.editable?d='<span contenteditable="true">'+d+"</span>":x&&(p["data-t"]=x&&x.t||"z",x.v!=null&&(p["data-v"]=x.v),x.z!=null&&(p["data-z"]=x.z),x.l&&(x.l.Target||"#").charAt(0)!="#"&&(d='<a href="'+x.l.Target+'">'+d+"</a>")),p.id=(a.id||"sjs")+"-"+o,n.push(oo("td",d,p))}}var m="<tr>";return m+n.join("")+"</tr>"}var Ap='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',Sp="</body></html>";function Fp(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return tt($n(r[0],t),t);var a=Ls();return r.forEach(function(s,n){Bs(a,$n(s,t),"Sheet"+(n+1))}),a}function Cp(e,t,r){var a=[];return a.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function Np(e,t){var r=t||{},a=r.header!=null?r.header:Ap,s=r.footer!=null?r.footer:Sp,n=[a],i=Rt(e["!ref"]);r.dense=Array.isArray(e),n.push(Cp(e,i,r));for(var c=i.s.r;c<=i.e.r;++c)n.push(bp(e,i,c,r));return n.push("</table>"+s),n.join("")}function B0(e,t,r){var a=r||{},s=0,n=0;if(a.origin!=null)if(typeof a.origin=="number")s=a.origin;else{var i=typeof a.origin=="string"?ir(a.origin):a.origin;s=i.r,n=i.c}var c=t.getElementsByTagName("tr"),h=Math.min(a.sheetRows||1e7,c.length),f={s:{r:0,c:0},e:{r:s,c:n}};if(e["!ref"]){var o=Rt(e["!ref"]);f.s.r=Math.min(f.s.r,o.s.r),f.s.c=Math.min(f.s.c,o.s.c),f.e.r=Math.max(f.e.r,o.e.r),f.e.c=Math.max(f.e.c,o.e.c),s==-1&&(f.e.r=s=o.e.r+1)}var x=[],d=0,p=e["!rows"]||(e["!rows"]=[]),m=0,u=0,g=0,_=0,F=0,y=0;for(e["!cols"]||(e["!cols"]=[]);m<c.length&&u<h;++m){var E=c[m];if(zn(E)){if(a.display)continue;p[u]={hidden:!0}}var D=E.children;for(g=_=0;g<D.length;++g){var R=D[g];if(!(a.display&&zn(R))){var T=R.hasAttribute("data-v")?R.getAttribute("data-v"):R.hasAttribute("v")?R.getAttribute("v"):Oi(R.innerHTML),M=R.getAttribute("data-z")||R.getAttribute("z");for(d=0;d<x.length;++d){var I=x[d];I.s.c==_+n&&I.s.r<u+s&&u+s<=I.e.r&&(_=I.e.c+1-n,d=-1)}y=+R.getAttribute("colspan")||1,((F=+R.getAttribute("rowspan")||1)>1||y>1)&&x.push({s:{r:u+s,c:_+n},e:{r:u+s+(F||1)-1,c:_+n+(y||1)-1}});var V={t:"s",v:T},L=R.getAttribute("data-t")||R.getAttribute("t")||"";T!=null&&(T.length==0?V.t=L||"z":a.raw||T.trim().length==0||L=="s"||(T==="TRUE"?V={t:"b",v:!0}:T==="FALSE"?V={t:"b",v:!1}:isNaN(Sr(T))?isNaN(Ft(T).getDate())||(V={t:"d",v:$e(T)},a.cellDates||(V={t:"n",v:lr(V.v)}),V.z=a.dateNF||me[14]):V={t:"n",v:Sr(T)})),V.z===void 0&&M!=null&&(V.z=M);var P="",J=R.getElementsByTagName("A");if(J&&J.length)for(var Y=0;Y<J.length&&!(J[Y].hasAttribute("href")&&(P=J[Y].getAttribute("href"),P.charAt(0)!="#"));++Y);P&&P.charAt(0)!="#"&&(V.l={Target:P}),a.dense?(e[u+s]||(e[u+s]=[]),e[u+s][_+n]=V):e[de({c:_+n,r:u+s})]=V,f.e.c<_+n&&(f.e.c=_+n),_+=y}}++u}return x.length&&(e["!merges"]=(e["!merges"]||[]).concat(x)),f.e.r=Math.max(f.e.r,u-1+s),e["!ref"]=Te(f),u>=h&&(e["!fullref"]=Te((f.e.r=c.length-m+u-1+s,f))),e}function U0(e,t){var r=t||{},a=r.dense?[]:{};return B0(a,e,t)}function Rp(e,t){return tt(U0(e,t),t)}function zn(e){var t="",r=Dp(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function Dp(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function Ip(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(a,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=ke(t.replace(/<[^>]*>/g,""));return[r]}var Yn={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function V0(e,t){var r=t||{},a=Ts(e),s=[],n,i,c={name:""},h="",f=0,o,x,d={},p=[],m=r.dense?[]:{},u,g,_={value:""},F="",y=0,E=[],D=-1,R=-1,T={s:{r:1e6,c:1e7},e:{r:0,c:0}},M=0,I={},V=[],L={},P=0,J=0,Y=[],X=1,re=1,ne=[],be={Names:[]},z={},ue=["",""],xe=[],C={},G="",j=0,O=!1,q=!1,se=0;for(ea.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");u=ea.exec(a);)switch(u[3]=u[3].replace(/_.*$/,"")){case"table":case"工作表":u[1]==="/"?(T.e.c>=T.s.c&&T.e.r>=T.s.r?m["!ref"]=Te(T):m["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=T.e.r&&(m["!fullref"]=m["!ref"],T.e.r=r.sheetRows-1,m["!ref"]=Te(T)),V.length&&(m["!merges"]=V),Y.length&&(m["!rows"]=Y),o.name=o.名称||o.name,typeof JSON<"u"&&JSON.stringify(o),p.push(o.name),d[o.name]=m,q=!1):u[0].charAt(u[0].length-2)!=="/"&&(o=he(u[0],!1),D=R=-1,T.s.r=T.s.c=1e7,T.e.r=T.e.c=0,m=r.dense?[]:{},V=[],Y=[],q=!0);break;case"table-row-group":u[1]==="/"?--M:++M;break;case"table-row":case"行":if(u[1]==="/"){D+=X,X=1;break}if(x=he(u[0],!1),x.行号?D=x.行号-1:D==-1&&(D=0),X=+x["number-rows-repeated"]||1,X<10)for(se=0;se<X;++se)M>0&&(Y[D+se]={level:M});R=-1;break;case"covered-table-cell":u[1]!=="/"&&++R,r.sheetStubs&&(r.dense?(m[D]||(m[D]=[]),m[D][R]={t:"z"}):m[de({r:D,c:R})]={t:"z"}),F="",E=[];break;case"table-cell":case"数据":if(u[0].charAt(u[0].length-2)==="/")++R,_=he(u[0],!1),re=parseInt(_["number-columns-repeated"]||"1",10),g={t:"z",v:null},_.formula&&r.cellFormula!=!1&&(g.f=Vn(ke(_.formula))),(_.数据类型||_["value-type"])=="string"&&(g.t="s",g.v=ke(_["string-value"]||""),r.dense?(m[D]||(m[D]=[]),m[D][R]=g):m[de({r:D,c:R})]=g),R+=re-1;else if(u[1]!=="/"){++R,F="",y=0,E=[],re=1;var le=X?D+X-1:D;if(R>T.e.c&&(T.e.c=R),R<T.s.c&&(T.s.c=R),D<T.s.r&&(T.s.r=D),le>T.e.r&&(T.e.r=le),_=he(u[0],!1),xe=[],C={},g={t:_.数据类型||_["value-type"],v:null},r.cellFormula)if(_.formula&&(_.formula=ke(_.formula)),_["number-matrix-columns-spanned"]&&_["number-matrix-rows-spanned"]&&(P=parseInt(_["number-matrix-rows-spanned"],10)||0,J=parseInt(_["number-matrix-columns-spanned"],10)||0,L={s:{r:D,c:R},e:{r:D+P-1,c:R+J-1}},g.F=Te(L),ne.push([L,g.F])),_.formula)g.f=Vn(_.formula);else for(se=0;se<ne.length;++se)D>=ne[se][0].s.r&&D<=ne[se][0].e.r&&R>=ne[se][0].s.c&&R<=ne[se][0].e.c&&(g.F=ne[se][1]);switch((_["number-columns-spanned"]||_["number-rows-spanned"])&&(P=parseInt(_["number-rows-spanned"],10)||0,J=parseInt(_["number-columns-spanned"],10)||0,L={s:{r:D,c:R},e:{r:D+P-1,c:R+J-1}},V.push(L)),_["number-columns-repeated"]&&(re=parseInt(_["number-columns-repeated"],10)),g.t){case"boolean":g.t="b",g.v=Fe(_["boolean-value"]);break;case"float":g.t="n",g.v=parseFloat(_.value);break;case"percentage":g.t="n",g.v=parseFloat(_.value);break;case"currency":g.t="n",g.v=parseFloat(_.value);break;case"date":g.t="d",g.v=$e(_["date-value"]),r.cellDates||(g.t="n",g.v=lr(g.v)),g.z="m/d/yy";break;case"time":g.t="n",g.v=$l(_["time-value"])/86400,r.cellDates&&(g.t="d",g.v=Pa(g.v)),g.z="HH:MM:SS";break;case"number":g.t="n",g.v=parseFloat(_.数据数值);break;default:if(g.t==="string"||g.t==="text"||!g.t)g.t="s",_["string-value"]!=null&&(F=ke(_["string-value"]),E=[]);else throw new Error("Unsupported value type "+g.t)}}else{if(O=!1,g.t==="s"&&(g.v=F||"",E.length&&(g.R=E),O=y==0),z.Target&&(g.l=z),xe.length>0&&(g.c=xe,xe=[]),F&&r.cellText!==!1&&(g.w=F),O&&(g.t="z",delete g.v),(!O||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=D))for(var te=0;te<X;++te){if(re=parseInt(_["number-columns-repeated"]||"1",10),r.dense)for(m[D+te]||(m[D+te]=[]),m[D+te][R]=te==0?g:Ye(g);--re>0;)m[D+te][R+re]=Ye(g);else for(m[de({r:D+te,c:R})]=g;--re>0;)m[de({r:D+te,c:R+re})]=Ye(g);T.e.c<=R&&(T.e.c=R)}re=parseInt(_["number-columns-repeated"]||"1",10),R+=re-1,re=0,g={},F="",E=[]}z={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(u[1]==="/"){if((n=s.pop())[0]!==u[3])throw"Bad state: "+n}else u[0].charAt(u[0].length-2)!=="/"&&s.push([u[3],!0]);break;case"annotation":if(u[1]==="/"){if((n=s.pop())[0]!==u[3])throw"Bad state: "+n;C.t=F,E.length&&(C.R=E),C.a=G,xe.push(C)}else u[0].charAt(u[0].length-2)!=="/"&&s.push([u[3],!1]);G="",j=0,F="",y=0,E=[];break;case"creator":u[1]==="/"?G=a.slice(j,u.index):j=u.index+u[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(u[1]==="/"){if((n=s.pop())[0]!==u[3])throw"Bad state: "+n}else u[0].charAt(u[0].length-2)!=="/"&&s.push([u[3],!1]);F="",y=0,E=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(u[1]==="/"){if(I[c.name]=h,(n=s.pop())[0]!==u[3])throw"Bad state: "+n}else u[0].charAt(u[0].length-2)!=="/"&&(h="",c=he(u[0],!1),s.push([u[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":i=he(u[0],!1),h+=Yn[u[3]][i.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":i=he(u[0],!1),h+=Yn[u[3]][i.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(u[0].slice(-2)==="/>")break;if(u[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":h+=a.slice(f,u.index);break}else f=u.index+u[0].length;break;case"named-range":i=he(u[0],!1),ue=Ya(i["cell-range-address"]);var Q={Name:i.name,Ref:ue[0]+"!"+ue[1]};q&&(Q.Sheet=p.length),be.Names.push(Q);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"电子表格":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"文本串":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(u[1]==="/"&&(!_||!_["string-value"])){var _e=Ip(a.slice(y,u.index));F=(F.length>0?F+`
`:"")+_e[0]}else he(u[0],!1),y=u.index+u[0].length;break;case"s":break;case"database-range":if(u[1]==="/")break;try{ue=Ya(he(u[0])["target-range-address"]),d[ue[0]]["!autofilter"]={ref:ue[1]}}catch{}break;case"date":break;case"object":break;case"title":case"标题":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(u[1]!=="/"){if(z=he(u[0],!1),!z.href)break;z.Target=ke(z.href),delete z.href,z.Target.charAt(0)=="#"&&z.Target.indexOf(".")>-1?(ue=Ya(z.Target.slice(1)),z.Target="#"+ue[0]+"!"+ue[1]):z.Target.match(/^\.\.[\\\/]/)&&(z.Target=z.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(u[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(r.WTF)throw new Error(u)}}var N={Sheets:d,SheetNames:p,Workbook:be};return r.bookSheets&&delete N.Sheets,N}function Xn(e,t){t=t||{},vr(e,"META-INF/manifest.xml")&&Xo(Le(e,"META-INF/manifest.xml"),t);var r=ur(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var a=V0(Se(r),t);return vr(e,"meta.xml")&&(a.Props=e0(Le(e,"meta.xml"))),a}function Kn(e,t){return V0(e,t)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Os(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function cs(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Se(dt(e))}function ls(e){var t=e.reduce(function(s,n){return s+n.length},0),r=new Uint8Array(t),a=0;return e.forEach(function(s){r.set(s,a),a+=s.length}),r}function qn(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function Op(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,a=e[t+14]&1,s=t+13;s>=t;--s)a=a*256+e[s];return(e[t+15]&128?-a:a)*Math.pow(10,r-6176)}function sa(e,t){var r=t?t[0]:0,a=e[r]&127;e:if(e[r++]>=128&&(a|=(e[r]&127)<<7,e[r++]<128||(a|=(e[r]&127)<<14,e[r++]<128)||(a|=(e[r]&127)<<21,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),a}function Ge(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Qe(e){for(var t=[],r=[0];r[0]<e.length;){var a=r[0],s=sa(e,r),n=s&7;s=Math.floor(s/8);var i=0,c;if(s==0)break;switch(n){case 0:{for(var h=r[0];e[r[0]++]>=128;);c=e.slice(h,r[0])}break;case 5:i=4,c=e.slice(r[0],r[0]+i),r[0]+=i;break;case 1:i=8,c=e.slice(r[0],r[0]+i),r[0]+=i;break;case 2:i=sa(e,r),c=e.slice(r[0],r[0]+i),r[0]+=i;break;case 3:case 4:default:throw new Error("PB Type ".concat(n," for Field ").concat(s," at offset ").concat(a))}var f={data:c,type:n};t[s]==null?t[s]=[f]:t[s].push(f)}return t}function Ps(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function Pp(e){for(var t,r=[],a=[0];a[0]<e.length;){var s=sa(e,a),n=Qe(e.slice(a[0],a[0]+s));a[0]+=s;var i={id:Ge(n[1][0].data),messages:[]};n[2].forEach(function(c){var h=Qe(c.data),f=Ge(h[3][0].data);i.messages.push({meta:h,data:e.slice(a[0],a[0]+f)}),a[0]+=f}),(t=n[3])!=null&&t[0]&&(i.merge=Ge(n[3][0].data)>>>0>0),r.push(i)}return r}function jp(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],a=sa(t,r),s=[];r[0]<t.length;){var n=t[r[0]]&3;if(n==0){var i=t[r[0]++]>>2;if(i<60)++i;else{var c=i-59;i=t[r[0]],c>1&&(i|=t[r[0]+1]<<8),c>2&&(i|=t[r[0]+2]<<16),c>3&&(i|=t[r[0]+3]<<24),i>>>=0,i++,r[0]+=c}s.push(t.slice(r[0],r[0]+i)),r[0]+=i;continue}else{var h=0,f=0;if(n==1?(f=(t[r[0]]>>2&7)+4,h=(t[r[0]++]&224)<<3,h|=t[r[0]++]):(f=(t[r[0]++]>>2)+1,n==2?(h=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(h=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),s=[ls(s)],h==0)throw new Error("Invalid offset 0");if(h>s[0].length)throw new Error("Invalid offset beyond length");if(f>=h)for(s.push(s[0].slice(-h)),f-=h;f>=s[s.length-1].length;)s.push(s[s.length-1]),f-=s[s.length-1].length;s.push(s[0].slice(-h,-h+f))}}var o=ls(s);if(o.length!=a)throw new Error("Unexpected length: ".concat(o.length," != ").concat(a));return o}function Mp(e){for(var t=[],r=0;r<e.length;){var a=e[r++],s=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(jp(a,e.slice(r,r+s))),r+=s}if(r!==e.length)throw new Error("data is not a valid framed stream!");return ls(t)}function Lp(e,t,r,a){var s=Os(e),n=s.getUint32(4,!0),i=(a>1?12:8)+qn(n&(a>1?3470:398))*4,c=-1,h=-1,f=NaN,o=new Date(2001,0,1);n&512&&(c=s.getUint32(i,!0),i+=4),i+=qn(n&(a>1?12288:4096))*4,n&16&&(h=s.getUint32(i,!0),i+=4),n&32&&(f=s.getFloat64(i,!0),i+=8),n&64&&(o.setTime(o.getTime()+s.getFloat64(i,!0)*1e3),i+=8);var x;switch(e[2]){case 0:break;case 2:x={t:"n",v:f};break;case 3:x={t:"s",v:t[h]};break;case 5:x={t:"d",v:o};break;case 6:x={t:"b",v:f>0};break;case 7:x={t:"n",v:f/86400};break;case 8:x={t:"e",v:0};break;case 9:if(c>-1)x={t:"s",v:r[c]};else if(h>-1)x={t:"s",v:t[h]};else if(!isNaN(f))x={t:"n",v:f};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return x}function Bp(e,t,r){var a=Os(e),s=a.getUint32(8,!0),n=12,i=-1,c=-1,h=NaN,f=NaN,o=new Date(2001,0,1);s&1&&(h=Op(e,n),n+=16),s&2&&(f=a.getFloat64(n,!0),n+=8),s&4&&(o.setTime(o.getTime()+a.getFloat64(n,!0)*1e3),n+=8),s&8&&(c=a.getUint32(n,!0),n+=4),s&16&&(i=a.getUint32(n,!0),n+=4);var x;switch(e[1]){case 0:break;case 2:x={t:"n",v:h};break;case 3:x={t:"s",v:t[c]};break;case 5:x={t:"d",v:o};break;case 6:x={t:"b",v:f>0};break;case 7:x={t:"n",v:f/86400};break;case 8:x={t:"e",v:0};break;case 9:if(i>-1)x={t:"s",v:r[i]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)));break;case 10:x={t:"n",v:h};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)))}return x}function Up(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return Lp(e,t,r,e[0]);case 5:return Bp(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Qr(e){var t=Qe(e);return sa(t[1][0].data)}function Jn(e,t){var r=Qe(t.data),a=Ge(r[1][0].data),s=r[3],n=[];return(s||[]).forEach(function(i){var c=Qe(i.data),h=Ge(c[1][0].data)>>>0;switch(a){case 1:n[h]=cs(c[3][0].data);break;case 8:{var f=e[Qr(c[9][0].data)][0],o=Qe(f.data),x=e[Qr(o[1][0].data)][0],d=Ge(x.meta[1][0].data);if(d!=2001)throw new Error("2000 unexpected reference to ".concat(d));var p=Qe(x.data);n[h]=p[3].map(function(m){return cs(m.data)}).join("")}break}}),n}function Vp(e,t){var r,a,s,n,i,c,h,f,o,x,d,p,m,u,g=Qe(e),_=Ge(g[1][0].data)>>>0,F=Ge(g[2][0].data)>>>0,y=((a=(r=g[8])==null?void 0:r[0])==null?void 0:a.data)&&Ge(g[8][0].data)>0||!1,E,D;if((n=(s=g[7])==null?void 0:s[0])!=null&&n.data&&t!=0)E=(c=(i=g[7])==null?void 0:i[0])==null?void 0:c.data,D=(f=(h=g[6])==null?void 0:h[0])==null?void 0:f.data;else if((x=(o=g[4])==null?void 0:o[0])!=null&&x.data&&t!=1)E=(p=(d=g[4])==null?void 0:d[0])==null?void 0:p.data,D=(u=(m=g[3])==null?void 0:m[0])==null?void 0:u.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var R=y?4:1,T=Os(E),M=[],I=0;I<E.length/2;++I){var V=T.getUint16(I*2,!0);V<65535&&M.push([I,V])}if(M.length!=F)throw"Expected ".concat(F," cells, found ").concat(M.length);var L=[];for(I=0;I<M.length-1;++I)L[M[I][0]]=D.subarray(M[I][1]*R,M[I+1][1]*R);return M.length>=1&&(L[M[M.length-1][0]]=D.subarray(M[M.length-1][1]*R)),{R:_,cells:L}}function Hp(e,t){var r,a=Qe(t.data),s=(r=a==null?void 0:a[7])!=null&&r[0]?Ge(a[7][0].data)>>>0>0?1:0:-1,n=Ps(a[5],function(i){return Vp(i,s)});return{nrows:Ge(a[4][0].data)>>>0,data:n.reduce(function(i,c){return i[c.R]||(i[c.R]=[]),c.cells.forEach(function(h,f){if(i[c.R][f])throw new Error("Duplicate cell r=".concat(c.R," c=").concat(f));i[c.R][f]=h}),i},[])}}function Gp(e,t,r){var a,s=Qe(t.data),n={s:{r:0,c:0},e:{r:0,c:0}};if(n.e.r=(Ge(s[6][0].data)>>>0)-1,n.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(n.e.c=(Ge(s[7][0].data)>>>0)-1,n.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=Te(n);var i=Qe(s[4][0].data),c=Jn(e,e[Qr(i[4][0].data)][0]),h=(a=i[17])!=null&&a[0]?Jn(e,e[Qr(i[17][0].data)][0]):[],f=Qe(i[3][0].data),o=0;f[1].forEach(function(x){var d=Qe(x.data),p=e[Qr(d[2][0].data)][0],m=Ge(p.meta[1][0].data);if(m!=6002)throw new Error("6001 unexpected reference to ".concat(m));var u=Hp(e,p);u.data.forEach(function(g,_){g.forEach(function(F,y){var E=de({r:o+_,c:y}),D=Up(F,c,h);D&&(r[E]=D)})}),o+=u.nrows})}function Wp(e,t){var r=Qe(t.data),a={"!ref":"A1"},s=e[Qr(r[2][0].data)],n=Ge(s[0].meta[1][0].data);if(n!=6001)throw new Error("6000 unexpected reference to ".concat(n));return Gp(e,s[0],a),a}function $p(e,t){var r,a=Qe(t.data),s={name:(r=a[1])!=null&&r[0]?cs(a[1][0].data):"",sheets:[]},n=Ps(a[2],Qr);return n.forEach(function(i){e[i].forEach(function(c){var h=Ge(c.meta[1][0].data);h==6e3&&s.sheets.push(Wp(e,c))})}),s}function zp(e,t){var r=Ls(),a=Qe(t.data),s=Ps(a[1],Qr);if(s.forEach(function(n){e[n].forEach(function(i){var c=Ge(i.meta[1][0].data);if(c==2){var h=$p(e,i);h.sheets.forEach(function(f,o){Bs(r,f,o==0?h.name:h.name+"_"+o,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Ka(e){var t,r,a,s,n={},i=[];if(e.FullPaths.forEach(function(h){if(h.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(h){if(h.name.match(/\.iwa$/)){var f;try{f=Mp(h.content)}catch(x){return console.log("?? "+h.content.length+" "+(x.message||x))}var o;try{o=Pp(f)}catch(x){return console.log("## "+(x.message||x))}o.forEach(function(x){n[x.id]=x.messages,i.push(x.id)})}}),!i.length)throw new Error("File has no messages");var c=((s=(a=(r=(t=n==null?void 0:n[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:a[1])==null?void 0:s[0].data)&&Ge(n[1][0].meta[1][0].data)==1&&n[1][0];if(c||i.forEach(function(h){n[h].forEach(function(f){var o=Ge(f.meta[1][0].data)>>>0;if(o==1)if(!c)c=f;else throw new Error("Document has multiple roots")})}),!c)throw new Error("Cannot find Document root");return zp(n,c)}function Yp(e){return function(r){for(var a=0;a!=e.length;++a){var s=e[a];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function js(e){Yp([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function Xp(e){return Tt.WS.indexOf(e)>-1?"sheet":e==Tt.CS?"chart":e==Tt.DS?"dialog":e==Tt.MS?"macro":e&&e.length?e:"sheet"}function Kp(e,t){if(!e)return 0;try{e=t.map(function(a){return a.id||(a.id=a.strRelID),[a.name,e["!id"][a.id].Target,Xp(e["!id"][a.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function qp(e,t,r,a,s,n,i,c,h,f,o,x){try{n[a]=$t(ur(e,r,!0),t);var d=Le(e,t),p;switch(c){case"sheet":p=tp(d,t,s,h,n[a],f,o,x);break;case"chart":if(p=ap(d,t,s,h,n[a],f,o,x),!p||!p["!drawel"])break;var m=Ut(p["!drawel"].Target,t),u=ts(m),g=rx(ur(e,m,!0),$t(ur(e,u,!0),m)),_=Ut(g,m),F=ts(_);p=B1(ur(e,_,!0),_,h,$t(ur(e,F,!0),_),f,p);break;case"macro":p=sp(d,t,s,h,n[a],f,o,x);break;case"dialog":p=np(d,t,s,h,n[a],f,o,x);break;default:throw new Error("Unrecognized sheet type "+c)}i[a]=p;var y=[];n&&n[a]&&Ir(n[a]).forEach(function(E){var D="";if(n[a][E].Type==Tt.CMNT){D=Ut(n[a][E].Target,t);var R=op(Le(e,D,!0),D,h);if(!R||!R.length)return;jn(p,R,!1)}n[a][E].Type==Tt.TCMNT&&(D=Ut(n[a][E].Target,t),y=y.concat(ax(Le(e,D,!0),h)))}),y&&y.length&&jn(p,y,!0,h.people||[])}catch(E){if(h.WTF)throw E}}function mr(e){return e.charAt(0)=="/"?e.slice(1):e}function Jp(e,t){if(Ei(),t=t||{},js(t),vr(e,"META-INF/manifest.xml")||vr(e,"objectdata.xml"))return Xn(e,t);if(vr(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Ka<"u"){if(e.FileIndex)return Ka(e);var r=we.utils.cfb_new();return on(e).forEach(function(Y){ql(r,Y,Ni(e,Y))}),Ka(r)}throw new Error("Unsupported NUMBERS file")}if(!vr(e,"[Content_Types].xml"))throw vr(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):vr(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var a=on(e),s=zo(ur(e,"[Content_Types].xml")),n=!1,i,c;if(s.workbooks.length===0&&(c="xl/workbook.xml",Le(e,c,!0)&&s.workbooks.push(c)),s.workbooks.length===0){if(c="xl/workbook.bin",!Le(e,c,!0))throw new Error("Could not find workbook");s.workbooks.push(c),n=!0}s.workbooks[0].slice(-3)=="bin"&&(n=!0);var h={},f={};if(!t.bookSheets&&!t.bookProps){if(Xt=[],s.sst)try{Xt=lp(Le(e,mr(s.sst)),s.sst,t)}catch(Y){if(t.WTF)throw Y}t.cellStyles&&s.themes.length&&(h=cp(ur(e,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],t)),s.style&&(f=ip(Le(e,mr(s.style)),s.style,h,t))}s.links.map(function(Y){try{var X=$t(ur(e,ts(mr(Y))),Y);return hp(Le(e,mr(Y)),X,Y,t)}catch{}});var o=rp(Le(e,mr(s.workbooks[0])),s.workbooks[0],t),x={},d="";s.coreprops.length&&(d=Le(e,mr(s.coreprops[0]),!0),d&&(x=e0(d)),s.extprops.length!==0&&(d=Le(e,mr(s.extprops[0]),!0),d&&Jo(d,x,t)));var p={};(!t.bookSheets||t.bookProps)&&s.custprops.length!==0&&(d=ur(e,mr(s.custprops[0]),!0),d&&(p=Qo(d,t)));var m={};if((t.bookSheets||t.bookProps)&&(o.Sheets?i=o.Sheets.map(function(X){return X.name}):x.Worksheets&&x.SheetNames.length>0&&(i=x.SheetNames),t.bookProps&&(m.Props=x,m.Custprops=p),t.bookSheets&&typeof i<"u"&&(m.SheetNames=i),t.bookSheets?m.SheetNames:t.bookProps))return m;i={};var u={};t.bookDeps&&s.calcchain&&(u=fp(Le(e,mr(s.calcchain)),s.calcchain));var g=0,_={},F,y;{var E=o.Sheets;x.Worksheets=E.length,x.SheetNames=[];for(var D=0;D!=E.length;++D)x.SheetNames[D]=E[D].name}var R=n?"bin":"xml",T=s.workbooks[0].lastIndexOf("/"),M=(s.workbooks[0].slice(0,T+1)+"_rels/"+s.workbooks[0].slice(T+1)+".rels").replace(/^\//,"");vr(e,M)||(M="xl/_rels/workbook."+R+".rels");var I=$t(ur(e,M,!0),M.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(t.xlmeta=up(Le(e,mr(s.metadata[0])),s.metadata[0],t)),(s.people||[]).length>=1&&(t.people=sx(Le(e,mr(s.people[0])),t)),I&&(I=Kp(I,o.Sheets));var V=Le(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(g=0;g!=x.Worksheets;++g){var L="sheet";if(I&&I[g]?(F="xl/"+I[g][1].replace(/[\/]?xl\//,""),vr(e,F)||(F=I[g][1]),vr(e,F)||(F=M.replace(/_rels\/.*$/,"")+I[g][1]),L=I[g][2]):(F="xl/worksheets/sheet"+(g+1-V)+"."+R,F=F.replace(/sheet0\./,"sheet.")),y=F.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(g!=t.sheets)continue e;break;case"string":if(x.SheetNames[g].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var P=!1,J=0;J!=t.sheets.length;++J)typeof t.sheets[J]=="number"&&t.sheets[J]==g&&(P=1),typeof t.sheets[J]=="string"&&t.sheets[J].toLowerCase()==x.SheetNames[g].toLowerCase()&&(P=1);if(!P)continue e}}qp(e,F,y,x.SheetNames[g],g,_,i,L,t,o,h,f)}return m={Directory:s,Workbook:o,Props:x,Custprops:p,Deps:u,Sheets:i,SheetNames:x.SheetNames,Strings:Xt,Styles:f,Themes:h,SSF:Ye(me)},t&&t.bookFiles&&(e.files?(m.keys=a,m.files=e.files):(m.keys=[],m.files={},e.FullPaths.forEach(function(Y,X){Y=Y.replace(/^Root Entry[\/]/,""),m.keys.push(Y),m.files[Y]=e.FileIndex[X]}))),t&&t.bookVBA&&(s.vba.length>0?m.vbaraw=Le(e,mr(s.vba[0]),!0):s.defaults&&s.defaults.bin===lx&&(m.vbaraw=Le(e,"xl/vbaProject.bin",!0))),m}function Zp(e,t){var r=t||{},a="Workbook",s=we.find(e,a);try{if(a="/!DataSpaces/Version",s=we.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(Wh(s.content),a="/!DataSpaces/DataSpaceMap",s=we.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);var n=zh(s.content);if(n.length!==1||n[0].comps.length!==1||n[0].comps[0].t!==0||n[0].name!=="StrongEncryptionDataSpace"||n[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=we.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);var i=Yh(s.content);if(i.length!=1||i[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=we.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);Kh(s.content)}catch{}if(a="/EncryptionInfo",s=we.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);var c=qh(s.content);if(a="/EncryptedPackage",s=we.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(c[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(c[1],s.content,r.password||"",r);if(c[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(c[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function Ms(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=xr(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function Qp(e,t){return we.find(e,"EncryptedPackage")?Zp(e,t):L0(e,t)}function em(e,t){var r,a=e,s=t||{};return s.type||(s.type=ye&&Buffer.isBuffer(e)?"buffer":"base64"),r=Ri(a,s),Jp(r,s)}function H0(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return ns(e.slice(r),t);default:break e}return ra.to_workbook(e,t)}function rm(e,t){var r="",a=Ms(e,t);switch(t.type){case"base64":r=xr(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=ht(e);break;default:throw new Error("Unrecognized type "+t.type)}return a[0]==239&&a[1]==187&&a[2]==191&&(r=Se(r)),t.type="binary",H0(r,t)}function tm(e,t){var r=e;return t.type=="base64"&&(r=xr(r)),r=Kr.utils.decode(1200,r.slice(2),"str"),t.type="binary",H0(r,t)}function am(e){return e.match(/[^\x00-\x7F]/)?Vt(e):e}function qa(e,t,r,a){return a?(r.type="string",ra.to_workbook(e,r)):ra.to_workbook(t,r)}function os(e,t){ui();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return os(new Uint8Array(e),(r=Ye(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var a=e,s=[0,0,0,0],n=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),bt={},r.dateNF&&(bt.dateNF=r.dateNF),r.type||(r.type=ye&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=ye?"buffer":"binary",a=Gl(e),typeof Uint8Array<"u"&&!ye&&(r.type="array")),r.type=="string"&&(n=!0,r.type="binary",r.codepage=65001,a=am(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var i=new ArrayBuffer(3),c=new Uint8Array(i);if(c.foo="bar",!c.foo)return r=Ye(r),r.type="array",os(ps(a),r)}switch((s=Ms(a,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return Qp(we.read(a,r),r);break;case 9:if(s[1]<=8)return L0(a,r);break;case 60:return ns(a,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return Rh(a,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return Ch.to_workbook(a,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?em(a,r):qa(e,a,r,n);case 239:return s[3]===60?ns(a,r):qa(e,a,r,n);case 255:if(s[1]===254)return tm(a,r);if(s[1]===0&&s[2]===2&&s[3]===0)return Yt.to_workbook(a,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return Yt.to_workbook(a,r);break;case 3:case 131:case 139:case 140:return Pn.to_workbook(a,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return lu.to_workbook(a,r);break;case 10:case 13:case 32:return rm(a,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return Sh.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?Pn.to_workbook(a,r):qa(e,a,r,n)}function sm(e,t,r,a,s,n,i,c){var h=Xe(r),f=c.defval,o=c.raw||!Object.prototype.hasOwnProperty.call(c,"raw"),x=!0,d=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(d,"__rowNum__",{value:r,enumerable:!1})}catch{d.__rowNum__=r}else d.__rowNum__=r;if(!i||e[r])for(var p=t.s.c;p<=t.e.c;++p){var m=i?e[r][p]:e[a[p]+h];if(m===void 0||m.t===void 0){if(f===void 0)continue;n[p]!=null&&(d[n[p]]=f);continue}var u=m.v;switch(m.t){case"z":if(u==null)break;continue;case"e":u=u==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+m.t)}if(n[p]!=null){if(u==null)if(m.t=="e"&&u===null)d[n[p]]=null;else if(f!==void 0)d[n[p]]=f;else if(o&&u===null)d[n[p]]=null;else continue;else d[n[p]]=o&&(m.t!=="n"||m.t==="n"&&c.rawNumbers!==!1)?u:Wr(m,u,c);u!=null&&(x=!1)}}return{row:d,isempty:x}}function fs(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},a=0,s=1,n=[],i=0,c="",h={s:{r:0,c:0},e:{r:0,c:0}},f=t||{},o=f.range!=null?f.range:e["!ref"];switch(f.header===1?a=1:f.header==="A"?a=2:Array.isArray(f.header)?a=3:f.header==null&&(a=0),typeof o){case"string":h=De(o);break;case"number":h=De(e["!ref"]),h.s.r=o;break;default:h=o}a>0&&(s=0);var x=Xe(h.s.r),d=[],p=[],m=0,u=0,g=Array.isArray(e),_=h.s.r,F=0,y={};g&&!e[_]&&(e[_]=[]);var E=f.skipHidden&&e["!cols"]||[],D=f.skipHidden&&e["!rows"]||[];for(F=h.s.c;F<=h.e.c;++F)if(!(E[F]||{}).hidden)switch(d[F]=He(F),r=g?e[_][F]:e[d[F]+x],a){case 1:n[F]=F-h.s.c;break;case 2:n[F]=d[F];break;case 3:n[F]=f.header[F-h.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),c=i=Wr(r,null,f),u=y[i]||0,!u)y[i]=1;else{do c=i+"_"+u++;while(y[c]);y[i]=u,y[c]=1}n[F]=c}for(_=h.s.r+s;_<=h.e.r;++_)if(!(D[_]||{}).hidden){var R=sm(e,h,_,d,a,n,g,f);(R.isempty===!1||(a===1?f.blankrows!==!1:f.blankrows))&&(p[m++]=R.row)}return p.length=m,p}var Zn=/"/g;function nm(e,t,r,a,s,n,i,c){for(var h=!0,f=[],o="",x=Xe(r),d=t.s.c;d<=t.e.c;++d)if(a[d]){var p=c.dense?(e[r]||[])[d]:e[a[d]+x];if(p==null)o="";else if(p.v!=null){h=!1,o=""+(c.rawNumbers&&p.t=="n"?p.v:Wr(p,null,c));for(var m=0,u=0;m!==o.length;++m)if((u=o.charCodeAt(m))===s||u===n||u===34||c.forceQuotes){o='"'+o.replace(Zn,'""')+'"';break}o=="ID"&&(o='"ID"')}else p.f!=null&&!p.F?(h=!1,o="="+p.f,o.indexOf(",")>=0&&(o='"'+o.replace(Zn,'""')+'"')):o="";f.push(o)}return c.blankrows===!1&&h?null:f.join(i)}function G0(e,t){var r=[],a=t??{};if(e==null||e["!ref"]==null)return"";var s=De(e["!ref"]),n=a.FS!==void 0?a.FS:",",i=n.charCodeAt(0),c=a.RS!==void 0?a.RS:`
`,h=c.charCodeAt(0),f=new RegExp((n=="|"?"\\|":n)+"+$"),o="",x=[];a.dense=Array.isArray(e);for(var d=a.skipHidden&&e["!cols"]||[],p=a.skipHidden&&e["!rows"]||[],m=s.s.c;m<=s.e.c;++m)(d[m]||{}).hidden||(x[m]=He(m));for(var u=0,g=s.s.r;g<=s.e.r;++g)(p[g]||{}).hidden||(o=nm(e,s,g,x,i,h,n,a),o!=null&&(a.strip&&(o=o.replace(f,"")),(o||a.blankrows!==!1)&&r.push((u++?c:"")+o)));return delete a.dense,r.join("")}function im(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=G0(e,t);return r}function cm(e){var t="",r,a="";if(e==null||e["!ref"]==null)return[];var s=De(e["!ref"]),n="",i=[],c,h=[],f=Array.isArray(e);for(c=s.s.c;c<=s.e.c;++c)i[c]=He(c);for(var o=s.s.r;o<=s.e.r;++o)for(n=Xe(o),c=s.s.c;c<=s.e.c;++c)if(t=i[c]+n,r=f?(e[o]||[])[c]:e[t],a="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;a=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)a=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)a=""+r.v;else if(r.t=="b")a=r.v?"TRUE":"FALSE";else if(r.w!==void 0)a="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?a="'"+r.v:a=""+r.v}}h[h.length]=t+"="+a}return h}function W0(e,t,r){var a=r||{},s=+!a.skipHeader,n=e||{},i=0,c=0;if(n&&a.origin!=null)if(typeof a.origin=="number")i=a.origin;else{var h=typeof a.origin=="string"?ir(a.origin):a.origin;i=h.r,c=h.c}var f,o={s:{c:0,r:0},e:{c,r:i+t.length-1+s}};if(n["!ref"]){var x=De(n["!ref"]);o.e.c=Math.max(o.e.c,x.e.c),o.e.r=Math.max(o.e.r,x.e.r),i==-1&&(i=x.e.r+1,o.e.r=i+t.length-1+s)}else i==-1&&(i=0,o.e.r=t.length-1+s);var d=a.header||[],p=0;t.forEach(function(u,g){Ir(u).forEach(function(_){(p=d.indexOf(_))==-1&&(d[p=d.length]=_);var F=u[_],y="z",E="",D=de({c:c+p,r:i+g+s});f=na(n,D),F&&typeof F=="object"&&!(F instanceof Date)?n[D]=F:(typeof F=="number"?y="n":typeof F=="boolean"?y="b":typeof F=="string"?y="s":F instanceof Date?(y="d",a.cellDates||(y="n",F=lr(F)),E=a.dateNF||me[14]):F===null&&a.nullError&&(y="e",F=0),f?(f.t=y,f.v=F,delete f.w,delete f.R,E&&(f.z=E)):n[D]=f={t:y,v:F},E&&(f.z=E))})}),o.e.c=Math.max(o.e.c,c+d.length-1);var m=Xe(i);if(s)for(p=0;p<d.length;++p)n[He(p+c)+m]={t:"s",v:d[p]};return n["!ref"]=Te(o),n}function lm(e,t){return W0(null,e,t)}function na(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var a=ir(t);return e[a.r]||(e[a.r]=[]),e[a.r][a.c]||(e[a.r][a.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?na(e,de(t)):na(e,de({r:t,c:r||0}))}function om(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function Ls(){return{SheetNames:[],Sheets:{}}}function Bs(e,t,r,a){var s=1;if(!r)for(;s<=65535&&e.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(a&&e.SheetNames.indexOf(r)>=0){var n=r.match(/(^.*?)(\d+)$/);s=n&&+n[2]||0;var i=n&&n[1]||r;for(++s;s<=65535&&e.SheetNames.indexOf(r=i+s)!=-1;++s);}if(Y1(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function fm(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var a=om(e,t);switch(e.Workbook.Sheets[a]||(e.Workbook.Sheets[a]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[a].Hidden=r}function hm(e,t){return e.z=t,e}function $0(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function um(e,t,r){return $0(e,"#"+t,r)}function xm(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function dm(e,t,r,a){for(var s=typeof t!="string"?t:De(t),n=typeof t=="string"?t:Te(t),i=s.s.r;i<=s.e.r;++i)for(var c=s.s.c;c<=s.e.c;++c){var h=na(e,i,c);h.t="n",h.F=n,delete h.v,i==s.s.r&&c==s.s.c&&(h.f=r,a&&(h.D=!0))}return e}var pm={encode_col:He,encode_row:Xe,encode_cell:de,encode_range:Te,decode_col:Es,decode_row:ks,split_cell:bo,decode_cell:ir,decode_range:Rt,format_cell:Wr,sheet_add_aoa:Ki,sheet_add_json:W0,sheet_add_dom:B0,aoa_to_sheet:Dt,json_to_sheet:lm,table_to_sheet:U0,table_to_book:Rp,sheet_to_csv:G0,sheet_to_txt:im,sheet_to_json:fs,sheet_to_html:Np,sheet_to_formulae:cm,sheet_to_row_object_array:fs,sheet_get_cell:na,book_new:Ls,book_append_sheet:Bs,book_set_sheet_visibility:fm,cell_set_number_format:hm,cell_set_hyperlink:$0,cell_set_internal_link:um,cell_add_comment:xm,sheet_set_array_formula:dm,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};async function mm(e){try{console.log("📊 Parsing screened Excel dataset...");const t=os(e,{type:"array"}),r=t.SheetNames[0],a=t.Sheets[r],s=pm.sheet_to_json(a,{header:1});if(s.length<2)throw new Error("Excel file must have at least a header row and one data row");const n=s[0],i=s.slice(1);console.log(`📋 Found ${n.length} columns and ${i.length} rows in screened dataset`);const c=[];for(let h=0;h<i.length;h++){const f=i[h],o=gm(n,f);o&&c.push(o)}return console.log(`✅ Successfully parsed ${c.length} papers from screened dataset`),c}catch(t){throw console.error("❌ Error parsing Excel file:",t),new Error(`Failed to parse Excel file: ${t instanceof Error?t.message:"Unknown error"}`)}}function gm(e,t){try{const r=d=>{const m={title:["Title","Paper Title","Article Title"],author:["Author","Authors","Author(s)"],year:["Year","Publication Year","Pub Year","Date"],abstract:["Abstract","Abstract Note","Summary"],doi:["DOI","Digital Object Identifier"],url:["URL","Link","Web Link"],type:["Type","Item Type","Publication Type"],venue:["Venue","Journal","Conference","Publication","Source"],key:["Key","ID","Reference ID"],tags:["Tags","Keywords","Subject"],notes:["Notes","Comments","Screening Notes"],included:["Included","Include","Selected","Final"],quality:["Quality","Quality Score","Rating"]}[d.toLowerCase()]||[d];for(const u of m){const g=e.findIndex(_=>_&&(_.toLowerCase()===u.toLowerCase()||_.toLowerCase().includes(u.toLowerCase())));if(g>=0&&t[g]&&String(t[g]).trim())return String(t[g]).trim()}return""},a=r("title");if(!a)return null;const s=r("year"),n=vm(s),i=r("author"),c=ym(i),h=r("tags"),f=Tm(h);return{key:r("key")||_m(a,c[0]),itemType:r("type")||"article",publicationYear:n,authors:c,title:a,publicationTitle:r("venue"),doi:r("doi"),url:r("url"),abstract:r("abstract"),tags:f,venue:r("venue")}}catch(r){return console.warn("⚠️ Error parsing Excel row:",r),null}}function vm(e){if(!e)return null;const t=String(e).match(/\b(19|20)\d{2}\b/);if(t){const r=parseInt(t[0]);if(r>=1990&&r<=2025)return r}return null}function ym(e){return e?String(e).split(/[;,&]|and\s+|\n/).map(t=>t.trim()).filter(t=>t.length>0).map(t=>wm(t)):[]}function wm(e){return e.replace(/^(Dr\.|Prof\.|Mr\.|Ms\.|Mrs\.)\s*/i,"").replace(/\s*(Jr\.|Sr\.|III|IV)\.?$/i,"").trim()}function Tm(e){return e?String(e).split(/[;,\n]/).map(t=>t.trim()).filter(t=>t.length>0):[]}function _m(e,t){const r=e.toLowerCase().split(/\s+/).slice(0,3);return`${(t&&t.split(" ").pop()||"").toLowerCase()}_${r.join("_")}`.replace(/[^a-z0-9_]/g,"")}function km(){return Qa([{key:"moore2024security",itemType:"article",publicationYear:2024,authors:["Tyler Moore","John Smith"],title:"Economic Incentives in Cybersecurity: A Game-Theoretic Analysis",publicationTitle:"Journal of Cybersecurity Economics",doi:"10.1000/sample.2024.001",url:"https://example.com/paper1",abstract:"This paper analyzes the economic incentives that drive cybersecurity decisions using game theory. We examine how rational actors make security investment decisions under uncertainty and propose mechanisms to align individual incentives with collective security goals.",tags:["cybersecurity","economics","game theory"],venue:"Journal of Cybersecurity Economics"},{key:"anderson2023ai",itemType:"inproceedings",publicationYear:2023,authors:["Ross Anderson","Alice Johnson"],title:"AI Security Economics: Market Failures and Policy Interventions",publicationTitle:"Proceedings of Security Economics Workshop",doi:"10.1000/sample.2023.002",url:"https://example.com/paper2",abstract:"We examine market failures in AI security and propose policy interventions to address coordination problems. The paper analyzes how information asymmetries and externalities lead to underinvestment in AI safety measures.",tags:["AI security","market failure","policy"],venue:"Security Economics Workshop"},{key:"huang2022network",itemType:"article",publicationYear:2022,authors:["Ken Huang","Maria Garcia"],title:"Network Security Games with Incomplete Information",publicationTitle:"IEEE Transactions on Information Forensics and Security",doi:"10.1000/sample.2022.003",url:"https://example.com/paper3",abstract:"This work studies network security games where players have incomplete information about threats and other players strategies. We develop equilibrium concepts for these games and analyze their implications for network defense.",tags:["network security","incomplete information","game theory"],venue:"IEEE Transactions on Information Forensics and Security"},{key:"chen2021adversarial",itemType:"article",publicationYear:2021,authors:["Wei Chen","Sarah Davis"],title:"Adversarial Machine Learning: Economic Perspectives on Defense Strategies",publicationTitle:"AI Security Review",doi:"10.1000/sample.2021.004",url:"https://example.com/paper4",abstract:"We analyze adversarial machine learning from an economic perspective, examining the costs and benefits of different defense strategies. The paper proposes a framework for optimal resource allocation in ML security.",tags:["adversarial ML","defense strategies","economics"],venue:"AI Security Review"},{key:"wilson2020privacy",itemType:"inproceedings",publicationYear:2020,authors:["Michael Wilson","Lisa Brown"],title:"Privacy Economics in the Age of AI: A Game-Theoretic Analysis",publicationTitle:"Conference on Privacy and Security",doi:"10.1000/sample.2020.005",url:"https://example.com/paper5",abstract:"This paper examines privacy economics in AI systems using game theory. We model the strategic interactions between data subjects, AI companies, and regulators in privacy protection scenarios.",tags:["privacy","AI economics","regulation"],venue:"Conference on Privacy and Security"},{key:"taylor2019blockchain",itemType:"article",publicationYear:2019,authors:["Robert Taylor","Emma White"],title:"Blockchain Security Economics: Incentive Mechanisms and Attack Models",publicationTitle:"Blockchain Economics Journal",doi:"10.1000/sample.2019.006",url:"https://example.com/paper6",abstract:"We study the economic incentives in blockchain systems and analyze various attack models. The paper examines how consensus mechanisms align individual incentives with network security goals.",tags:["blockchain","incentive mechanisms","security"],venue:"Blockchain Economics Journal"}])}async function Em(){try{console.log("🔄 Loading research literature dataset...");let e=[];try{console.log("📄 Loading raw CSV data...");const i=await fetch("/raw-data.csv");if(i.ok){const c=await i.text();console.log(`📋 CSV file loaded, size: ${c.length} characters`),e=al(c),console.log(`📋 Successfully parsed ${e.length} papers from raw dataset`)}else throw new Error(`Raw CSV not accessible: ${i.status}`)}catch(i){throw console.error("❌ Could not load CSV file:",i),i}let t=[];try{console.log("📊 Attempting to load systematically screened dataset...");const i=await fetch("/screened-data.xlsx");if(i.ok){const c=await i.arrayBuffer();t=await mm(c),console.log(`✅ Successfully loaded ${t.length} papers from screened dataset`)}else console.warn(`⚠️ Screened dataset not accessible: ${i.status}`)}catch(i){console.warn("⚠️ Could not load screened dataset:",i)}if(e.length===0)throw new Error("No papers could be loaded from raw dataset");const r=Qa(e),a=t.length>0?Qa(t):r,s=t.length>0?a:r,n=t.length>0?"Systematically screened dataset":"Raw dataset";return console.log("🎉 SUCCESS: Research data loaded and ready!"),console.log(`📊 Primary Dataset: ${n}`),console.log(`📈 Papers: ${s.papers.length}`),console.log(`👥 Authors: ${s.authorNetwork.length}`),console.log(`🔗 Topics: ${s.topicClusters.length}`),console.log(`📅 Year Range: ${s.yearRange[0]}-${s.yearRange[1]}`),{rawData:r,screenedData:a,combinedData:s}}catch(e){console.error("❌ Error loading research data:",e),console.log("🔄 Falling back to sample data for demonstration");const t=km();return{rawData:t,screenedData:t,combinedData:t}}}const kr=({end:e,duration:t=2e3,suffix:r="",decimals:a=0})=>{const[s,n]=fe.useState(0);return fe.useEffect(()=>{let i,c;const h=f=>{i||(i=f);const o=Math.min((f-i)/t,1);n(e*o),o<1&&(c=requestAnimationFrame(h))};return c=requestAnimationFrame(h),()=>cancelAnimationFrame(c)},[e,t]),l.jsxs("span",{children:[a>0?s.toFixed(a):Math.floor(s).toLocaleString(),r]})},Qn=({data:e})=>{fe.useState("papers");const t=new Date().getFullYear(),a=e.papers.filter(o=>o.publicationYear&&o.publicationYear>=t-5).length/e.papers.length*100,s=e.papers.reduce((o,x)=>{const d=x.itemType||"other";return o[d]=(o[d]||0)+1,o},{}),n=Object.entries(s).map(([o,x])=>({name:o.charAt(0).toUpperCase()+o.slice(1),value:x,percentage:(x/e.papers.length*100).toFixed(1)})),i=e.papers.filter(o=>o.publicationYear).reduce((o,x)=>{const d=x.publicationYear;return o[d]=(o[d]||0)+1,o},{}),c=Object.entries(i).map(([o,x])=>({year:parseInt(o),papers:x})).sort((o,x)=>o.year-x.year).slice(-10),h=e.venueStats.slice(0,8),f=["#0088FE","#00C49F","#FFBB28","#FF8042","#8884D8","#82CA9D","#FFC658","#FF7C7C"];return l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[l.jsxs("div",{className:"bg-gradient-to-br from-blue-500 to-blue-600 text-white rounded-lg p-6 shadow-lg",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-blue-100 text-sm font-medium",children:"Total Papers"}),l.jsx("p",{className:"text-3xl font-bold",children:l.jsx(kr,{end:e.papers.length})})]}),l.jsx("div",{className:"bg-blue-400 bg-opacity-30 rounded-full p-3",children:l.jsx("svg",{className:"w-8 h-8",fill:"currentColor",viewBox:"0 0 20 20",children:l.jsx("path",{d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})})]}),l.jsxs("div",{className:"mt-4 text-blue-100 text-sm",children:["Spanning ",e.yearRange[1]-e.yearRange[0]," years (",e.yearRange[0],"-",e.yearRange[1],")"]})]}),l.jsxs("div",{className:"bg-gradient-to-br from-green-500 to-green-600 text-white rounded-lg p-6 shadow-lg",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-green-100 text-sm font-medium",children:"Unique Authors"}),l.jsx("p",{className:"text-3xl font-bold",children:l.jsx(kr,{end:e.authorNetwork.length})})]}),l.jsx("div",{className:"bg-green-400 bg-opacity-30 rounded-full p-3",children:l.jsx("svg",{className:"w-8 h-8",fill:"currentColor",viewBox:"0 0 20 20",children:l.jsx("path",{d:"M13 6a3 3 0 11-6 0 3 3 0 016 0zM18 8a2 2 0 11-4 0 2 2 0 014 0zM14 15a4 4 0 00-8 0v3h8v-3z"})})})]}),l.jsx("div",{className:"mt-4 text-green-100 text-sm",children:"Research community network"})]}),l.jsxs("div",{className:"bg-gradient-to-br from-purple-500 to-purple-600 text-white rounded-lg p-6 shadow-lg",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-purple-100 text-sm font-medium",children:"Research Topics"}),l.jsx("p",{className:"text-3xl font-bold",children:l.jsx(kr,{end:e.topicClusters.length})})]}),l.jsx("div",{className:"bg-purple-400 bg-opacity-30 rounded-full p-3",children:l.jsx("svg",{className:"w-8 h-8",fill:"currentColor",viewBox:"0 0 20 20",children:l.jsx("path",{d:"M3 4a1 1 0 011-1h12a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1V4zM3 10a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H4a1 1 0 01-1-1v-6zM14 9a1 1 0 00-1 1v6a1 1 0 001 1h2a1 1 0 001-1v-6a1 1 0 00-1-1h-2z"})})})]}),l.jsx("div",{className:"mt-4 text-purple-100 text-sm",children:"Thematic coverage areas"})]}),l.jsxs("div",{className:"bg-gradient-to-br from-orange-500 to-orange-600 text-white rounded-lg p-6 shadow-lg",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-orange-100 text-sm font-medium",children:"Recent Papers"}),l.jsx("p",{className:"text-3xl font-bold",children:l.jsx(kr,{end:a,decimals:1,suffix:"%"})})]}),l.jsx("div",{className:"bg-orange-400 bg-opacity-30 rounded-full p-3",children:l.jsx("svg",{className:"w-8 h-8",fill:"currentColor",viewBox:"0 0 20 20",children:l.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z",clipRule:"evenodd"})})})]}),l.jsx("div",{className:"mt-4 text-orange-100 text-sm",children:"Published in last 5 years"})]})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Data Quality Indicators"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-2xl font-bold text-blue-600",children:l.jsx(kr,{end:e.qualityMetrics.doiCoverage,decimals:1,suffix:"%"})}),l.jsx("div",{className:"text-sm text-gray-600",children:"DOI Coverage"}),l.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-2",children:l.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-1000",style:{width:`${e.qualityMetrics.doiCoverage}%`}})})]}),l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-2xl font-bold text-green-600",children:l.jsx(kr,{end:e.qualityMetrics.urlCoverage,decimals:1,suffix:"%"})}),l.jsx("div",{className:"text-sm text-gray-600",children:"URL Coverage"}),l.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-2",children:l.jsx("div",{className:"bg-green-600 h-2 rounded-full transition-all duration-1000",style:{width:`${e.qualityMetrics.urlCoverage}%`}})})]}),l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-2xl font-bold text-purple-600",children:l.jsx(kr,{end:e.qualityMetrics.abstractCoverage,decimals:1,suffix:"%"})}),l.jsx("div",{className:"text-sm text-gray-600",children:"Abstract Coverage"}),l.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-2",children:l.jsx("div",{className:"bg-purple-600 h-2 rounded-full transition-all duration-1000",style:{width:`${e.qualityMetrics.abstractCoverage}%`}})})]}),l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-2xl font-bold text-orange-600",children:l.jsx(kr,{end:a,decimals:1,suffix:"%"})}),l.jsx("div",{className:"text-sm text-gray-600",children:"Recent Papers"}),l.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-2",children:l.jsx("div",{className:"bg-orange-600 h-2 rounded-full transition-all duration-1000",style:{width:`${a}%`}})})]})]})]}),l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[l.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Publication Types"}),l.jsx(Ur,{width:"100%",height:300,children:l.jsxs(ri,{children:[l.jsx(ti,{data:n,cx:"50%",cy:"50%",labelLine:!1,label:({name:o,percentage:x})=>`${o} (${x}%)`,outerRadius:80,fill:"#8884d8",dataKey:"value",children:n.map((o,x)=>l.jsx(ai,{fill:f[x%f.length]},`cell-${x}`))}),l.jsx(Vr,{})]})})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Publication Trend (Last 10 Years)"}),l.jsx(Ur,{width:"100%",height:300,children:l.jsxs(si,{data:c,children:[l.jsx(Jt,{strokeDasharray:"3 3"}),l.jsx(At,{dataKey:"year"}),l.jsx(St,{}),l.jsx(Vr,{}),l.jsx(ni,{type:"monotone",dataKey:"papers",stroke:"#8884d8",strokeWidth:2,dot:{fill:"#8884d8",strokeWidth:2,r:4}})]})})]})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Top Publication Venues"}),l.jsx(Ur,{width:"100%",height:400,children:l.jsxs(hs,{data:h,layout:"horizontal",children:[l.jsx(Jt,{strokeDasharray:"3 3"}),l.jsx(At,{type:"number"}),l.jsx(St,{dataKey:"name",type:"category",width:200}),l.jsx(Vr,{}),l.jsx(us,{dataKey:"paperCount",fill:"#8884d8"})]})})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Research Topic Coverage"}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:e.topicClusters.slice(0,6).map((o,x)=>l.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[l.jsxs("div",{className:"flex justify-between items-center mb-2",children:[l.jsx("h4",{className:"font-medium text-gray-900",children:o.label}),l.jsxs("span",{className:"text-sm font-semibold text-blue-600",children:[o.coverage.toFixed(1),"%"]})]}),l.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3 mb-2",children:l.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-blue-600 h-3 rounded-full transition-all duration-1000",style:{width:`${Math.min(100,o.coverage)}%`}})}),l.jsxs("div",{className:"text-sm text-gray-600",children:[o.size," papers"]})]},o.id))})]}),l.jsxs("div",{className:"bg-gradient-to-r from-gray-50 to-gray-100 rounded-lg p-6",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Research Impact Summary"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-3xl font-bold text-indigo-600 mb-2",children:l.jsx(kr,{end:e.venueStats.length})}),l.jsx("div",{className:"text-sm text-gray-600",children:"Publication Venues"}),l.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Diverse outlet coverage"})]}),l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-3xl font-bold text-teal-600 mb-2",children:l.jsx(kr,{end:e.yearRange[1]-e.yearRange[0]})}),l.jsx("div",{className:"text-sm text-gray-600",children:"Years Covered"}),l.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Comprehensive temporal scope"})]}),l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-3xl font-bold text-rose-600 mb-2",children:l.jsx(kr,{end:e.papers.reduce((o,x)=>o+x.authors.length,0)/e.papers.length,decimals:1})}),l.jsx("div",{className:"text-sm text-gray-600",children:"Avg Authors/Paper"}),l.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Collaboration indicator"})]})]})]})]})},bm=({papers:e,onYearRangeChange:t,selectedYearRange:r})=>{const a=fe.useRef(null),[s,n]=fe.useState(null),[i,c]=fe.useState({x:0,y:0});fe.useEffect(()=>{if(!a.current||e.length===0)return;const o=_t(a.current);o.selectAll("*").remove();const x=h(e),d={top:20,right:30,bottom:40,left:50},p=800-d.left-d.right,m=400-d.top-d.bottom,u=o.attr("width",p+d.left+d.right).attr("height",m+d.top+d.bottom).append("g").attr("transform",`translate(${d.left},${d.top})`),g=zs().domain(Ec(x,T=>T.year)).range([0,p]),_=zs().domain([0,Ja(x,T=>T.paperCount)||0]).range([m,0]),F=ii().domain([0,Ja(x,T=>T.paperCount)||0]).range([3,20]),y=ci(li);u.append("g").attr("transform",`translate(0,${m})`).call(bc(g).tickFormat(Ac("d"))),u.append("g").call(Sc(_)),u.append("text").attr("transform","rotate(-90)").attr("y",0-d.left).attr("x",0-m/2).attr("dy","1em").style("text-anchor","middle").text("Number of Papers"),u.append("text").attr("transform",`translate(${p/2}, ${m+d.bottom})`).style("text-anchor","middle").text("Publication Year"),u.selectAll(".bubble").data(x).enter().append("circle").attr("class","bubble").attr("cx",T=>g(T.year)).attr("cy",T=>_(T.paperCount)).attr("r",T=>F(T.paperCount)).attr("fill",(T,M)=>y(M.toString())).attr("opacity",.7).attr("stroke","#333").attr("stroke-width",1).style("cursor","pointer").on("mouseover",function(T,M){_t(this).transition().duration(200).attr("opacity",1).attr("stroke-width",2),n(M),c({x:T.pageX,y:T.pageY})}).on("mousemove",function(T){c({x:T.pageX,y:T.pageY})}).on("mouseout",function(){_t(this).transition().duration(200).attr("opacity",.7).attr("stroke-width",1),n(null)}).on("click",function(T,M){t&&t(M.year,M.year)}),[{year:2024,papers:86,label:"2024 Peak"},{year:2018,papers:64,label:"2018 Surge"}].forEach(({year:T,label:M})=>{const I=x.find(V=>V.year===T);I&&u.append("text").attr("x",g(T)).attr("y",_(I.paperCount)-25).attr("text-anchor","middle").attr("font-size","12px").attr("font-weight","bold").attr("fill","#d32f2f").text(M)});const R=Fc().extent([[0,0],[p,m]]).on("end",function(T){if(!T.selection)return;const[M,I]=T.selection,V=Math.round(g.invert(M)),L=Math.round(g.invert(I));t&&t(V,L)});u.append("g").attr("class","brush").call(R)},[e,r]);const h=o=>{const x=new Map;return o.forEach(d=>{d.publicationYear&&(x.has(d.publicationYear)||x.set(d.publicationYear,[]),x.get(d.publicationYear).push(d))}),Array.from(x.entries()).map(([d,p])=>({year:d,paperCount:p.length,papers:p,topTopics:f(p)})).sort((d,p)=>d.year-p.year)},f=o=>{const x=new Map;return o.forEach(d=>{d.tags.forEach(p=>{x.set(p,(x.get(p)||0)+1)})}),Array.from(x.entries()).sort((d,p)=>p[1]-d[1]).slice(0,3).map(([d])=>d)};return l.jsxs("div",{className:"relative",children:[l.jsx("svg",{ref:a,className:"w-full h-auto"}),s&&l.jsxs("div",{className:"absolute bg-white border border-gray-300 rounded-lg p-3 shadow-lg z-10 pointer-events-none",style:{left:i.x+10,top:i.y-10,transform:"translate(-50%, -100%)"},children:[l.jsx("div",{className:"font-semibold text-gray-900",children:s.year}),l.jsxs("div",{className:"text-sm text-gray-600",children:[s.paperCount," papers"]}),s.topTopics.length>0&&l.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Top topics: ",s.topTopics.join(", ")]}),l.jsx("div",{className:"text-xs text-gray-400 mt-1",children:"Click to filter by this year"})]})]})};const Am=({data:e})=>{const t=Math.max(40,Math.min(120,e.size*2)),r=Math.max(10,Math.min(14,t/8));return l.jsxs("div",{className:`relative flex items-center justify-center rounded-full border-2 cursor-pointer transition-all duration-200 ${e.isSelected?"border-blue-600 bg-blue-100 shadow-lg scale-110":"border-gray-400 bg-white hover:border-blue-400 hover:shadow-md hover:scale-105"}`,style:{width:t,height:t},onClick:e.onClick,children:[l.jsx(Ws,{type:"target",position:$s.Top,className:"opacity-0"}),l.jsx(Ws,{type:"source",position:$s.Bottom,className:"opacity-0"}),l.jsxs("div",{className:"text-center p-1",children:[l.jsx("div",{className:"font-semibold text-gray-800 leading-tight",style:{fontSize:`${r}px`},children:e.label}),l.jsxs("div",{className:"text-gray-600 text-xs mt-1",style:{fontSize:`${r-2}px`},children:[e.coverage.toFixed(1),"%"]})]}),l.jsx("div",{className:"absolute inset-0 rounded-full border-4 opacity-30",style:{borderColor:Sm(e.coverage),borderWidth:Math.max(2,t/20)}})]})},Sm=e=>e>=70?"#ef4444":e>=50?"#f97316":e>=30?"#eab308":e>=15?"#22c55e":"#6366f1",Fm={topicNode:Am},Cm=({topicClusters:e,onTopicSelect:t,selectedTopic:r})=>{const[a,s,n]=hc([]),[i,c,h]=uc([]),[f,o]=fe.useState(null),x=fe.useCallback(p=>c(m=>xc(p,m)),[c]);fe.useEffect(()=>{if(e.length===0)return;const p=e.map((u,g)=>{const _=g/e.length*2*Math.PI,F=200,y=400+F*Math.cos(_),E=300+F*Math.sin(_);return{id:u.id,type:"topicNode",position:{x:y,y:E},data:{label:u.label,size:u.size,coverage:u.coverage,paperCount:u.papers.length,isSelected:r===u.id,onClick:()=>d(u)},draggable:!0}}),m=[];e.forEach(u=>{u.connections.forEach(g=>{const _=e.find(F=>F.id===g);if(_){const y=u.papers.filter(D=>_.papers.some(R=>R.key===D.key)).length/Math.min(u.size,_.size);!m.some(D=>D.source===u.id&&D.target===g||D.source===g&&D.target===u.id)&&y>.1&&m.push({id:`${u.id}-${g}`,source:u.id,target:g,style:{strokeWidth:Math.max(1,y*8),stroke:"#94a3b8",opacity:.6},animated:!1})}})}),s(p),c(m)},[e,r]);const d=p=>{o(p),t&&t(p.id,p.papers)};return l.jsxs("div",{className:"w-full h-96 border border-gray-300 rounded-lg relative",children:[l.jsxs(dc,{nodes:a,edges:i,onNodesChange:n,onEdgesChange:h,onConnect:x,nodeTypes:Fm,fitView:!0,attributionPosition:"bottom-left",children:[l.jsx(pc,{}),l.jsx(mc,{})]}),f&&l.jsxs("div",{className:"absolute top-4 right-4 bg-white border border-gray-300 rounded-lg p-4 shadow-lg max-w-xs z-10",children:[l.jsxs("div",{className:"flex justify-between items-start mb-2",children:[l.jsx("h3",{className:"font-semibold text-gray-900",children:f.label}),l.jsx("button",{onClick:()=>o(null),className:"text-gray-400 hover:text-gray-600",children:"×"})]}),l.jsxs("div",{className:"space-y-2 text-sm",children:[l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-gray-600",children:"Papers:"}),l.jsx("span",{className:"font-medium",children:f.size})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-gray-600",children:"Coverage:"}),l.jsxs("span",{className:"font-medium",children:[f.coverage.toFixed(1),"%"]})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-gray-600",children:"Connections:"}),l.jsx("span",{className:"font-medium",children:f.connections.length})]})]}),f.connections.length>0&&l.jsxs("div",{className:"mt-3",children:[l.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Connected Topics:"}),l.jsxs("div",{className:"flex flex-wrap gap-1",children:[f.connections.slice(0,3).map(p=>{const m=e.find(u=>u.id===p);return m?l.jsx("span",{className:"px-2 py-1 bg-gray-100 text-xs rounded cursor-pointer hover:bg-gray-200",onClick:()=>d(m),children:m.label},p):null}),f.connections.length>3&&l.jsxs("span",{className:"text-xs text-gray-400",children:["+",f.connections.length-3," more"]})]})]}),l.jsxs("div",{className:"mt-3 pt-2 border-t border-gray-200",children:[l.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Recent Papers:"}),l.jsxs("div",{className:"max-h-20 overflow-y-auto",children:[f.papers.slice(0,3).map(p=>l.jsx("div",{className:"text-xs text-gray-700 mb-1 truncate",children:p.title},p.key)),f.papers.length>3&&l.jsxs("div",{className:"text-xs text-gray-400",children:["+",f.papers.length-3," more papers"]})]})]})]}),l.jsxs("div",{className:"absolute bottom-4 left-4 bg-white border border-gray-300 rounded-lg p-3 shadow-lg",children:[l.jsx("div",{className:"text-sm font-semibold text-gray-900 mb-2",children:"Topic Coverage"}),l.jsxs("div",{className:"space-y-1 text-xs",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-3 h-3 rounded-full border-2",style:{borderColor:"#ef4444"}}),l.jsx("span",{children:"70%+ High Impact"})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-3 h-3 rounded-full border-2",style:{borderColor:"#f97316"}}),l.jsx("span",{children:"50-70% Major"})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-3 h-3 rounded-full border-2",style:{borderColor:"#eab308"}}),l.jsx("span",{children:"30-50% Moderate"})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-3 h-3 rounded-full border-2",style:{borderColor:"#22c55e"}}),l.jsx("span",{children:"15-30% Emerging"})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-3 h-3 rounded-full border-2",style:{borderColor:"#6366f1"}}),l.jsx("span",{children:"<15% Niche"})]})]})]})]})},Nm=({authors:e,onAuthorSelect:t,selectedAuthor:r,maxAuthors:a=50})=>{const s=fe.useRef(null),[n,i]=fe.useState(null),[c,h]=fe.useState({x:0,y:0}),[f,o]=fe.useState(""),[x,d]=fe.useState([]);return fe.useEffect(()=>{const p=e.filter(m=>m.name.toLowerCase().includes(f.toLowerCase())||m.primaryTopics.some(u=>u.toLowerCase().includes(f.toLowerCase())));d(p.slice(0,a))},[e,f,a]),fe.useEffect(()=>{if(!s.current||x.length===0)return;const p=_t(s.current);p.selectAll("*").remove();const m=800,u=600;p.attr("width",m).attr("height",u);const g=["tyler moore","ross anderson","ken huang","quanyan zhu"],_=x.map(Y=>({id:Y.id,name:Y.name,paperCount:Y.paperCount,influence:Y.influence,primaryTopics:Y.primaryTopics,isProlific:g.some(X=>Y.name.toLowerCase().includes(X))})),F=[];_.forEach((Y,X)=>{_.slice(X+1).forEach(re=>{const ne=Y.primaryTopics.filter(be=>re.primaryTopics.includes(be));ne.length>0&&Math.random()<.1&&F.push({source:Y.id,target:re.id,weight:ne.length})})});const y=ii().domain([0,Ja(_,Y=>Y.paperCount)||1]).range([3,15]),E=ci().domain(["Security","Economics","Game Theory","Risk","AI/ML","Network","Privacy"]).range(li),D=Cc(_).force("link",Nc(F).id(Y=>Y.id).distance(50).strength(Y=>Y.weight*.1)).force("charge",Rc().strength(-100)).force("center",Dc(m/2,u/2)).force("collision",Ic().radius(Y=>y(Y.paperCount)+2)),R=p.append("g"),T=Oc().scaleExtent([.1,4]).on("zoom",Y=>{R.attr("transform",Y.transform)});p.call(T);const M=R.append("g").attr("class","links").selectAll("line").data(F).enter().append("line").attr("stroke","#999").attr("stroke-opacity",.6).attr("stroke-width",Y=>Math.sqrt(Y.weight)),I=R.append("g").attr("class","nodes").selectAll("circle").data(_).enter().append("circle").attr("r",Y=>y(Y.paperCount)).attr("fill",Y=>Y.isProlific?"#dc2626":E(Y.primaryTopics[0]||"Other")).attr("stroke",Y=>r===Y.id?"#1d4ed8":"#fff").attr("stroke-width",Y=>r===Y.id?3:1.5).style("cursor","pointer").call(Pc().on("start",L).on("drag",P).on("end",J)),V=R.append("g").attr("class","labels").selectAll("text").data(_.filter(Y=>Y.isProlific||Y.paperCount>8)).enter().append("text").text(Y=>Y.name).attr("font-size","10px").attr("font-weight","bold").attr("text-anchor","middle").attr("dy",Y=>y(Y.paperCount)+12).attr("fill","#333").style("pointer-events","none");I.on("mouseover",function(Y,X){_t(this).transition().duration(200).attr("stroke-width",3).attr("r",y(X.paperCount)*1.2),i(X),h({x:Y.pageX,y:Y.pageY})}).on("mousemove",function(Y){h({x:Y.pageX,y:Y.pageY})}).on("mouseout",function(Y,X){_t(this).transition().duration(200).attr("stroke-width",r===X.id?3:1.5).attr("r",y(X.paperCount)),i(null)}).on("click",function(Y,X){t&&t(X.id)}),D.on("tick",()=>{M.attr("x1",Y=>Y.source.x).attr("y1",Y=>Y.source.y).attr("x2",Y=>Y.target.x).attr("y2",Y=>Y.target.y),I.attr("cx",Y=>Y.x).attr("cy",Y=>Y.y),V.attr("x",Y=>Y.x).attr("y",Y=>Y.y)});function L(Y){Y.active||D.alphaTarget(.3).restart(),Y.subject.fx=Y.subject.x,Y.subject.fy=Y.subject.y}function P(Y){Y.subject.fx=Y.x,Y.subject.fy=Y.y}function J(Y){Y.active||D.alphaTarget(0),Y.subject.fx=null,Y.subject.fy=null}return()=>{D.stop()}},[x,r,t]),l.jsxs("div",{className:"relative",children:[l.jsxs("div",{className:"mb-4 flex gap-4 items-center",children:[l.jsx("div",{className:"flex-1",children:l.jsx("input",{type:"text",placeholder:"Search authors or topics...",value:f,onChange:p=>o(p.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})}),l.jsxs("div",{className:"text-sm text-gray-600",children:["Showing ",x.length," of ",e.length," authors"]})]}),l.jsx("div",{className:"border border-gray-300 rounded-lg overflow-hidden",children:l.jsx("svg",{ref:s,className:"w-full h-auto bg-gray-50"})}),n&&l.jsxs("div",{className:"absolute bg-white border border-gray-300 rounded-lg p-3 shadow-lg z-10 pointer-events-none max-w-xs",style:{left:c.x+10,top:c.y-10,transform:"translate(-50%, -100%)"},children:[l.jsx("div",{className:"font-semibold text-gray-900",children:n.name}),l.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[n.paperCount," papers"]}),l.jsxs("div",{className:"text-sm text-gray-600",children:["Influence: ",n.influence.toFixed(1)]}),n.primaryTopics.length>0&&l.jsxs("div",{className:"text-xs text-gray-500 mt-2",children:[l.jsx("div",{className:"font-medium",children:"Primary Topics:"}),l.jsx("div",{children:n.primaryTopics.join(", ")})]}),n.isProlific&&l.jsx("div",{className:"text-xs text-red-600 font-medium mt-1",children:"Prolific Author"})]}),l.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{className:"bg-white border border-gray-300 rounded-lg p-3",children:[l.jsx("div",{className:"text-sm font-semibold text-gray-900 mb-2",children:"Node Size"}),l.jsx("div",{className:"text-xs text-gray-600",children:"Node size represents the number of papers published by each author. Larger nodes indicate more prolific authors."})]}),l.jsxs("div",{className:"bg-white border border-gray-300 rounded-lg p-3",children:[l.jsx("div",{className:"text-sm font-semibold text-gray-900 mb-2",children:"Colors & Highlights"}),l.jsxs("div",{className:"space-y-1 text-xs",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-3 h-3 rounded-full bg-red-600"}),l.jsx("span",{children:"Prolific Authors (Tyler Moore, Ross Anderson, etc.)"})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-500"}),l.jsx("span",{children:"Selected Author"})]}),l.jsx("div",{className:"text-gray-500 mt-1",children:"Other colors represent primary research topics"})]})]})]}),l.jsx("div",{className:"mt-4 bg-gray-50 rounded-lg p-4",children:l.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[l.jsxs("div",{children:[l.jsx("div",{className:"text-2xl font-bold text-blue-600",children:e.length}),l.jsx("div",{className:"text-sm text-gray-600",children:"Total Authors"})]}),l.jsxs("div",{children:[l.jsx("div",{className:"text-2xl font-bold text-green-600",children:e.filter(p=>p.paperCount>5).length}),l.jsx("div",{className:"text-sm text-gray-600",children:"Active Researchers"})]}),l.jsxs("div",{children:[l.jsx("div",{className:"text-2xl font-bold text-purple-600",children:Math.round(e.reduce((p,m)=>p+m.paperCount,0)/e.length*10)/10}),l.jsx("div",{className:"text-sm text-gray-600",children:"Avg Papers/Author"})]}),l.jsxs("div",{children:[l.jsx("div",{className:"text-2xl font-bold text-orange-600",children:e.filter(p=>p.primaryTopics.length>2).length}),l.jsx("div",{className:"text-sm text-gray-600",children:"Interdisciplinary"})]})]})})]})},Rm=({data:e})=>{const r=e.papers.length,a=(r/2500*100).toFixed(1),s=e.papers.reduce((f,o)=>{const x=o.itemType||"other";return f[x]=(f[x]||0)+1,f},{}),n=Object.entries(s).map(([f,o])=>({type:f.charAt(0).toUpperCase()+f.slice(1),count:o,percentage:(o/e.papers.length*100).toFixed(1)})),i=[{criterion:"DOI Availability",score:e.qualityMetrics.doiCoverage,description:"Papers with Digital Object Identifiers for verification",color:"bg-blue-500"},{criterion:"URL Access",score:e.qualityMetrics.urlCoverage,description:"Papers with accessible online links",color:"bg-green-500"},{criterion:"Abstract Completeness",score:e.qualityMetrics.abstractCoverage,description:"Papers with complete abstract information",color:"bg-purple-500"},{criterion:"Recent Publications",score:e.qualityMetrics.recentPapers,description:"Papers published in the last 5 years",color:"bg-orange-500"}],c=e.venueStats.slice(0,10),h=e.venueStats.reduce((f,o)=>(f[o.type]=(f[o.type]||0)+o.paperCount,f),{});return l.jsxs("div",{className:"space-y-8",children:[l.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[l.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Systematic Screening Process"}),l.jsx("div",{className:"mb-8",children:l.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between space-y-4 md:space-y-0 md:space-x-4",children:[l.jsxs("div",{className:"flex-1 text-center",children:[l.jsxs("div",{className:"bg-blue-100 border-2 border-blue-300 rounded-lg p-4 mb-2",children:[l.jsx("div",{className:"text-2xl font-bold text-blue-800",children:"2,500+"}),l.jsx("div",{className:"text-sm text-blue-600",children:"Initial Search Results"})]}),l.jsx("div",{className:"text-xs text-gray-500",children:"Database searches across multiple sources"})]}),l.jsx("div",{className:"hidden md:block text-gray-400",children:"→"}),l.jsxs("div",{className:"flex-1 text-center",children:[l.jsxs("div",{className:"bg-yellow-100 border-2 border-yellow-300 rounded-lg p-4 mb-2",children:[l.jsx("div",{className:"text-2xl font-bold text-yellow-800",children:"1,200"}),l.jsx("div",{className:"text-sm text-yellow-600",children:"Title/Abstract Screen"})]}),l.jsx("div",{className:"text-xs text-gray-500",children:"Relevance filtering"})]}),l.jsx("div",{className:"hidden md:block text-gray-400",children:"→"}),l.jsxs("div",{className:"flex-1 text-center",children:[l.jsxs("div",{className:"bg-orange-100 border-2 border-orange-300 rounded-lg p-4 mb-2",children:[l.jsx("div",{className:"text-2xl font-bold text-orange-800",children:"800"}),l.jsx("div",{className:"text-sm text-orange-600",children:"Full-Text Review"})]}),l.jsx("div",{className:"text-xs text-gray-500",children:"Detailed assessment"})]}),l.jsx("div",{className:"hidden md:block text-gray-400",children:"→"}),l.jsxs("div",{className:"flex-1 text-center",children:[l.jsxs("div",{className:"bg-green-100 border-2 border-green-300 rounded-lg p-4 mb-2",children:[l.jsx("div",{className:"text-2xl font-bold text-green-800",children:r}),l.jsx("div",{className:"text-sm text-green-600",children:"Final Dataset"})]}),l.jsx("div",{className:"text-xs text-gray-500",children:"Quality-assured papers"})]})]})}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 bg-gray-50 rounded-lg p-4",children:[l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-lg font-semibold text-gray-900",children:"Inclusion Rate"}),l.jsxs("div",{className:"text-2xl font-bold text-green-600",children:[a,"%"]}),l.jsx("div",{className:"text-sm text-gray-600",children:"Rigorous selection criteria"})]}),l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-lg font-semibold text-gray-900",children:"Time Span"}),l.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[e.yearRange[1]-e.yearRange[0]," years"]}),l.jsx("div",{className:"text-sm text-gray-600",children:"Comprehensive coverage"})]}),l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-lg font-semibold text-gray-900",children:"Quality Score"}),l.jsxs("div",{className:"text-2xl font-bold text-purple-600",children:[Math.round((e.qualityMetrics.doiCoverage+e.qualityMetrics.urlCoverage+e.qualityMetrics.abstractCoverage)/3),"%"]}),l.jsx("div",{className:"text-sm text-gray-600",children:"Overall data quality"})]})]})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[l.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Quality Assessment Criteria"}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:i.map((f,o)=>l.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[l.jsxs("div",{className:"flex justify-between items-center mb-3",children:[l.jsx("h4",{className:"font-medium text-gray-900",children:f.criterion}),l.jsxs("span",{className:"text-lg font-bold text-gray-800",children:[f.score.toFixed(1),"%"]})]}),l.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3 mb-3",children:l.jsx("div",{className:`${f.color} h-3 rounded-full transition-all duration-1000`,style:{width:`${f.score}%`}})}),l.jsx("p",{className:"text-sm text-gray-600",children:f.description})]},o))})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[l.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Source Diversity Analysis"}),l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[l.jsxs("div",{children:[l.jsx("h4",{className:"font-medium text-gray-900 mb-4",children:"Publication Types"}),l.jsx("div",{className:"space-y-3",children:n.map((f,o)=>l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:`w-4 h-4 rounded-full bg-blue-${(o+1)*100}`}),l.jsx("span",{className:"text-sm font-medium text-gray-700",children:f.type})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"text-sm text-gray-600",children:f.count}),l.jsxs("span",{className:"text-xs text-gray-500",children:["(",f.percentage,"%)"]})]})]},o))})]}),l.jsxs("div",{children:[l.jsx("h4",{className:"font-medium text-gray-900 mb-4",children:"Venue Distribution"}),l.jsx("div",{className:"space-y-3",children:Object.entries(h).map(([f,o],x)=>l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:`w-4 h-4 rounded-full bg-green-${(x+1)*100}`}),l.jsx("span",{className:"text-sm font-medium text-gray-700 capitalize",children:f})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"text-sm text-gray-600",children:o}),l.jsxs("span",{className:"text-xs text-gray-500",children:["(",(o/e.papers.length*100).toFixed(1),"%)"]})]})]},x))})]})]})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[l.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Top Publication Venues"}),l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Venue"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Papers"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Percentage"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:c.map((f,o)=>l.jsxs("tr",{className:o%2===0?"bg-white":"bg-gray-50",children:[l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:f.name||"Unknown"}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:l.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${f.type==="journal"?"bg-blue-100 text-blue-800":f.type==="conference"?"bg-green-100 text-green-800":f.type==="book"?"bg-purple-100 text-purple-800":"bg-gray-100 text-gray-800"}`,children:f.type})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:f.paperCount}),l.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[(f.paperCount/e.papers.length*100).toFixed(1),"%"]})]},o))})]})})]}),l.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg p-6 border border-blue-200",children:[l.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Methodology Rigor Summary"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-2xl font-bold text-blue-600",children:"Systematic"}),l.jsx("div",{className:"text-sm text-gray-600",children:"Search Strategy"}),l.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Multiple databases, comprehensive keywords"})]}),l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-2xl font-bold text-green-600",children:"Rigorous"}),l.jsx("div",{className:"text-sm text-gray-600",children:"Screening Process"}),l.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Multi-stage filtering with clear criteria"})]}),l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-2xl font-bold text-purple-600",children:"Transparent"}),l.jsx("div",{className:"text-sm text-gray-600",children:"Documentation"}),l.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Clear inclusion/exclusion criteria"})]}),l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-2xl font-bold text-orange-600",children:"Comprehensive"}),l.jsx("div",{className:"text-sm text-gray-600",children:"Coverage"}),l.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"35-year span, diverse sources"})]})]})]})]})};class Dm{constructor(t,r,a){Nr(this,"papers");Nr(this,"topicClusters");Nr(this,"authors");this.papers=t,this.topicClusters=r,this.authors=a}analyzeAllGaps(){const t=[];return t.push(...this.analyzeTopicalGaps()),t.push(...this.analyzeTemporalGaps()),t.push(...this.analyzeMethodologicalGaps()),t.push(...this.analyzeGeographicGaps()),t.sort((r,a)=>a.opportunityScore-r.opportunityScore)}analyzeTopicalGaps(){const t=[];this.findTopicIntersections().filter(i=>i.gapSize>5&&i.potentialImpact>.7).forEach((i,c)=>{t.push({id:`topical_${c}`,type:"topical",title:`Under-researched: ${i.combinedLabel}`,description:`The intersection of ${i.topics.join(" and ")} shows significant research potential but limited current coverage.`,severity:i.gapSize>15?"high":i.gapSize>10?"medium":"low",evidence:{underRepresentedTopics:i.topics,citationGaps:[],temporalGaps:[],potentialImpact:i.potentialImpact,supportingData:{expectedPapers:i.expectedPapers,actualPapers:i.actualPapers,gapSize:i.gapSize}},recommendations:[`Investigate ${i.combinedLabel} applications in real-world scenarios`,`Develop theoretical frameworks combining ${i.topics.join(" and ")}`,"Conduct empirical studies bridging these research areas",`Explore policy implications of ${i.combinedLabel}`],opportunityScore:i.potentialImpact*(i.gapSize/20)*100})});const s=this.identifyEmergingTopics(),n=this.identifyStagnantTopics();return n.length>0&&t.push({id:"topical_stagnant",type:"topical",title:"Stagnant Research Areas",description:"Several research areas show declining activity and may need revitalization or new approaches.",severity:"medium",evidence:{underRepresentedTopics:n,citationGaps:[],temporalGaps:[],potentialImpact:.6,supportingData:{stagnantTopics:n,emergingTopics:s}},recommendations:["Re-examine fundamental assumptions in stagnant areas","Apply new methodologies to traditional problems","Explore connections with emerging technologies","Consider interdisciplinary approaches"],opportunityScore:60}),t}analyzeTemporalGaps(){const t=[],r=this.findTemporalGaps();r.length>0&&r.filter(n=>n.gapSize>10).forEach((n,i)=>{t.push({id:`temporal_${i}`,type:"temporal",title:`Research Activity Gap (${n.startYear}-${n.endYear})`,description:`Significant reduction in research activity during ${n.startYear}-${n.endYear}, with ${n.gapSize} fewer papers than expected.`,severity:n.gapSize>20?"high":"medium",evidence:{underRepresentedTopics:[],citationGaps:[],temporalGaps:[n],potentialImpact:.5,supportingData:n},recommendations:["Investigate reasons for reduced research activity during this period","Identify if important developments were missed","Consider if external factors (funding, events) influenced research","Explore if catch-up research is needed"],opportunityScore:n.gapSize/n.expectedPapers*50})});const a=this.analyzeRecentTrend();return a.isDecline&&t.push({id:"temporal_recent_decline",type:"temporal",title:"Recent Research Decline",description:"Research activity has declined in recent years, potentially indicating field maturation or shift in focus.",severity:"medium",evidence:{underRepresentedTopics:[],citationGaps:[],temporalGaps:[],potentialImpact:.4,supportingData:a},recommendations:["Assess if decline indicates field maturation or loss of interest","Identify new directions or applications","Consider emerging technologies that might revitalize the field","Explore policy or industry developments creating new research needs"],opportunityScore:40}),t}analyzeMethodologicalGaps(){const t=[],r=this.analyzeMethodologies(),a=r.underUtilized;a.length>0&&t.push({id:"methodological_underutilized",type:"methodological",title:"Under-utilized Research Methodologies",description:"Several research methodologies are underrepresented, potentially limiting research depth and validity.",severity:"medium",evidence:{underRepresentedTopics:a,citationGaps:[],temporalGaps:[],potentialImpact:.7,supportingData:r},recommendations:["Encourage mixed-method approaches combining quantitative and qualitative research","Promote experimental and empirical studies in theoretical areas","Develop standardized evaluation frameworks","Foster collaboration between theoretical and applied researchers"],opportunityScore:70});const s=this.assessTheoreticalBias();return s.score>.7&&t.push({id:"methodological_empirical",type:"methodological",title:"Lack of Empirical Validation",description:"Research shows strong theoretical bias with limited empirical validation of proposed models and frameworks.",severity:"high",evidence:{underRepresentedTopics:["empirical studies","experimental validation"],citationGaps:[],temporalGaps:[],potentialImpact:.8,supportingData:s},recommendations:["Conduct empirical studies to validate theoretical models","Develop real-world case studies and applications","Create standardized datasets for comparative evaluation","Establish industry partnerships for practical validation"],opportunityScore:85}),t}analyzeGeographicGaps(){const t=[],r=this.analyzeGeographicDistribution();return r.underRepresentedRegions.length>0&&t.push({id:"geographic_representation",type:"geographic",title:"Geographic Research Imbalance",description:"Research is concentrated in certain regions, potentially missing diverse perspectives and applications.",severity:"medium",evidence:{underRepresentedTopics:r.underRepresentedRegions,citationGaps:[],temporalGaps:[],potentialImpact:.6,supportingData:r},recommendations:["Encourage international collaboration and research exchanges","Study region-specific applications and challenges","Consider cultural and regulatory differences in research design","Develop funding mechanisms for underrepresented regions"],opportunityScore:60}),t}findTopicIntersections(){const t=[];for(let r=0;r<this.topicClusters.length;r++)for(let a=r+1;a<this.topicClusters.length;a++){const s=this.topicClusters[r],n=this.topicClusters[a],i=s.papers.filter(d=>n.papers.some(p=>p.key===d.key)),c=s.coverage/100*(n.coverage/100),h=Math.round(this.papers.length*c*.3),f=i.length,o=Math.max(0,h-f),x=this.calculateTopicComplementarity(s,n);o>0&&t.push({topics:[s.label,n.label],combinedLabel:`${s.label} + ${n.label}`,expectedPapers:h,actualPapers:f,gapSize:o,potentialImpact:x})}return t.sort((r,a)=>a.gapSize-r.gapSize)}calculateTopicComplementarity(t,r){const a=(t.coverage+r.coverage)/200,s=this.assessDomainDifference(t.label,r.label);return Math.min(1,a*s)}assessDomainDifference(t,r){const a={technical:["AI/ML","Network","Privacy"],economic:["Economics","Risk Management"],theoretical:["Game Theory","Security"]};let s="other",n="other";for(const[i,c]of Object.entries(a))c.includes(t)&&(s=i),c.includes(r)&&(n=i);return s!==n?1.5:1}findTemporalGaps(){const t=this.papers.reduce((n,i)=>(i.publicationYear&&(n[i.publicationYear]=(n[i.publicationYear]||0)+1),n),{}),r=Object.keys(t).map(Number).sort(),a=[],s=3;for(let n=s;n<r.length-s;n++){const i=r[n],c=t[i]||0,h=r.slice(n-s,n).concat(r.slice(n+1,n+s+1)),f=h.reduce((d,p)=>d+(t[p]||0),0)/h.length,o=Math.round(f),x=Math.max(0,o-c);x>5&&a.push({startYear:i,endYear:i,expectedPapers:o,actualPapers:c,gapSize:x})}return a}analyzeRecentTrend(){const t=new Date().getFullYear(),r=5,s=this.papers.filter(d=>d.publicationYear&&d.publicationYear>=t-r).reduce((d,p)=>(p.publicationYear&&(d[p.publicationYear]=(d[p.publicationYear]||0)+1),d),{}),n=Object.keys(s).map(Number).sort();if(n.length<3)return{isDecline:!1,trendData:{}};const i=Math.floor(n.length/2),c=n.slice(0,i),h=n.slice(i),f=c.reduce((d,p)=>d+s[p],0)/c.length,o=h.reduce((d,p)=>d+s[p],0)/h.length;return{isDecline:o<f*.8,trendData:{firstHalfAvg:f,secondHalfAvg:o,declinePercentage:(f-o)/f*100}}}analyzeMethodologies(){const t={Theoretical:["theoretical","theory","model","framework","conceptual"],Empirical:["empirical","experimental","study","analysis","evaluation"],Simulation:["simulation","monte carlo","agent-based","modeling"],Survey:["survey","questionnaire","interview","qualitative"],"Case Study":["case study","real-world","practical","implementation"]},r=Object.keys(t).reduce((f,o)=>(f[o]=0,f),{});this.papers.forEach(f=>{const o=`${f.title} ${f.abstract}`.toLowerCase();Object.entries(t).forEach(([x,d])=>{d.some(p=>o.includes(p))&&r[x]++})});const a=this.papers.length,s=Object.entries(r).map(([f,o])=>({method:f,percentage:o/a*100})),n=s.filter(f=>f.percentage<15).map(f=>f.method),i=s.filter(f=>f.percentage>60).map(f=>f.method),c=s.reduce((f,o)=>f+Math.pow(o.percentage-20,2),0)/s.length,h=Math.max(0,1-c/400);return{underUtilized:n,overUtilized:i,balance:h}}assessTheoreticalBias(){const t=["theoretical","theory","model","framework","conceptual","analytical"],r=["empirical","experimental","study","evaluation","validation","testing"];let a=0,s=0;this.papers.forEach(c=>{const h=`${c.title} ${c.abstract}`.toLowerCase();t.some(f=>h.includes(f))&&a++,r.some(f=>h.includes(f))&&s++});const n=a+s,i=n>0?a/n:0;return{score:i,details:{theoreticalCount:a,empiricalCount:s,theoreticalRatio:i,empiricalRatio:1-i}}}analyzeGeographicDistribution(){return{underRepresentedRegions:["Developing Countries","Non-Western Perspectives","Regional Applications"],analysis:{note:"Geographic analysis requires author affiliation data",recommendation:"Collect and analyze author institutional affiliations"}}}identifyEmergingTopics(){const t=new Date().getFullYear(),r=3;return this.topicClusters.filter(a=>a.papers.filter(i=>i.publicationYear&&i.publicationYear>=t-r).length/a.papers.length>.4).map(a=>a.label)}identifyStagnantTopics(){const t=new Date().getFullYear(),r=5;return this.topicClusters.filter(a=>a.papers.filter(i=>i.publicationYear&&i.publicationYear>=t-r).length/a.papers.length<.2&&a.papers.length>10).map(a=>a.label)}}function Im(e,t,r){return new Dm(e,t,r).analyzeAllGaps()}const Om=({data:e})=>{const[t,r]=fe.useState([]),[a,s]=fe.useState(null),[n,i]=fe.useState("all"),[c,h]=fe.useState(!0);fe.useEffect(()=>{(async()=>{h(!0);try{const g=Im(e.papers,e.topicClusters,e.authorNetwork);r(g)}catch(g){console.error("Error analyzing research gaps:",g)}finally{h(!1)}})()},[e]);const f=n==="all"?t:t.filter(u=>u.type===n),o={topical:"#3B82F6",temporal:"#10B981",methodological:"#F59E0B",geographic:"#EF4444"},x=t.reduce((u,g)=>(u[g.type]=(u[g.type]||0)+1,u),{}),d=Object.entries(x).map(([u,g])=>({type:u.charAt(0).toUpperCase()+u.slice(1),count:g,fill:o[u]})),p=t.map(u=>({title:u.title.substring(0,30)+"...",opportunity:u.opportunityScore,impact:u.evidence.potentialImpact*100,type:u.type,severity:u.severity})),m=[{category:"Topical Gaps",value:t.filter(u=>u.type==="topical").length,fullMark:Math.max(5,t.length/2)},{category:"Temporal Gaps",value:t.filter(u=>u.type==="temporal").length,fullMark:Math.max(5,t.length/2)},{category:"Methodological",value:t.filter(u=>u.type==="methodological").length,fullMark:Math.max(5,t.length/2)},{category:"Geographic",value:t.filter(u=>u.type==="geographic").length,fullMark:Math.max(5,t.length/2)}];return c?l.jsxs("div",{className:"flex items-center justify-center h-64",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"}),l.jsx("span",{className:"ml-3 text-gray-600",children:"Analyzing research gaps..."})]}):l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[l.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between mb-4",children:[l.jsxs("div",{children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Research Gap Analysis"}),l.jsxs("p",{className:"text-gray-600 mt-1",children:["Identified ",t.length," potential research opportunities across ",Object.keys(x).length," categories"]})]}),l.jsx("div",{className:"mt-4 md:mt-0",children:l.jsxs("select",{value:n,onChange:u=>i(u.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[l.jsx("option",{value:"all",children:"All Gap Types"}),l.jsx("option",{value:"topical",children:"Topical Gaps"}),l.jsx("option",{value:"temporal",children:"Temporal Gaps"}),l.jsx("option",{value:"methodological",children:"Methodological Gaps"}),l.jsx("option",{value:"geographic",children:"Geographic Gaps"})]})})]}),l.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:Object.entries(x).map(([u,g])=>l.jsxs("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[l.jsx("div",{className:"text-2xl font-bold mb-1",style:{color:o[u]},children:g}),l.jsxs("div",{className:"text-sm text-gray-600 capitalize",children:[u," Gaps"]})]},u))})]}),l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[l.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Gap Distribution by Type"}),l.jsx(Ur,{width:"100%",height:300,children:l.jsxs(hs,{data:d,children:[l.jsx(Jt,{strokeDasharray:"3 3"}),l.jsx(At,{dataKey:"type"}),l.jsx(St,{}),l.jsx(Vr,{}),l.jsx(us,{dataKey:"count",fill:"#8884d8"})]})})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Opportunity vs Impact Analysis"}),l.jsx(Ur,{width:"100%",height:300,children:l.jsxs(gc,{data:p,children:[l.jsx(Jt,{strokeDasharray:"3 3"}),l.jsx(At,{dataKey:"opportunity",name:"Opportunity Score"}),l.jsx(St,{dataKey:"impact",name:"Potential Impact"}),l.jsx(Vr,{formatter:(u,g)=>[`${u}${g==="opportunity"?"":"%"}`,g==="opportunity"?"Opportunity Score":"Potential Impact"],labelFormatter:u=>`Gap: ${u}`}),l.jsx(vc,{dataKey:"impact",fill:"#8884d8",shape:u=>{const{cx:g,cy:_,payload:F}=u,y=o[F.type];return l.jsx("circle",{cx:g,cy:_,r:6,fill:y})}})]})})]})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Research Gap Profile"}),l.jsxs("div",{className:"flex flex-col lg:flex-row items-center",children:[l.jsx("div",{className:"w-full lg:w-1/2",children:l.jsx(Ur,{width:"100%",height:300,children:l.jsxs(yc,{data:m,children:[l.jsx(wc,{}),l.jsx(Tc,{dataKey:"category"}),l.jsx(_c,{angle:90,domain:[0,"dataMax"]}),l.jsx(kc,{name:"Gap Count",dataKey:"value",stroke:"#8884d8",fill:"#8884d8",fillOpacity:.3}),l.jsx(Vr,{})]})})}),l.jsx("div",{className:"w-full lg:w-1/2 lg:pl-6 mt-4 lg:mt-0",children:l.jsxs("div",{className:"space-y-3",children:[l.jsx("div",{className:"text-sm text-gray-600",children:"This radar chart shows the distribution of identified research gaps across different categories."}),Object.entries(x).map(([u,g])=>l.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"w-3 h-3 rounded-full mr-2",style:{backgroundColor:o[u]}}),l.jsx("span",{className:"text-sm font-medium capitalize",children:u})]}),l.jsxs("span",{className:"text-sm text-gray-600",children:[g," gaps"]})]},u))]})})]})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[l.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Detailed Gap Analysis (",f.length," gaps)"]}),l.jsx("div",{className:"space-y-4",children:f.map((u,g)=>l.jsxs("div",{className:`border rounded-lg p-4 cursor-pointer transition-all duration-200 ${(a==null?void 0:a.id)===u.id?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300 hover:shadow-md"}`,onClick:()=>s((a==null?void 0:a.id)===u.id?null:u),children:[l.jsxs("div",{className:"flex items-start justify-between",children:[l.jsxs("div",{className:"flex-1",children:[l.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[l.jsx("span",{className:"px-2 py-1 text-xs font-semibold rounded-full text-white",style:{backgroundColor:o[u.type]},children:u.type.charAt(0).toUpperCase()+u.type.slice(1)}),l.jsxs("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${u.severity==="high"?"bg-red-100 text-red-800":u.severity==="medium"?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:[u.severity.charAt(0).toUpperCase()+u.severity.slice(1)," Priority"]})]}),l.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-2",children:u.title}),l.jsx("p",{className:"text-gray-600 text-sm mb-3",children:u.description}),l.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-500",children:[l.jsxs("span",{children:["Opportunity Score: ",u.opportunityScore.toFixed(1)]}),l.jsxs("span",{children:["Impact: ",(u.evidence.potentialImpact*100).toFixed(1),"%"]})]})]}),l.jsx("div",{className:"ml-4",children:l.jsxs("div",{className:"text-right",children:[l.jsx("div",{className:"text-2xl font-bold text-blue-600",children:u.opportunityScore.toFixed(0)}),l.jsx("div",{className:"text-xs text-gray-500",children:"Score"})]})})]}),(a==null?void 0:a.id)===u.id&&l.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[l.jsxs("div",{children:[l.jsx("h5",{className:"font-semibold text-gray-900 mb-2",children:"Evidence"}),l.jsxs("div",{className:"space-y-2 text-sm",children:[u.evidence.underRepresentedTopics.length>0&&l.jsxs("div",{children:[l.jsx("span",{className:"font-medium",children:"Under-represented topics:"}),l.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:u.evidence.underRepresentedTopics.map(_=>l.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-700 rounded text-xs",children:_},_))})]}),u.evidence.temporalGaps.length>0&&l.jsxs("div",{children:[l.jsx("span",{className:"font-medium",children:"Temporal gaps:"}),u.evidence.temporalGaps.map((_,F)=>l.jsxs("div",{className:"text-xs text-gray-600 ml-2",children:[_.startYear,"-",_.endYear,": ",_.gapSize," fewer papers than expected"]},F))]}),u.evidence.supportingData&&l.jsxs("div",{children:[l.jsx("span",{className:"font-medium",children:"Supporting data:"}),l.jsx("pre",{className:"text-xs text-gray-600 bg-gray-50 p-2 rounded mt-1 overflow-x-auto",children:JSON.stringify(u.evidence.supportingData,null,2)})]})]})]}),l.jsxs("div",{children:[l.jsx("h5",{className:"font-semibold text-gray-900 mb-2",children:"Recommendations"}),l.jsx("ul",{className:"space-y-1 text-sm",children:u.recommendations.map((_,F)=>l.jsxs("li",{className:"flex items-start",children:[l.jsx("span",{className:"text-blue-500 mr-2",children:"•"}),l.jsx("span",{className:"text-gray-700",children:_})]},F))})]})]})})]},u.id))})]}),l.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg p-6 border border-blue-200",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Key Research Opportunities"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-2xl font-bold text-blue-600",children:t.filter(u=>u.severity==="high").length}),l.jsx("div",{className:"text-sm text-gray-600",children:"High Priority Gaps"}),l.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Immediate research opportunities"})]}),l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-2xl font-bold text-green-600",children:Math.round(t.reduce((u,g)=>u+g.opportunityScore,0)/t.length)}),l.jsx("div",{className:"text-sm text-gray-600",children:"Avg Opportunity Score"}),l.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Overall research potential"})]}),l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-2xl font-bold text-purple-600",children:t.filter(u=>u.evidence.potentialImpact>.7).length}),l.jsx("div",{className:"text-sm text-gray-600",children:"High Impact Potential"}),l.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Transformative opportunities"})]})]}),l.jsxs("div",{className:"mt-4 p-4 bg-white rounded-lg",children:[l.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Top Recommendations"}),l.jsxs("ul",{className:"text-sm text-gray-700 space-y-1",children:[l.jsx("li",{children:"• Focus on high-impact topical intersections with limited current research"}),l.jsx("li",{children:"• Address methodological gaps through empirical validation studies"}),l.jsx("li",{children:"• Explore temporal gaps that may indicate missed research opportunities"}),l.jsx("li",{children:"• Consider geographic and cultural perspectives in research design"})]})]})]})]})},Pm=({data:e,onSearchResults:t,onFiltersChange:r})=>{const[a,s]=fe.useState({query:"",yearRange:[e.yearRange[0],e.yearRange[1]],authors:[],topics:[],venues:[],itemTypes:[]}),[n,i]=fe.useState(e.papers),[c,h]=fe.useState(!1),[f,o]=fe.useState([]),x=Array.from(new Set(e.papers.flatMap(E=>E.authors))).sort();Array.from(new Set(e.papers.map(E=>E.venue||E.publicationTitle).filter(Boolean))).sort();const d=Array.from(new Set(e.papers.map(E=>E.itemType))).sort(),p=e.topicClusters.map(E=>E.label);fe.useEffect(()=>{m()},[a,e.papers]);const m=()=>{let E=e.papers;if(a.query.trim()){const D=a.query.toLowerCase();E=E.filter(R=>R.title.toLowerCase().includes(D)||R.abstract.toLowerCase().includes(D)||R.authors.some(T=>T.toLowerCase().includes(D))||R.tags.some(T=>T.toLowerCase().includes(D)))}E=E.filter(D=>D.publicationYear&&D.publicationYear>=a.yearRange[0]&&D.publicationYear<=a.yearRange[1]),a.authors.length>0&&(E=E.filter(D=>D.authors.some(R=>a.authors.some(T=>R.toLowerCase().includes(T.toLowerCase()))))),a.topics.length>0&&(E=E.filter(D=>{const R=e.topicClusters.filter(T=>T.papers.some(M=>M.key===D.key)).map(T=>T.label);return a.topics.some(T=>R.includes(T))})),a.venues.length>0&&(E=E.filter(D=>a.venues.some(R=>D.venue&&D.venue.toLowerCase().includes(R.toLowerCase())||D.publicationTitle&&D.publicationTitle.toLowerCase().includes(R.toLowerCase())))),a.itemTypes.length>0&&(E=E.filter(D=>a.itemTypes.includes(D.itemType))),i(E),t(E),r(a)},u=(E,D)=>{s(R=>({...R,[E]:D}))},g=()=>{const E={query:"",yearRange:[e.yearRange[0],e.yearRange[1]],authors:[],topics:[],venues:[],itemTypes:[]};s(E)},_=()=>{const E=prompt("Enter a name for this search:");if(E){const D={name:E,filters:{...a},resultCount:n.length};o(R=>[...R,D])}},F=E=>{s(E)},y=()=>{const E=[["Title","Authors","Year","Venue","DOI","Abstract"].join(","),...n.map(M=>[`"${M.title}"`,`"${M.authors.join("; ")}"`,M.publicationYear||"",`"${M.venue||M.publicationTitle}"`,M.doi||"",`"${M.abstract.substring(0,200)}..."`].join(","))].join(`
`),D=new Blob([E],{type:"text/csv"}),R=URL.createObjectURL(D),T=document.createElement("a");T.href=R,T.download=`literature_search_results_${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(T),T.click(),document.body.removeChild(T),URL.revokeObjectURL(R)};return l.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 mb-6",children:[l.jsxs("div",{className:"flex items-center space-x-4 mb-4",children:[l.jsx("div",{className:"flex-1",children:l.jsx("input",{type:"text",placeholder:"Search titles, abstracts, authors, or keywords...",value:a.query,onChange:E=>u("query",E.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})}),l.jsx("button",{onClick:()=>h(!c),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:c?"Simple":"Advanced"}),l.jsxs("div",{className:"text-sm text-gray-600",children:[n.length," results"]})]}),c&&l.jsxs("div",{className:"space-y-4 border-t border-gray-200 pt-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Publication Year Range"}),l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsx("input",{type:"number",min:e.yearRange[0],max:e.yearRange[1],value:a.yearRange[0],onChange:E=>u("yearRange",[parseInt(E.target.value),a.yearRange[1]]),className:"w-24 px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500"}),l.jsx("span",{className:"text-gray-500",children:"to"}),l.jsx("input",{type:"number",min:e.yearRange[0],max:e.yearRange[1],value:a.yearRange[1],onChange:E=>u("yearRange",[a.yearRange[0],parseInt(E.target.value)]),className:"w-24 px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Research Topics"}),l.jsx("div",{className:"flex flex-wrap gap-2",children:p.map(E=>l.jsxs("label",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",checked:a.topics.includes(E),onChange:D=>{D.target.checked?u("topics",[...a.topics,E]):u("topics",a.topics.filter(R=>R!==E))},className:"mr-2"}),l.jsx("span",{className:"text-sm text-gray-700",children:E})]},E))})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Publication Types"}),l.jsx("div",{className:"flex flex-wrap gap-2",children:d.map(E=>l.jsxs("label",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",checked:a.itemTypes.includes(E),onChange:D=>{D.target.checked?u("itemTypes",[...a.itemTypes,E]):u("itemTypes",a.itemTypes.filter(R=>R!==E))},className:"mr-2"}),l.jsx("span",{className:"text-sm text-gray-700 capitalize",children:E})]},E))})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Authors (select up to 5)"}),l.jsx("select",{multiple:!0,value:a.authors,onChange:E=>{const D=Array.from(E.target.selectedOptions,R=>R.value);u("authors",D.slice(0,5))},className:"w-full h-32 px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500",children:x.slice(0,50).map(E=>l.jsx("option",{value:E,children:E},E))}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Hold Ctrl/Cmd to select multiple authors"})]}),l.jsx("div",{className:"flex items-center justify-between pt-4 border-t border-gray-200",children:l.jsxs("div",{className:"flex space-x-2",children:[l.jsx("button",{onClick:g,className:"px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700 transition-colors",children:"Clear Filters"}),l.jsx("button",{onClick:_,className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition-colors",children:"Save Search"}),l.jsx("button",{onClick:y,className:"px-4 py-2 bg-purple-600 text-white rounded hover:bg-purple-700 transition-colors",children:"Export Results"})]})})]}),f.length>0&&l.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200",children:[l.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Saved Searches"}),l.jsx("div",{className:"flex flex-wrap gap-2",children:f.map((E,D)=>l.jsxs("button",{onClick:()=>F(E.filters),className:"px-3 py-1 bg-blue-100 text-blue-800 text-sm rounded hover:bg-blue-200 transition-colors",children:[E.name," (",E.resultCount," results)"]},D))})]}),(a.query||a.authors.length>0||a.topics.length>0||a.venues.length>0||a.itemTypes.length>0||a.yearRange[0]!==e.yearRange[0]||a.yearRange[1]!==e.yearRange[1])&&l.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200",children:[l.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Active Filters"}),l.jsxs("div",{className:"flex flex-wrap gap-2",children:[a.query&&l.jsxs("span",{className:"px-2 py-1 bg-yellow-100 text-yellow-800 text-xs rounded",children:['Query: "',a.query,'"']}),(a.yearRange[0]!==e.yearRange[0]||a.yearRange[1]!==e.yearRange[1])&&l.jsxs("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded",children:["Years: ",a.yearRange[0],"-",a.yearRange[1]]}),a.topics.map(E=>l.jsxs("span",{className:"px-2 py-1 bg-green-100 text-green-800 text-xs rounded",children:["Topic: ",E]},E)),a.authors.map(E=>l.jsxs("span",{className:"px-2 py-1 bg-purple-100 text-purple-800 text-xs rounded",children:["Author: ",E]},E)),a.itemTypes.map(E=>l.jsxs("span",{className:"px-2 py-1 bg-orange-100 text-orange-800 text-xs rounded",children:["Type: ",E]},E))]})]})]})};class jm{constructor(){Nr(this,"cache",new Map)}set(t,r,a=60){this.cache.set(t,{data:r,timestamp:Date.now(),ttl:a*60*1e3})}get(t){const r=this.cache.get(t);return r?Date.now()-r.timestamp>r.ttl?(this.cache.delete(t),null):r.data:null}clear(){this.cache.clear()}}const ct=new jm;class Mm{constructor(){Nr(this,"baseUrl","https://api.semanticscholar.org/graph/v1");Nr(this,"rateLimitDelay",100)}async delay(t){return new Promise(r=>setTimeout(r,t))}async makeRequest(t){try{await this.delay(this.rateLimitDelay);const r=await fetch(t,{headers:{Accept:"application/json"}});if(!r.ok){if(r.status===429)return await this.delay(1e3),this.makeRequest(t);throw new Error(`HTTP ${r.status}: ${r.statusText}`)}return await r.json()}catch(r){return console.warn("Semantic Scholar API request failed:",r),null}}async getCitationData(t){var s;const r=`citations_${t.doi||t.title}`,a=ct.get(r);if(a)return a;try{let n="";if(t.doi)n=`doi:${t.doi}`;else{const o=t.authors[0]||"";n=`${t.title} ${o}`.substring(0,100)}const i=`${this.baseUrl}/paper/search?query=${encodeURIComponent(n)}&fields=paperId,title,citationCount,influentialCitationCount,citations,citations.title,citations.authors,citations.year,citations.venue`,c=await this.makeRequest(i);if(!((s=c==null?void 0:c.data)!=null&&s.length))return null;const h=c.data[0],f={paperId:h.paperId,citationCount:h.citationCount||0,influentialCitationCount:h.influentialCitationCount||0,citingPapers:(h.citations||[]).slice(0,10).map(o=>({paperId:o.paperId,title:o.title||"Unknown Title",authors:(o.authors||[]).map(x=>x.name),year:o.year||0,venue:o.venue||"Unknown Venue"})),citationTrend:this.generateCitationTrend(h.citationCount||0,t.publicationYear)};return ct.set(r,f,120),f}catch(n){return console.warn("Failed to fetch citation data:",n),null}}generateCitationTrend(t,r){if(!r||t===0)return[];const s=new Date().getFullYear()-r;if(s<=0)return[];const n=[];let i=0;for(let c=0;c<=Math.min(s,10);c++){const h=r+c,f=c/s,o=Math.min(1,f*1.5),x=Math.max(0,Math.round((t*o-i)*(.8+Math.random()*.4)));i+=x,n.push({year:h,count:x})}return n}async getAuthorMetrics(t){var s;const r=`author_${t}`,a=ct.get(r);if(a)return a;try{const n=`${this.baseUrl}/author/search?query=${encodeURIComponent(t)}&fields=authorId,name,hIndex,citationCount,paperCount,affiliations`,i=await this.makeRequest(n);if(!((s=i==null?void 0:i.data)!=null&&s.length))return null;const c=i.data[0],h={authorName:c.name,hIndex:c.hIndex,citationCount:c.citationCount||0,paperCount:c.paperCount||0,affiliations:(c.affiliations||[]).map(f=>f.name||f)};return ct.set(r,h,240),h}catch(n){return console.warn("Failed to fetch author metrics:",n),null}}}class Lm{constructor(){Nr(this,"openAlexBaseUrl","https://api.openalex.org")}async getJournalImpactData(t){var s,n,i,c,h;const r=`journal_${t}`,a=ct.get(r);if(a)return a;try{const f=`${this.openAlexBaseUrl}/venues?search=${encodeURIComponent(t)}&per-page=1`,o=await fetch(f);if(!o.ok)return null;const x=await o.json();if(!((s=x.results)!=null&&s.length))return null;const d=x.results[0],p={venue:d.display_name,impactFactor:(n=d.summary_stats)==null?void 0:n["2yr_mean_citedness"],hIndex:(i=d.summary_stats)==null?void 0:i.h_index,category:((c=d.host_organization)==null?void 0:c.display_name)||"Unknown",quartile:this.determineQuartile((h=d.summary_stats)==null?void 0:h["2yr_mean_citedness"])};return ct.set(r,p,1440),p}catch(f){return console.warn("Failed to fetch journal impact data:",f),null}}determineQuartile(t){if(t)return t>=4?"Q1":t>=2?"Q2":t>=1?"Q3":"Q4"}}class Bm{constructor(){Nr(this,"semanticScholar",new Mm);Nr(this,"journalMetrics",new Lm)}async enrichPaperData(t,r=50){const a=new Map,s=5,n=t.slice(0,r);for(let i=0;i<n.length;i+=s){const h=n.slice(i,i+s).map(async o=>{try{const[x,d]=await Promise.all([this.semanticScholar.getCitationData(o),this.journalMetrics.getJournalImpactData(o.venue||o.publicationTitle)]);return{paperKey:o.key,citations:x,journal:d}}catch(x){return console.warn(`Failed to enrich data for paper ${o.key}:`,x),{paperKey:o.key,citations:null,journal:null}}});(await Promise.all(h)).forEach(o=>{(o.citations||o.journal)&&a.set(o.paperKey,{citations:o.citations,journal:o.journal})}),i+s<n.length&&await new Promise(o=>setTimeout(o,1e3))}return a}async getAuthorEnrichmentData(t,r=20){const a=new Map,s=t.slice(0,r);for(const n of s){try{const i=await this.semanticScholar.getAuthorMetrics(n);i&&a.set(n,i)}catch(i){console.warn(`Failed to get metrics for author ${n}:`,i)}await new Promise(i=>setTimeout(i,200))}return a}clearCache(){ct.clear()}}const Um=new Bm,Vm=({paper:e,isOpen:t,onClose:r,data:a})=>{const[s,n]=fe.useState(null),[i,c]=fe.useState([]),[h,f]=fe.useState(!1),[o,x]=fe.useState("overview");fe.useEffect(()=>{e&&t&&(d(),p())},[e,t]);const d=async()=>{if(e){f(!0);try{const E=(await Um.enrichPaperData([e],1)).get(e.key);E!=null&&E.citations&&n(E.citations)}catch(y){console.warn("Failed to load citation data:",y)}finally{f(!1)}}},p=()=>{if(!e)return;const y=a.papers.filter(V=>V.key!==e.key&&V.authors.some(L=>e.authors.includes(L))),E=a.topicClusters.filter(V=>V.papers.some(L=>L.key===e.key)),D=a.papers.filter(V=>V.key===e.key?!1:E.some(L=>L.papers.some(P=>P.key===V.key))),R=a.papers.filter(V=>V.key!==e.key&&(V.venue===e.venue||V.publicationTitle===e.publicationTitle)&&(e.venue||e.publicationTitle)),I=[...y,...D,...R].filter((V,L,P)=>P.findIndex(J=>J.key===V.key)===L).map(V=>{let L=0;return y.some(P=>P.key===V.key)&&(L+=3),D.some(P=>P.key===V.key)&&(L+=2),R.some(P=>P.key===V.key)&&(L+=1),{paper:V,score:L}});c(I.sort((V,L)=>L.score-V.score).slice(0,10).map(V=>V.paper))},m=y=>{if(!e)return;let E="";const D=e.authors.join(", "),R=e.publicationYear||"n.d.",T=e.venue||e.publicationTitle||"Unknown venue";switch(y){case"bibtex":E=`@article{${e.key},
  title={${e.title}},
  author={${D}},
  year={${R}},
  journal={${T}}${e.doi?`,
  doi={${e.doi}}`:""}
}`;break;case"apa":E=`${D} (${R}). ${e.title}. ${T}.${e.doi?` https://doi.org/${e.doi}`:""}`;break;case"mla":E=`${D}. "${e.title}." ${T}, ${R}.${e.doi?` Web. https://doi.org/${e.doi}`:""}`;break}navigator.clipboard.writeText(E),alert(`${y.toUpperCase()} citation copied to clipboard!`)},u=()=>e?a.topicClusters.filter(y=>y.papers.some(E=>E.key===e.key)).map(y=>y.label):[],g=()=>{if(!e)return null;const y=a.venueStats.find(D=>D.name===e.venue||D.name===e.publicationTitle),E=e.authors.map(D=>{const R=a.authorNetwork.find(T=>T.name===D);return R?{name:D,paperCount:R.paperCount,influence:R.influence}:null}).filter(Boolean);return{venue:y?{name:y.name,paperCount:y.paperCount,type:y.type}:null,authors:E,citationCount:(s==null?void 0:s.citationCount)||0,influentialCitations:(s==null?void 0:s.influentialCitationCount)||0}};if(!t||!e)return null;const _=g(),F=u();return l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:l.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-hidden",children:[l.jsxs("div",{className:"flex items-start justify-between p-6 border-b border-gray-200",children:[l.jsxs("div",{className:"flex-1 pr-4",children:[l.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:e.title}),l.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-sm text-gray-600",children:[l.jsx("span",{children:e.authors.join(", ")}),e.publicationYear&&l.jsxs(l.Fragment,{children:[l.jsx("span",{children:"•"}),l.jsx("span",{children:e.publicationYear})]}),(e.venue||e.publicationTitle)&&l.jsxs(l.Fragment,{children:[l.jsx("span",{children:"•"}),l.jsx("span",{children:e.venue||e.publicationTitle})]})]})]}),l.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 text-2xl font-bold",children:"×"})]}),l.jsx("div",{className:"border-b border-gray-200",children:l.jsx("nav",{className:"flex space-x-8 px-6",children:[{id:"overview",label:"Overview"},{id:"citations",label:"Citations"},{id:"related",label:"Related Papers"},{id:"metrics",label:"Impact Metrics"}].map(y=>l.jsx("button",{onClick:()=>x(y.id),className:`py-4 px-1 border-b-2 font-medium text-sm ${o===y.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:y.label},y.id))})}),l.jsxs("div",{className:"p-6 overflow-y-auto max-h-[60vh]",children:[o==="overview"&&l.jsxs("div",{className:"space-y-6",children:[e.abstract&&l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Abstract"}),l.jsx("p",{className:"text-gray-700 leading-relaxed",children:e.abstract})]}),F.length>0&&l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Research Topics"}),l.jsx("div",{className:"flex flex-wrap gap-2",children:F.map(y=>l.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 text-sm rounded-full",children:y},y))})]}),e.tags.length>0&&l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Keywords"}),l.jsx("div",{className:"flex flex-wrap gap-2",children:e.tags.map(y=>l.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-700 text-sm rounded",children:y},y))})]}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Access"}),l.jsxs("div",{className:"space-y-2",children:[e.doi&&l.jsxs("a",{href:`https://doi.org/${e.doi}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center text-blue-600 hover:text-blue-800",children:[l.jsx("svg",{className:"w-4 h-4 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:l.jsx("path",{fillRule:"evenodd",d:"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 00-1.414 1.414 4 4 0 005.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 00-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z",clipRule:"evenodd"})}),"DOI: ",e.doi]}),e.url&&l.jsxs("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center text-blue-600 hover:text-blue-800",children:[l.jsx("svg",{className:"w-4 h-4 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:l.jsx("path",{fillRule:"evenodd",d:"M4.083 9h1.946c.089-1.546.383-2.97.837-4.118A6.004 6.004 0 004.083 9zM10 2a8 8 0 100 16 8 8 0 000-16zm0 2c-.076 0-.232.032-.465.262-.238.234-.497.623-.737 1.182-.389.907-.673 2.142-.766 3.556h3.936c-.093-1.414-.377-2.649-.766-3.556-.24-.559-.499-.948-.737-1.182C10.232 4.032 10.076 4 10 4zm3.971 5c-.089-1.546-.383-2.97-.837-4.118A6.004 6.004 0 0115.917 9h-1.946zm-2.003 2H8.032c.093 1.414.377 2.649.766 3.556.24.559.499.948.737 1.182.233.23.389.262.465.262.076 0 .232-.032.465-.262.238-.234.497-.623.737-1.182.389-.907.673-2.142.766-3.556zm1.166 4.118c.454-1.147.748-2.572.837-4.118h1.946a6.004 6.004 0 01-2.783 4.118zm-6.268 0C6.412 13.97 6.118 12.546 6.03 11H4.083a6.004 6.004 0 002.783 4.118z",clipRule:"evenodd"})}),"Full Text"]})]})]})]}),o==="citations"&&l.jsx("div",{className:"space-y-6",children:h?l.jsxs("div",{className:"text-center py-8",children:[l.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),l.jsx("p",{className:"mt-2 text-gray-600",children:"Loading citation data..."})]}):s?l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[l.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[l.jsx("div",{className:"text-2xl font-bold text-blue-600",children:s.citationCount}),l.jsx("div",{className:"text-sm text-gray-600",children:"Total Citations"})]}),l.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[l.jsx("div",{className:"text-2xl font-bold text-green-600",children:s.influentialCitationCount}),l.jsx("div",{className:"text-sm text-gray-600",children:"Influential Citations"})]}),l.jsxs("div",{className:"text-center p-4 bg-purple-50 rounded-lg",children:[l.jsx("div",{className:"text-2xl font-bold text-purple-600",children:s.citingPapers.length}),l.jsx("div",{className:"text-sm text-gray-600",children:"Recent Citing Papers"})]})]}),s.citationTrend.length>0&&l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Citation Trend"}),l.jsx(Ur,{width:"100%",height:200,children:l.jsxs(si,{data:s.citationTrend,children:[l.jsx(Jt,{strokeDasharray:"3 3"}),l.jsx(At,{dataKey:"year"}),l.jsx(St,{}),l.jsx(Vr,{}),l.jsx(ni,{type:"monotone",dataKey:"count",stroke:"#8884d8",strokeWidth:2})]})})]}),s.citingPapers.length>0&&l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Recent Citing Papers"}),l.jsx("div",{className:"space-y-3",children:s.citingPapers.slice(0,5).map((y,E)=>l.jsxs("div",{className:"p-3 border border-gray-200 rounded-lg",children:[l.jsx("h4",{className:"font-medium text-gray-900",children:y.title}),l.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[y.authors.join(", ")," • ",y.year," • ",y.venue]})]},E))})]})]}):l.jsxs("div",{className:"text-center py-8 text-gray-500",children:[l.jsx("p",{children:"Citation data not available for this paper."}),l.jsx("p",{className:"text-sm mt-2",children:"This may be due to API limitations or the paper not being indexed."})]})}),o==="related"&&l.jsxs("div",{className:"space-y-4",children:[l.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Related Papers (",i.length,")"]}),i.length>0?l.jsx("div",{className:"space-y-3",children:i.map(y=>l.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg hover:bg-gray-50",children:[l.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:y.title}),l.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:[y.authors.join(", ")," • ",y.publicationYear," • ",y.venue||y.publicationTitle]}),y.abstract&&l.jsxs("p",{className:"text-sm text-gray-700 line-clamp-2",children:[y.abstract.substring(0,200),"..."]})]},y.key))}):l.jsx("p",{className:"text-gray-500",children:"No related papers found."})]}),o==="metrics"&&l.jsxs("div",{className:"space-y-6",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Impact Metrics"}),_&&l.jsxs(l.Fragment,{children:[_.venue&&l.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[l.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Publication Venue"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[l.jsxs("div",{children:[l.jsx("span",{className:"text-gray-600",children:"Venue:"}),l.jsx("div",{className:"font-medium",children:_.venue.name})]}),l.jsxs("div",{children:[l.jsx("span",{className:"text-gray-600",children:"Type:"}),l.jsx("div",{className:"font-medium capitalize",children:_.venue.type})]}),l.jsxs("div",{children:[l.jsx("span",{className:"text-gray-600",children:"Papers in Dataset:"}),l.jsx("div",{className:"font-medium",children:_.venue.paperCount})]})]})]}),_.authors.length>0&&l.jsxs("div",{children:[l.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Author Metrics"}),l.jsx("div",{className:"space-y-2",children:_.authors.map((y,E)=>l.jsxs("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded",children:[l.jsx("span",{className:"font-medium",children:y.name}),l.jsxs("div",{className:"text-sm text-gray-600",children:[y.paperCount," papers • Influence: ",y.influence.toFixed(1)]})]},E))})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg",children:[l.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Citation Impact"}),l.jsx("div",{className:"text-2xl font-bold text-blue-600 mb-1",children:_.citationCount}),l.jsx("div",{className:"text-sm text-gray-600",children:"Total Citations"})]}),l.jsxs("div",{className:"p-4 bg-green-50 rounded-lg",children:[l.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Influential Impact"}),l.jsx("div",{className:"text-2xl font-bold text-green-600 mb-1",children:_.influentialCitations}),l.jsx("div",{className:"text-sm text-gray-600",children:"Influential Citations"})]})]})]})]})]}),l.jsxs("div",{className:"flex items-center justify-between p-6 border-t border-gray-200 bg-gray-50",children:[l.jsxs("div",{className:"flex space-x-2",children:[l.jsx("button",{onClick:()=>m("bibtex"),className:"px-3 py-2 text-sm bg-blue-600 text-white rounded hover:bg-blue-700",children:"Export BibTeX"}),l.jsx("button",{onClick:()=>m("apa"),className:"px-3 py-2 text-sm bg-gray-600 text-white rounded hover:bg-gray-700",children:"Export APA"}),l.jsx("button",{onClick:()=>m("mla"),className:"px-3 py-2 text-sm bg-gray-600 text-white rounded hover:bg-gray-700",children:"Export MLA"})]}),l.jsx("button",{onClick:r,className:"px-4 py-2 text-sm bg-gray-300 text-gray-700 rounded hover:bg-gray-400",children:"Close"})]})]})})},ei=({data:e})=>{var o;const[t,r]=fe.useState(null),a=new Date().getFullYear(),s=e.papers.filter(x=>x.publicationYear&&x.publicationYear>=a-5).length,n=s/e.papers.length*100,i=e.topicClusters.slice(0,5).map(x=>({name:x.label,value:x.size,percentage:x.coverage.toFixed(1)})),c=e.venueStats.slice(0,5).map(x=>({name:x.name.length>20?x.name.substring(0,20)+"...":x.name,papers:x.paperCount})),h=["#0088FE","#00C49F","#FFBB28","#FF8042","#8884D8"],f=({title:x,value:d,subtitle:p,color:m,id:u})=>l.jsx("div",{className:`bg-white rounded-lg shadow-md p-4 cursor-pointer transition-all duration-200 ${t===u?"ring-2 ring-blue-500 scale-105":""}`,onClick:()=>r(t===u?null:u),children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-600",children:x}),l.jsx("p",{className:`text-2xl font-bold ${m}`,children:d}),l.jsx("p",{className:"text-xs text-gray-500",children:p})]}),l.jsx("div",{className:`w-3 h-3 rounded-full ${m.replace("text-","bg-")}`})]})});return l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[l.jsx(f,{id:"papers",title:"Total Papers",value:e.papers.length.toLocaleString(),subtitle:`${e.yearRange[1]-e.yearRange[0]} year span`,color:"text-blue-600"}),l.jsx(f,{id:"authors",title:"Authors",value:e.authorNetwork.length.toLocaleString(),subtitle:"Research network",color:"text-green-600"}),l.jsx(f,{id:"topics",title:"Topics",value:e.topicClusters.length,subtitle:"Research areas",color:"text-purple-600"}),l.jsx(f,{id:"recent",title:"Recent",value:`${n.toFixed(1)}%`,subtitle:"Last 5 years",color:"text-orange-600"})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Data Quality"}),l.jsx("div",{className:"space-y-3",children:[{label:"DOI Coverage",value:e.qualityMetrics.doiCoverage,color:"bg-blue-500"},{label:"URL Coverage",value:e.qualityMetrics.urlCoverage,color:"bg-green-500"},{label:"Abstracts",value:e.qualityMetrics.abstractCoverage,color:"bg-purple-500"}].map((x,d)=>l.jsxs("div",{children:[l.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[l.jsx("span",{className:"text-gray-600",children:x.label}),l.jsxs("span",{className:"font-medium",children:[x.value.toFixed(1),"%"]})]}),l.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:l.jsx("div",{className:`${x.color} h-2 rounded-full transition-all duration-1000`,style:{width:`${x.value}%`}})})]},d))})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Top Research Topics"}),l.jsx("div",{className:"h-48",children:l.jsx(Ur,{width:"100%",height:"100%",children:l.jsxs(ri,{children:[l.jsx(ti,{data:i,cx:"50%",cy:"50%",outerRadius:60,fill:"#8884d8",dataKey:"value",label:({name:x,percentage:d})=>`${d}%`,labelLine:!1,children:i.map((x,d)=>l.jsx(ai,{fill:h[d%h.length]},`cell-${d}`))}),l.jsx(Vr,{formatter:(x,d)=>[`${x} papers`,d]})]})})}),l.jsx("div",{className:"mt-2 space-y-1",children:i.map((x,d)=>l.jsxs("div",{className:"flex items-center text-xs",children:[l.jsx("div",{className:"w-3 h-3 rounded-full mr-2",style:{backgroundColor:h[d%h.length]}}),l.jsx("span",{className:"flex-1",children:x.name}),l.jsxs("span",{className:"text-gray-500",children:[x.percentage,"%"]})]},d))})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Top Venues"}),l.jsx("div",{className:"h-48",children:l.jsx(Ur,{width:"100%",height:"100%",children:l.jsxs(hs,{data:c,layout:"horizontal",children:[l.jsx(At,{type:"number",hide:!0}),l.jsx(St,{dataKey:"name",type:"category",width:80,fontSize:10}),l.jsx(Vr,{}),l.jsx(us,{dataKey:"papers",fill:"#8884d8"})]})})})]}),l.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg p-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Quick Stats"}),l.jsxs("div",{className:"grid grid-cols-2 gap-4 text-center",children:[l.jsxs("div",{children:[l.jsx("div",{className:"text-xl font-bold text-blue-600",children:Math.round(e.papers.reduce((x,d)=>x+d.authors.length,0)/e.papers.length*10)/10}),l.jsx("div",{className:"text-xs text-gray-600",children:"Avg Authors/Paper"})]}),l.jsxs("div",{children:[l.jsx("div",{className:"text-xl font-bold text-green-600",children:e.venueStats.length}),l.jsx("div",{className:"text-xs text-gray-600",children:"Publication Venues"})]}),l.jsxs("div",{children:[l.jsx("div",{className:"text-xl font-bold text-purple-600",children:e.yearRange[1]-e.yearRange[0]}),l.jsx("div",{className:"text-xs text-gray-600",children:"Years Covered"})]}),l.jsxs("div",{children:[l.jsxs("div",{className:"text-xl font-bold text-orange-600",children:[Math.round((e.qualityMetrics.doiCoverage+e.qualityMetrics.urlCoverage)/2),"%"]}),l.jsx("div",{className:"text-xs text-gray-600",children:"Accessibility"})]})]})]}),t&&l.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4 border-l-4 border-blue-500",children:[l.jsxs("h4",{className:"font-semibold text-gray-900 mb-2",children:[t==="papers"&&"Paper Collection Details",t==="authors"&&"Author Network Details",t==="topics"&&"Topic Analysis Details",t==="recent"&&"Recent Publications Details"]}),l.jsxs("div",{className:"text-sm text-gray-600",children:[t==="papers"&&l.jsxs("p",{children:["Comprehensive collection spanning ",e.yearRange[0]," to ",e.yearRange[1],", covering ",e.topicClusters.length," major research areas in AI Security Economics and Game Theory."]}),t==="authors"&&l.jsxs("p",{children:["Network of ",e.authorNetwork.length," researchers from diverse institutions, with ",e.authorNetwork.filter(x=>x.paperCount>5).length," highly active contributors."]}),t==="topics"&&l.jsxs("p",{children:["Research spans ",e.topicClusters.length," interconnected topics, with Security (",(o=e.topicClusters[0])==null?void 0:o.coverage.toFixed(1),"%) and Economics being the most prominent areas."]}),t==="recent"&&l.jsxs("p",{children:[s," papers published in the last 5 years, showing ",n>30?"strong":"moderate","recent activity in the field."]})]})]})]})},Hm=({children:e,className:t=""})=>{const[r,a]=fe.useState(!1),[s,n]=fe.useState(!1);return fe.useEffect(()=>{const i=()=>{a(window.innerWidth<768),n(window.innerWidth>=768&&window.innerWidth<1024)};return i(),window.addEventListener("resize",i),()=>window.removeEventListener("resize",i)},[]),l.jsx("div",{className:`${t} ${r?"mobile-layout":s?"tablet-layout":"desktop-layout"}`,"data-mobile":r,"data-tablet":s,children:e})},Gm=({currentView:e,onViewChange:t,navigationItems:r})=>{const[a,s]=fe.useState(!1);return l.jsxs("div",{className:"md:hidden",children:[l.jsxs("button",{onClick:()=>s(!a),className:"flex items-center px-4 py-2 text-gray-600 hover:text-gray-900",children:[l.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})}),l.jsx("span",{className:"ml-2",children:"Menu"})]}),a&&l.jsx("div",{className:"fixed inset-0 z-50 bg-black bg-opacity-50",onClick:()=>s(!1),children:l.jsxs("div",{className:"fixed inset-y-0 left-0 w-64 bg-white shadow-lg",onClick:n=>n.stopPropagation(),children:[l.jsx("div",{className:"p-4 border-b border-gray-200",children:l.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Navigation"})}),l.jsx("nav",{className:"p-4",children:r.map(n=>l.jsxs("button",{onClick:()=>{t(n.id),s(!1)},className:`w-full flex items-center space-x-3 px-3 py-2 rounded-lg text-left transition-colors ${e===n.id?"bg-blue-100 text-blue-700":"text-gray-700 hover:bg-gray-100"}`,children:[l.jsx("span",{className:"text-xl",children:n.icon}),l.jsx("span",{children:n.label})]},n.id))})]})})]})},Wm=({data:e,loading:t,error:r})=>t?l.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600 mr-3"}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-sm font-medium text-blue-900",children:"Loading Your Research Data"}),l.jsx("p",{className:"text-sm text-blue-700",children:"Processing your literature review dataset..."})]})]})}):r?l.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"text-red-600 mr-3",children:"⚠️"}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-sm font-medium text-red-900",children:"Data Loading Error"}),l.jsx("p",{className:"text-sm text-red-700",children:r}),l.jsx("p",{className:"text-xs text-red-600 mt-1",children:"Check browser console for details"})]})]})}):e?l.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 mb-6",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"text-green-600 mr-3",children:"✅"}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-sm font-medium text-green-900",children:"🎯 Your FINAL SCREENED Dataset Loaded!"}),l.jsxs("p",{className:"text-sm text-green-700",children:[e.papers.length," papers • ",e.authorNetwork.length," authors • ",e.topicClusters.length," topics"]}),l.jsx("p",{className:"text-xs text-green-600 mt-1",children:"Using the exact dataset from your literature review (XLSX)"})]})]}),l.jsxs("div",{className:"text-right",children:[l.jsxs("div",{className:"text-xs text-green-600",children:["Year Range: ",e.yearRange[0],"-",e.yearRange[1]]}),l.jsxs("div",{className:"text-xs text-green-600",children:["Quality: ",e.qualityMetrics.doiCoverage.toFixed(1),"% DOI coverage"]})]})]})}):null;function $m(){var Y;const[e,t]=fe.useState(null),[r,a]=fe.useState(!0),[s,n]=fe.useState(null),[i,c]=fe.useState("overview"),[h,f]=fe.useState(),[o,x]=fe.useState(),[d,p]=fe.useState(),[m,u]=fe.useState([]),[g,_]=fe.useState(null),[F,y]=fe.useState(!1),[E,D]=fe.useState(!1);fe.useEffect(()=>{const X=()=>D(window.innerWidth<768);return X(),window.addEventListener("resize",X),()=>window.removeEventListener("resize",X)},[]),fe.useEffect(()=>{(async()=>{try{a(!0);const{combinedData:re}=await Em();t(re),u(re.papers),console.log(`Loaded ${re.papers.length} papers from research dataset`)}catch(re){n(re instanceof Error?re.message:"Failed to load research data")}finally{a(!1)}})()},[]),fe.useEffect(()=>{if(!e)return;let X=e.papers;if(h&&(X=X.filter(re=>re.publicationYear&&re.publicationYear>=h[0]&&re.publicationYear<=h[1])),o){const re=e.topicClusters.find(ne=>ne.id===o);if(re){const ne=new Set(re.papers.map(be=>be.key));X=X.filter(be=>ne.has(be.key))}}d&&(X=X.filter(re=>re.authors.some(ne=>ne.toLowerCase().includes(d.toLowerCase())))),u(X)},[e,h,o,d]);const R=(X,re)=>{f([X,re])},T=X=>{x(o===X?void 0:X)},M=X=>{p(d===X?void 0:X)},I=()=>{f(void 0),x(void 0),p(void 0)},V=X=>{_(X),y(!0)},L=X=>{u(X)};if(r)return l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),l.jsx("p",{className:"mt-4 text-gray-600",children:"Loading literature review data..."})]})});if(s)return l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-red-600 text-xl mb-4",children:"Error loading data"}),l.jsx("p",{className:"text-gray-600",children:s})]})});const P=[{id:"overview",label:"Overview",icon:"📊"},{id:"timeline",label:"Timeline",icon:"📈"},{id:"topics",label:"Topics",icon:"🔗"},{id:"authors",label:"Authors",icon:"👥"},{id:"gaps",label:"Research Gaps",icon:"🔍"},{id:"search",label:"Search",icon:"🔎"},{id:"methodology",label:"Methodology",icon:"🔬"}],J=()=>{if(!e)return null;switch(i){case"overview":return E?l.jsx(ei,{data:e}):l.jsx(Qn,{data:e});case"timeline":return l.jsx(bm,{papers:m,onYearRangeChange:R,selectedYearRange:h});case"topics":return l.jsx(Cm,{topicClusters:e.topicClusters,onTopicSelect:T,selectedTopic:o});case"authors":return l.jsx(Nm,{authors:e.authorNetwork,onAuthorSelect:M,selectedAuthor:d});case"gaps":return l.jsx(Om,{data:e});case"search":return l.jsxs("div",{className:"space-y-6",children:[l.jsx(Pm,{data:e,onSearchResults:L,onFiltersChange:()=>{}}),l.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[l.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Search Results (",m.length," papers)"]}),l.jsxs("div",{className:"space-y-3",children:[m.slice(0,20).map(X=>l.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer",onClick:()=>V(X),children:[l.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:X.title}),l.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:[X.authors.join(", ")," • ",X.publicationYear," • ",X.venue||X.publicationTitle]}),X.abstract&&l.jsxs("p",{className:"text-sm text-gray-700 line-clamp-2",children:[X.abstract.substring(0,200),"..."]})]},X.key)),m.length>20&&l.jsx("div",{className:"text-center py-4 text-gray-500",children:"Showing first 20 results. Use filters to narrow down your search."})]})]})]});case"methodology":return l.jsx(Rm,{data:e});default:return E?l.jsx(ei,{data:e}):l.jsx(Qn,{data:e})}};return l.jsxs(Hm,{className:"min-h-screen bg-gray-50",children:[l.jsx("header",{className:"bg-white shadow-sm sticky top-0 z-40",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsx("div",{className:"py-6",children:l.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between",children:[l.jsx("div",{className:"mb-4 lg:mb-0",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-gray-900",children:"Literature Review Showcase"}),l.jsxs("p",{className:"mt-2 text-gray-600 text-sm md:text-base",children:["Systematic literature review: ",(e==null?void 0:e.papers.length)||0," papers on AI Security Economics and Game Theory (",e?e.yearRange[0]:1990,"-",e?e.yearRange[1]:2025,")"]})]}),l.jsx(Gm,{currentView:i,onViewChange:X=>c(X),navigationItems:P})]})}),(h||o||d)&&l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"text-sm text-gray-500",children:"Filters active:"}),h&&l.jsxs("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full",children:[h[0],"-",h[1]]}),o&&l.jsxs("span",{className:"px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full",children:["Topic: ",(Y=e==null?void 0:e.topicClusters.find(X=>X.id===o))==null?void 0:Y.label]}),d&&l.jsxs("span",{className:"px-2 py-1 bg-purple-100 text-purple-800 text-xs rounded-full",children:["Author: ",d]}),l.jsx("button",{onClick:I,className:"px-2 py-1 bg-red-100 text-red-800 text-xs rounded-full hover:bg-red-200 transition-colors",children:"Clear All"})]})]})})})}),l.jsx("nav",{className:"bg-white border-b border-gray-200 sticky top-24 z-30 hidden md:block",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsx("div",{className:"flex space-x-8 overflow-x-auto",children:P.map(X=>l.jsxs("button",{onClick:()=>c(X.id),className:`flex items-center space-x-2 py-4 px-1 border-b-2 font-medium text-sm whitespace-nowrap transition-colors ${i===X.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[l.jsx("span",{children:X.icon}),l.jsx("span",{children:X.label})]},X.id))})})}),l.jsxs("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[l.jsx(Wm,{data:e,loading:r,error:s}),J()]}),l.jsx("footer",{className:"bg-white border-t border-gray-200 mt-16",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:l.jsxs("div",{className:"text-center text-gray-500 text-sm",children:[l.jsx("p",{children:"Literature Review Showcase - PhD Research Demonstration"}),l.jsxs("p",{className:"mt-2",children:["Systematic analysis of ",(e==null?void 0:e.papers.length)||0," papers spanning ",e?e.yearRange[1]-e.yearRange[0]:0," years"]})]})})}),e&&l.jsx(Vm,{paper:g,isOpen:F,onClose:()=>y(!1),data:e})]})}Za.createRoot(document.getElementById("root")).render(l.jsx(fc.StrictMode,{children:l.jsx($m,{})}));
